/*! For license information please see index.js.LICENSE.txt */
var e={535:(e,t)=>{t.A=(e,t)=>{const n=e.__vccOpts||e;for(const[e,r]of t)n[e]=r;return n}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}function r(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return e=>e in t}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();const i={},o=[],s=()=>{},a=()=>!1,l=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),c=e=>e.startsWith("onUpdate:"),u=Object.assign,d=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},p=Object.prototype.hasOwnProperty,h=(e,t)=>p.call(e,t),f=Array.isArray,v=e=>"[object Map]"===w(e),m=e=>"[object Set]"===w(e),g=e=>"function"==typeof e,y=e=>"string"==typeof e,b=e=>"symbol"==typeof e,_=e=>null!==e&&"object"==typeof e,k=e=>(_(e)||g(e))&&g(e.then)&&g(e.catch),x=Object.prototype.toString,w=e=>x.call(e),S=e=>"[object Object]"===w(e),E=e=>y(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,C=r(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),T=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},A=/-(\w)/g,M=T((e=>e.replace(A,((e,t)=>t?t.toUpperCase():"")))),I=/\B([A-Z])/g,L=T((e=>e.replace(I,"-$1").toLowerCase())),O=T((e=>e.charAt(0).toUpperCase()+e.slice(1))),R=T((e=>e?`on${O(e)}`:"")),P=(e,t)=>!Object.is(e,t),N=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},D=(e,t,n,r=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:r,value:n})},F=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let j;const B=()=>j||(j="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{});function U(e){if(f(e)){const t={};for(let n=0;n<e.length;n++){const r=e[n],i=y(r)?z(r):U(r);if(i)for(const e in i)t[e]=i[e]}return t}if(y(e)||_(e))return e}const H=/;(?![^(]*\))/g,q=/:([^]+)/,V=/\/\*[^]*?\*\//g;function z(e){const t={};return e.replace(V,"").split(H).forEach((e=>{if(e){const n=e.split(q);n.length>1&&(t[n[0].trim()]=n[1].trim())}})),t}function G(e){let t="";if(y(e))t=e;else if(f(e))for(let n=0;n<e.length;n++){const r=G(e[n]);r&&(t+=r+" ")}else if(_(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const W="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",K=r(W);function J(e){return!!e||""===e}const X=e=>!(!e||!0!==e.__v_isRef),Y=e=>y(e)?e:null==e?"":f(e)||_(e)&&(e.toString===x||!g(e.toString))?X(e)?Y(e.value):JSON.stringify(e,$,2):String(e),$=(e,t)=>X(t)?$(e,t.value):v(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,[t,n],r)=>(e[Z(t,r)+" =>"]=n,e)),{})}:m(t)?{[`Set(${t.size})`]:[...t.values()].map((e=>Z(e)))}:b(t)?Z(t):!_(t)||f(t)||S(t)?t:String(t),Z=(e,t="")=>{var n;return b(e)?`Symbol(${null!=(n=e.description)?n:t})`:e};let Q,ee;class te{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Q,!e&&Q&&(this.index=(Q.scopes||(Q.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){let e,t;if(this._isPaused=!0,this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){let e,t;if(this._isPaused=!1,this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Q;try{return Q=this,e()}finally{Q=t}}else 0}on(){Q=this}off(){Q=this.parent}stop(e){if(this._active){let t,n;for(this._active=!1,t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0}}}const ne=new WeakSet;class re{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Q&&Q.active&&Q.effects.push(this)}pause(){this.flags|=64}resume(){64&this.flags&&(this.flags&=-65,ne.has(this)&&(ne.delete(this),this.trigger()))}notify(){2&this.flags&&!(32&this.flags)||8&this.flags||ae(this)}run(){if(!(1&this.flags))return this.fn();this.flags|=2,_e(this),ue(this);const e=ee,t=me;ee=this,me=!0;try{return this.fn()}finally{0,de(this),ee=e,me=t,this.flags&=-3}}stop(){if(1&this.flags){for(let e=this.deps;e;e=e.nextDep)fe(e);this.deps=this.depsTail=void 0,_e(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){64&this.flags?ne.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){pe(this)&&this.run()}get dirty(){return pe(this)}}let ie,oe,se=0;function ae(e,t=!1){if(e.flags|=8,t)return e.next=oe,void(oe=e);e.next=ie,ie=e}function le(){se++}function ce(){if(--se>0)return;if(oe){let e=oe;for(oe=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let e;for(;ie;){let t=ie;for(ie=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,1&t.flags)try{t.trigger()}catch(t){e||(e=t)}t=n}}if(e)throw e}function ue(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function de(e){let t,n=e.depsTail,r=n;for(;r;){const e=r.prevDep;-1===r.version?(r===n&&(n=e),fe(r),ve(r)):t=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=e}e.deps=t,e.depsTail=n}function pe(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(he(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function he(e){if(4&e.flags&&!(16&e.flags))return;if(e.flags&=-17,e.globalVersion===ke)return;e.globalVersion=ke;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!pe(e))return void(e.flags&=-3);const n=ee,r=me;ee=e,me=!0;try{ue(e);const n=e.fn(e._value);(0===t.version||P(n,e._value))&&(e._value=n,t.version++)}catch(e){throw t.version++,e}finally{ee=n,me=r,de(e),e.flags&=-3}}function fe(e,t=!1){const{dep:n,prevSub:r,nextSub:i}=e;if(r&&(r.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=r,e.nextSub=void 0),n.subs===e&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let e=n.computed.deps;e;e=e.nextDep)fe(e,!0)}t||--n.sc||!n.map||n.map.delete(n.key)}function ve(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let me=!0;const ge=[];function ye(){ge.push(me),me=!1}function be(){const e=ge.pop();me=void 0===e||e}function _e(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const e=ee;ee=void 0;try{t()}finally{ee=e}}}let ke=0;class xe{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class we{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!ee||!me||ee===this.computed)return;let t=this.activeLink;if(void 0===t||t.sub!==ee)t=this.activeLink=new xe(ee,this),ee.deps?(t.prevDep=ee.depsTail,ee.depsTail.nextDep=t,ee.depsTail=t):ee.deps=ee.depsTail=t,Se(t);else if(-1===t.version&&(t.version=this.version,t.nextDep)){const e=t.nextDep;e.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=e),t.prevDep=ee.depsTail,t.nextDep=void 0,ee.depsTail.nextDep=t,ee.depsTail=t,ee.deps===t&&(ee.deps=e)}return t}trigger(e){this.version++,ke++,this.notify(e)}notify(e){le();try{0;for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{ce()}}}function Se(e){if(e.dep.sc++,4&e.sub.flags){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let e=t.deps;e;e=e.nextDep)Se(e)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const Ee=new WeakMap,Ce=Symbol(""),Te=Symbol(""),Ae=Symbol("");function Me(e,t,n){if(me&&ee){let t=Ee.get(e);t||Ee.set(e,t=new Map);let r=t.get(n);r||(t.set(n,r=new we),r.map=t,r.key=n),r.track()}}function Ie(e,t,n,r,i,o){const s=Ee.get(e);if(!s)return void ke++;const a=e=>{e&&e.trigger()};if(le(),"clear"===t)s.forEach(a);else{const i=f(e),o=i&&E(n);if(i&&"length"===n){const e=Number(r);s.forEach(((t,n)=>{("length"===n||n===Ae||!b(n)&&n>=e)&&a(t)}))}else switch((void 0!==n||s.has(void 0))&&a(s.get(n)),o&&a(s.get(Ae)),t){case"add":i?o&&a(s.get("length")):(a(s.get(Ce)),v(e)&&a(s.get(Te)));break;case"delete":i||(a(s.get(Ce)),v(e)&&a(s.get(Te)));break;case"set":v(e)&&a(s.get(Ce))}}ce()}function Le(e){const t=vt(e);return t===e?t:(Me(t,0,Ae),ht(e)?t:t.map(mt))}function Oe(e){return Me(e=vt(e),0,Ae),e}const Re={__proto__:null,[Symbol.iterator](){return Pe(this,Symbol.iterator,mt)},concat(...e){return Le(this).concat(...e.map((e=>f(e)?Le(e):e)))},entries(){return Pe(this,"entries",(e=>(e[1]=mt(e[1]),e)))},every(e,t){return De(this,"every",e,t,void 0,arguments)},filter(e,t){return De(this,"filter",e,t,(e=>e.map(mt)),arguments)},find(e,t){return De(this,"find",e,t,mt,arguments)},findIndex(e,t){return De(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return De(this,"findLast",e,t,mt,arguments)},findLastIndex(e,t){return De(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return De(this,"forEach",e,t,void 0,arguments)},includes(...e){return je(this,"includes",e)},indexOf(...e){return je(this,"indexOf",e)},join(e){return Le(this).join(e)},lastIndexOf(...e){return je(this,"lastIndexOf",e)},map(e,t){return De(this,"map",e,t,void 0,arguments)},pop(){return Be(this,"pop")},push(...e){return Be(this,"push",e)},reduce(e,...t){return Fe(this,"reduce",e,t)},reduceRight(e,...t){return Fe(this,"reduceRight",e,t)},shift(){return Be(this,"shift")},some(e,t){return De(this,"some",e,t,void 0,arguments)},splice(...e){return Be(this,"splice",e)},toReversed(){return Le(this).toReversed()},toSorted(e){return Le(this).toSorted(e)},toSpliced(...e){return Le(this).toSpliced(...e)},unshift(...e){return Be(this,"unshift",e)},values(){return Pe(this,"values",mt)}};function Pe(e,t,n){const r=Oe(e),i=r[t]();return r===e||ht(e)||(i._next=i.next,i.next=()=>{const e=i._next();return e.value&&(e.value=n(e.value)),e}),i}const Ne=Array.prototype;function De(e,t,n,r,i,o){const s=Oe(e),a=s!==e&&!ht(e),l=s[t];if(l!==Ne[t]){const t=l.apply(e,o);return a?mt(t):t}let c=n;s!==e&&(a?c=function(t,r){return n.call(this,mt(t),r,e)}:n.length>2&&(c=function(t,r){return n.call(this,t,r,e)}));const u=l.call(s,c,r);return a&&i?i(u):u}function Fe(e,t,n,r){const i=Oe(e);let o=n;return i!==e&&(ht(e)?n.length>3&&(o=function(t,r,i){return n.call(this,t,r,i,e)}):o=function(t,r,i){return n.call(this,t,mt(r),i,e)}),i[t](o,...r)}function je(e,t,n){const r=vt(e);Me(r,0,Ae);const i=r[t](...n);return-1!==i&&!1!==i||!ft(n[0])?i:(n[0]=vt(n[0]),r[t](...n))}function Be(e,t,n=[]){ye(),le();const r=vt(e)[t].apply(e,n);return ce(),be(),r}const Ue=r("__proto__,__v_isRef,__isVue"),He=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(b));function qe(e){b(e)||(e=String(e));const t=vt(this);return Me(t,0,e),t.hasOwnProperty(e)}class Ve{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if("__v_skip"===t)return e.__v_skip;const r=this._isReadonly,i=this._isShallow;if("__v_isReactive"===t)return!r;if("__v_isReadonly"===t)return r;if("__v_isShallow"===t)return i;if("__v_raw"===t)return n===(r?i?st:ot:i?it:rt).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const o=f(e);if(!r){let e;if(o&&(e=Re[t]))return e;if("hasOwnProperty"===t)return qe}const s=Reflect.get(e,t,yt(e)?e:n);return(b(t)?He.has(t):Ue(t))?s:(r||Me(e,0,t),i?s:yt(s)?o&&E(t)?s:s.value:_(s)?r?ct(s):lt(s):s)}}class ze extends Ve{constructor(e=!1){super(!1,e)}set(e,t,n,r){let i=e[t];if(!this._isShallow){const t=pt(i);if(ht(n)||pt(n)||(i=vt(i),n=vt(n)),!f(e)&&yt(i)&&!yt(n))return!t&&(i.value=n,!0)}const o=f(e)&&E(t)?Number(t)<e.length:h(e,t),s=Reflect.set(e,t,n,yt(e)?e:r);return e===vt(r)&&(o?P(n,i)&&Ie(e,"set",t,n):Ie(e,"add",t,n)),s}deleteProperty(e,t){const n=h(e,t),r=(e[t],Reflect.deleteProperty(e,t));return r&&n&&Ie(e,"delete",t,void 0),r}has(e,t){const n=Reflect.has(e,t);return b(t)&&He.has(t)||Me(e,0,t),n}ownKeys(e){return Me(e,0,f(e)?"length":Ce),Reflect.ownKeys(e)}}class Ge extends Ve{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const We=new ze,Ke=new Ge,Je=new ze(!0),Xe=e=>e,Ye=e=>Reflect.getPrototypeOf(e);function $e(e){return function(...t){return"delete"!==e&&("clear"===e?void 0:this)}}function Ze(e,t){const n={get(n){const r=this.__v_raw,i=vt(r),o=vt(n);e||(P(n,o)&&Me(i,0,n),Me(i,0,o));const{has:s}=Ye(i),a=t?Xe:e?gt:mt;return s.call(i,n)?a(r.get(n)):s.call(i,o)?a(r.get(o)):void(r!==i&&r.get(n))},get size(){const t=this.__v_raw;return!e&&Me(vt(t),0,Ce),Reflect.get(t,"size",t)},has(t){const n=this.__v_raw,r=vt(n),i=vt(t);return e||(P(t,i)&&Me(r,0,t),Me(r,0,i)),t===i?n.has(t):n.has(t)||n.has(i)},forEach(n,r){const i=this,o=i.__v_raw,s=vt(o),a=t?Xe:e?gt:mt;return!e&&Me(s,0,Ce),o.forEach(((e,t)=>n.call(r,a(e),a(t),i)))}};u(n,e?{add:$e("add"),set:$e("set"),delete:$e("delete"),clear:$e("clear")}:{add(e){t||ht(e)||pt(e)||(e=vt(e));const n=vt(this);return Ye(n).has.call(n,e)||(n.add(e),Ie(n,"add",e,e)),this},set(e,n){t||ht(n)||pt(n)||(n=vt(n));const r=vt(this),{has:i,get:o}=Ye(r);let s=i.call(r,e);s||(e=vt(e),s=i.call(r,e));const a=o.call(r,e);return r.set(e,n),s?P(n,a)&&Ie(r,"set",e,n):Ie(r,"add",e,n),this},delete(e){const t=vt(this),{has:n,get:r}=Ye(t);let i=n.call(t,e);i||(e=vt(e),i=n.call(t,e));r&&r.call(t,e);const o=t.delete(e);return i&&Ie(t,"delete",e,void 0),o},clear(){const e=vt(this),t=0!==e.size,n=e.clear();return t&&Ie(e,"clear",void 0,void 0),n}});return["keys","values","entries",Symbol.iterator].forEach((r=>{n[r]=function(e,t,n){return function(...r){const i=this.__v_raw,o=vt(i),s=v(o),a="entries"===e||e===Symbol.iterator&&s,l="keys"===e&&s,c=i[e](...r),u=n?Xe:t?gt:mt;return!t&&Me(o,0,l?Te:Ce),{next(){const{value:e,done:t}=c.next();return t?{value:e,done:t}:{value:a?[u(e[0]),u(e[1])]:u(e),done:t}},[Symbol.iterator](){return this}}}}(r,e,t)})),n}function Qe(e,t){const n=Ze(e,t);return(t,r,i)=>"__v_isReactive"===r?!e:"__v_isReadonly"===r?e:"__v_raw"===r?t:Reflect.get(h(n,r)&&r in t?n:t,r,i)}const et={get:Qe(!1,!1)},tt={get:Qe(!1,!0)},nt={get:Qe(!0,!1)};const rt=new WeakMap,it=new WeakMap,ot=new WeakMap,st=new WeakMap;function at(e){return e.__v_skip||!Object.isExtensible(e)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((e=>w(e).slice(8,-1))(e))}function lt(e){return pt(e)?e:ut(e,!1,We,et,rt)}function ct(e){return ut(e,!0,Ke,nt,ot)}function ut(e,t,n,r,i){if(!_(e))return e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const o=i.get(e);if(o)return o;const s=at(e);if(0===s)return e;const a=new Proxy(e,2===s?r:n);return i.set(e,a),a}function dt(e){return pt(e)?dt(e.__v_raw):!(!e||!e.__v_isReactive)}function pt(e){return!(!e||!e.__v_isReadonly)}function ht(e){return!(!e||!e.__v_isShallow)}function ft(e){return!!e&&!!e.__v_raw}function vt(e){const t=e&&e.__v_raw;return t?vt(t):e}const mt=e=>_(e)?lt(e):e,gt=e=>_(e)?ct(e):e;function yt(e){return!!e&&!0===e.__v_isRef}function bt(e){return yt(e)?e.value:e}const _t={get:(e,t,n)=>"__v_raw"===t?e:bt(Reflect.get(e,t,n)),set:(e,t,n,r)=>{const i=e[t];return yt(i)&&!yt(n)?(i.value=n,!0):Reflect.set(e,t,n,r)}};function kt(e){return dt(e)?e:new Proxy(e,_t)}class xt{constructor(e,t,n){this.fn=e,this.setter=t,this._value=void 0,this.dep=new we(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ke-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=n}notify(){if(this.flags|=16,!(8&this.flags||ee===this))return ae(this,!0),!0}get value(){const e=this.dep.track();return he(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}const wt={},St=new WeakMap;let Et;function Ct(e,t,n=i){const{immediate:r,deep:o,once:a,scheduler:l,augmentJob:c,call:u}=n,p=e=>o?e:ht(e)||!1===o||0===o?Tt(e,1):Tt(e);let h,v,m,y,b=!1,_=!1;if(yt(e)?(v=()=>e.value,b=ht(e)):dt(e)?(v=()=>p(e),b=!0):f(e)?(_=!0,b=e.some((e=>dt(e)||ht(e))),v=()=>e.map((e=>yt(e)?e.value:dt(e)?p(e):g(e)?u?u(e,2):e():void 0))):v=g(e)?t?u?()=>u(e,2):e:()=>{if(m){ye();try{m()}finally{be()}}const t=Et;Et=h;try{return u?u(e,3,[y]):e(y)}finally{Et=t}}:s,t&&o){const e=v,t=!0===o?1/0:o;v=()=>Tt(e(),t)}const k=Q,x=()=>{h.stop(),k&&k.active&&d(k.effects,h)};if(a&&t){const e=t;t=(...t)=>{e(...t),x()}}let w=_?new Array(e.length).fill(wt):wt;const S=e=>{if(1&h.flags&&(h.dirty||e))if(t){const e=h.run();if(o||b||(_?e.some(((e,t)=>P(e,w[t]))):P(e,w))){m&&m();const n=Et;Et=h;try{const n=[e,w===wt?void 0:_&&w[0]===wt?[]:w,y];u?u(t,3,n):t(...n),w=e}finally{Et=n}}}else h.run()};return c&&c(S),h=new re(v),h.scheduler=l?()=>l(S,!1):S,y=e=>function(e,t=!1,n=Et){if(n){let t=St.get(n);t||St.set(n,t=[]),t.push(e)}}(e,!1,h),m=h.onStop=()=>{const e=St.get(h);if(e){if(u)u(e,4);else for(const t of e)t();St.delete(h)}},t?r?S(!0):w=h.run():l?l(S.bind(null,!0),!0):h.run(),x.pause=h.pause.bind(h),x.resume=h.resume.bind(h),x.stop=x,x}function Tt(e,t=1/0,n){if(t<=0||!_(e)||e.__v_skip)return e;if((n=n||new Set).has(e))return e;if(n.add(e),t--,yt(e))Tt(e.value,t,n);else if(f(e))for(let r=0;r<e.length;r++)Tt(e[r],t,n);else if(m(e)||v(e))e.forEach((e=>{Tt(e,t,n)}));else if(S(e)){for(const r in e)Tt(e[r],t,n);for(const r of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,r)&&Tt(e[r],t,n)}return e}function At(e,t,n,r){try{return r?e(...r):e()}catch(e){It(e,t,n)}}function Mt(e,t,n,r){if(g(e)){const i=At(e,t,n,r);return i&&k(i)&&i.catch((e=>{It(e,t,n)})),i}if(f(e)){const i=[];for(let o=0;o<e.length;o++)i.push(Mt(e[o],t,n,r));return i}}function It(e,t,n,r=!0){t&&t.vnode;const{errorHandler:o,throwUnhandledErrorInProduction:s}=t&&t.appContext.config||i;if(t){let r=t.parent;const i=t.proxy,s=`https://vuejs.org/error-reference/#runtime-${n}`;for(;r;){const t=r.ec;if(t)for(let n=0;n<t.length;n++)if(!1===t[n](e,i,s))return;r=r.parent}if(o)return ye(),At(o,null,10,[e,i,s]),void be()}!function(e,t,n,r=!0,i=!1){if(i)throw e;console.error(e)}(e,0,0,r,s)}const Lt=[];let Ot=-1;const Rt=[];let Pt=null,Nt=0;const Dt=Promise.resolve();let Ft=null;function jt(e){const t=Ft||Dt;return e?t.then(this?e.bind(this):e):t}function Bt(e){if(!(1&e.flags)){const t=zt(e),n=Lt[Lt.length-1];!n||!(2&e.flags)&&t>=zt(n)?Lt.push(e):Lt.splice(function(e){let t=Ot+1,n=Lt.length;for(;t<n;){const r=t+n>>>1,i=Lt[r],o=zt(i);o<e||o===e&&2&i.flags?t=r+1:n=r}return t}(t),0,e),e.flags|=1,Ut()}}function Ut(){Ft||(Ft=Dt.then(Gt))}function Ht(e){f(e)?Rt.push(...e):Pt&&-1===e.id?Pt.splice(Nt+1,0,e):1&e.flags||(Rt.push(e),e.flags|=1),Ut()}function qt(e,t,n=Ot+1){for(0;n<Lt.length;n++){const t=Lt[n];if(t&&2&t.flags){if(e&&t.id!==e.uid)continue;0,Lt.splice(n,1),n--,4&t.flags&&(t.flags&=-2),t(),4&t.flags||(t.flags&=-2)}}}function Vt(e){if(Rt.length){const e=[...new Set(Rt)].sort(((e,t)=>zt(e)-zt(t)));if(Rt.length=0,Pt)return void Pt.push(...e);for(Pt=e,Nt=0;Nt<Pt.length;Nt++){const e=Pt[Nt];0,4&e.flags&&(e.flags&=-2),8&e.flags||e(),e.flags&=-2}Pt=null,Nt=0}}const zt=e=>null==e.id?2&e.flags?-1:1/0:e.id;function Gt(e){try{for(Ot=0;Ot<Lt.length;Ot++){const e=Lt[Ot];!e||8&e.flags||(4&e.flags&&(e.flags&=-2),At(e,e.i,e.i?15:14),4&e.flags||(e.flags&=-2))}}finally{for(;Ot<Lt.length;Ot++){const e=Lt[Ot];e&&(e.flags&=-2)}Ot=-1,Lt.length=0,Vt(),Ft=null,(Lt.length||Rt.length)&&Gt(e)}}let Wt,Kt=[],Jt=!1;function Xt(e,...t){Wt?Wt.emit(e,...t):Jt||Kt.push({event:e,args:t})}function Yt(e,t){var n,r;if(Wt=e,Wt)Wt.enabled=!0,Kt.forEach((({event:e,args:t})=>Wt.emit(e,...t))),Kt=[];else if("undefined"!=typeof window&&window.HTMLElement&&!(null==(r=null==(n=window.navigator)?void 0:n.userAgent)?void 0:r.includes("jsdom"))){(t.__VUE_DEVTOOLS_HOOK_REPLAY__=t.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push((e=>{Yt(e,t)})),setTimeout((()=>{Wt||(t.__VUE_DEVTOOLS_HOOK_REPLAY__=null,Jt=!0,Kt=[])}),3e3)}else Jt=!0,Kt=[]}const $t=en("component:added"),Zt=en("component:updated"),Qt=en("component:removed");function en(e){return t=>{Xt(e,t.appContext.app,t.uid,t.parent?t.parent.uid:void 0,t)}}let tn=null,nn=null;function rn(e){const t=tn;return tn=e,nn=e&&e.type.__scopeId||null,t}function on(e,t=tn,n){if(!t)return e;if(e._n)return e;const r=(...n)=>{r._d&&ri(-1);const i=rn(t);let o;try{o=e(...n)}finally{rn(i),r._d&&ri(1)}return __VUE_PROD_DEVTOOLS__&&Zt(t),o};return r._n=!0,r._c=!0,r._d=!0,r}function sn(e,t,n,r){const i=e.dirs,o=t&&t.dirs;for(let s=0;s<i.length;s++){const a=i[s];o&&(a.oldValue=o[s].value);let l=a.dir[r];l&&(ye(),Mt(l,n,8,[e.el,a,e,t]),be())}}const an=Symbol("_vte"),ln=e=>e.__isTeleport;Symbol("_leaveCb"),Symbol("_enterCb");const cn=[Function,Array];Boolean,Boolean;function un(e,t){6&e.shapeFlag&&e.component?(e.transition=t,un(e.component.subTree,t)):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function dn(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function pn(e,t,n,r,o=!1){if(f(e))return void e.forEach(((e,i)=>pn(e,t&&(f(t)?t[i]:t),n,r,o)));if(hn(r)&&!o)return void(512&r.shapeFlag&&r.type.__asyncResolved&&r.component.subTree.component&&pn(e,t,n,r.component.subTree));const s=4&r.shapeFlag?Ui(r.component):r.el,a=o?null:s,{i:l,r:c}=e;const u=t&&t.r,p=l.refs===i?l.refs={}:l.refs,v=l.setupState,m=vt(v),b=v===i?()=>!1:e=>h(m,e);if(null!=u&&u!==c&&(y(u)?(p[u]=null,b(u)&&(v[u]=null)):yt(u)&&(u.value=null)),g(c))At(c,l,12,[a,p]);else{const t=y(c),r=yt(c);if(t||r){const i=()=>{if(e.f){const n=t?b(c)?v[c]:p[c]:c.value;o?f(n)&&d(n,s):f(n)?n.includes(s)||n.push(s):t?(p[c]=[s],b(c)&&(v[c]=p[c])):(c.value=[s],e.k&&(p[e.k]=c.value))}else t?(p[c]=a,b(c)&&(v[c]=a)):r&&(c.value=a,e.k&&(p[e.k]=a))};a?(i.id=-1,wr(i,n)):i()}else 0}}B().requestIdleCallback,B().cancelIdleCallback;const hn=e=>!!e.type.__asyncLoader;const fn=e=>e.type.__isKeepAlive;RegExp,RegExp;function vn(e,t){return f(e)?e.some((e=>vn(e,t))):y(e)?e.split(",").includes(t):"[object RegExp]"===w(e)&&(e.lastIndex=0,e.test(t))}function mn(e,t){yn(e,"a",t)}function gn(e,t){yn(e,"da",t)}function yn(e,t,n=Ei){const r=e.__wdc||(e.__wdc=()=>{let t=n;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if(xn(t,r,n),n){let e=n.parent;for(;e&&e.parent;)fn(e.parent.vnode)&&bn(r,t,n,e),e=e.parent}}function bn(e,t,n,r){const i=xn(t,e,r,!0);Mn((()=>{d(r[t],i)}),n)}function _n(e){e.shapeFlag&=-257,e.shapeFlag&=-513}function kn(e){return 128&e.shapeFlag?e.ssContent:e}function xn(e,t,n=Ei,r=!1){if(n){const i=n[e]||(n[e]=[]),o=t.__weh||(t.__weh=(...r)=>{ye();const i=Mi(n),o=Mt(t,n,e,r);return i(),be(),o});return r?i.unshift(o):i.push(o),o}}const wn=e=>(t,n=Ei)=>{Pi&&"sp"!==e||xn(e,((...e)=>t(...e)),n)},Sn=wn("bm"),En=wn("m"),Cn=wn("bu"),Tn=wn("u"),An=wn("bum"),Mn=wn("um"),In=wn("sp"),Ln=wn("rtg"),On=wn("rtc");function Rn(e,t=Ei){xn("ec",e,t)}const Pn="components";function Nn(e,t){return Fn(Pn,e,!0,t)||e}const Dn=Symbol.for("v-ndc");function Fn(e,t,n=!0,r=!1){const i=tn||Ei;if(i){const n=i.type;if(e===Pn){const e=Hi(n,!1);if(e&&(e===t||e===M(t)||e===O(M(t))))return n}const o=jn(i[e]||n[e],t)||jn(i.appContext[e],t);return!o&&r?n:o}}function jn(e,t){return e&&(e[t]||e[M(t)]||e[O(M(t))])}function Bn(e,t,n,r){let i;const o=n&&n[r],s=f(e);if(s||y(e)){let n=!1;s&&dt(e)&&(n=!ht(e),e=Oe(e)),i=new Array(e.length);for(let r=0,s=e.length;r<s;r++)i[r]=t(n?mt(e[r]):e[r],r,void 0,o&&o[r])}else if("number"==typeof e){0,i=new Array(e);for(let n=0;n<e;n++)i[n]=t(n+1,n,void 0,o&&o[n])}else if(_(e))if(e[Symbol.iterator])i=Array.from(e,((e,n)=>t(e,n,void 0,o&&o[n])));else{const n=Object.keys(e);i=new Array(n.length);for(let r=0,s=n.length;r<s;r++){const s=n[r];i[r]=t(e[s],s,r,o&&o[r])}}else i=[];return n&&(n[r]=i),i}const Un=e=>e?Li(e)?Ui(e):Un(e.parent):null,Hn=u(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Un(e.parent),$root:e=>Un(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>__VUE_OPTIONS_API__?Xn(e):e.type,$forceUpdate:e=>e.f||(e.f=()=>{Bt(e.update)}),$nextTick:e=>e.n||(e.n=jt.bind(e.proxy)),$watch:e=>__VUE_OPTIONS_API__?Nr.bind(e):s}),qn=(e,t)=>e!==i&&!e.__isScriptSetup&&h(e,t),Vn={get({_:e},t){if("__v_skip"===t)return!0;const{ctx:n,setupState:r,data:o,props:s,accessCache:a,type:l,appContext:c}=e;let u;if("$"!==t[0]){const l=a[t];if(void 0!==l)switch(l){case 1:return r[t];case 2:return o[t];case 4:return n[t];case 3:return s[t]}else{if(qn(r,t))return a[t]=1,r[t];if(o!==i&&h(o,t))return a[t]=2,o[t];if((u=e.propsOptions[0])&&h(u,t))return a[t]=3,s[t];if(n!==i&&h(n,t))return a[t]=4,n[t];__VUE_OPTIONS_API__&&!Gn||(a[t]=0)}}const d=Hn[t];let p,f;return d?("$attrs"===t&&Me(e.attrs,0,""),d(e)):(p=l.__cssModules)&&(p=p[t])?p:n!==i&&h(n,t)?(a[t]=4,n[t]):(f=c.config.globalProperties,h(f,t)?f[t]:void 0)},set({_:e},t,n){const{data:r,setupState:o,ctx:s}=e;return qn(o,t)?(o[t]=n,!0):r!==i&&h(r,t)?(r[t]=n,!0):!h(e.props,t)&&(("$"!==t[0]||!(t.slice(1)in e))&&(s[t]=n,!0))},has({_:{data:e,setupState:t,accessCache:n,ctx:r,appContext:o,propsOptions:s}},a){let l;return!!n[a]||e!==i&&h(e,a)||qn(t,a)||(l=s[0])&&h(l,a)||h(r,a)||h(Hn,a)||h(o.config.globalProperties,a)},defineProperty(e,t,n){return null!=n.get?e._.accessCache[t]=0:h(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function zn(e){return f(e)?e.reduce(((e,t)=>(e[t]=null,e)),{}):e}let Gn=!0;function Wn(e){const t=Xn(e),n=e.proxy,r=e.ctx;Gn=!1,t.beforeCreate&&Kn(t.beforeCreate,e,"bc");const{data:i,computed:o,methods:a,watch:l,provide:c,inject:u,created:d,beforeMount:p,mounted:h,beforeUpdate:v,updated:m,activated:y,deactivated:b,beforeDestroy:k,beforeUnmount:x,destroyed:w,unmounted:S,render:E,renderTracked:C,renderTriggered:T,errorCaptured:A,serverPrefetch:M,expose:I,inheritAttrs:L,components:O,directives:R,filters:P}=t;if(u&&function(e,t){f(e)&&(e=Qn(e));for(const n in e){const r=e[n];let i;i=_(r)?"default"in r?ar(r.from||n,r.default,!0):ar(r.from||n):ar(r),yt(i)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:e=>i.value=e}):t[n]=i}}(u,r,null),a)for(const e in a){const t=a[e];g(t)&&(r[e]=t.bind(n))}if(i){0;const t=i.call(n,n);0,_(t)&&(e.data=lt(t))}if(Gn=!0,o)for(const e in o){const t=o[e],i=g(t)?t.bind(n,n):g(t.get)?t.get.bind(n,n):s;0;const a=!g(t)&&g(t.set)?t.set.bind(n):s,l=Vi({get:i,set:a});Object.defineProperty(r,e,{enumerable:!0,configurable:!0,get:()=>l.value,set:e=>l.value=e})}if(l)for(const e in l)Jn(l[e],r,n,e);if(c){const e=g(c)?c.call(n):c;Reflect.ownKeys(e).forEach((t=>{!function(e,t){if(Ei){let n=Ei.provides;const r=Ei.parent&&Ei.parent.provides;r===n&&(n=Ei.provides=Object.create(r)),n[e]=t}else 0}(t,e[t])}))}function N(e,t){f(t)?t.forEach((t=>e(t.bind(n)))):t&&e(t.bind(n))}if(d&&Kn(d,e,"c"),N(Sn,p),N(En,h),N(Cn,v),N(Tn,m),N(mn,y),N(gn,b),N(Rn,A),N(On,C),N(Ln,T),N(An,x),N(Mn,S),N(In,M),f(I))if(I.length){const t=e.exposed||(e.exposed={});I.forEach((e=>{Object.defineProperty(t,e,{get:()=>n[e],set:t=>n[e]=t})}))}else e.exposed||(e.exposed={});E&&e.render===s&&(e.render=E),null!=L&&(e.inheritAttrs=L),O&&(e.components=O),R&&(e.directives=R),M&&dn(e)}function Kn(e,t,n){Mt(f(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,n)}function Jn(e,t,n,r){let i=r.includes(".")?Dr(n,r):()=>n[r];if(y(e)){const n=t[e];g(n)&&Rr(i,n)}else if(g(e))Rr(i,e.bind(n));else if(_(e))if(f(e))e.forEach((e=>Jn(e,t,n,r)));else{const r=g(e.handler)?e.handler.bind(n):t[e.handler];g(r)&&Rr(i,r,e)}else 0}function Xn(e){const t=e.type,{mixins:n,extends:r}=t,{mixins:i,optionsCache:o,config:{optionMergeStrategies:s}}=e.appContext,a=o.get(t);let l;return a?l=a:i.length||n||r?(l={},i.length&&i.forEach((e=>Yn(l,e,s,!0))),Yn(l,t,s)):l=t,_(t)&&o.set(t,l),l}function Yn(e,t,n,r=!1){const{mixins:i,extends:o}=t;o&&Yn(e,o,n,!0),i&&i.forEach((t=>Yn(e,t,n,!0)));for(const i in t)if(r&&"expose"===i);else{const r=$n[i]||n&&n[i];e[i]=r?r(e[i],t[i]):t[i]}return e}const $n={data:Zn,props:nr,emits:nr,methods:tr,computed:tr,beforeCreate:er,created:er,beforeMount:er,mounted:er,beforeUpdate:er,updated:er,beforeDestroy:er,beforeUnmount:er,destroyed:er,unmounted:er,activated:er,deactivated:er,errorCaptured:er,serverPrefetch:er,components:tr,directives:tr,watch:function(e,t){if(!e)return t;if(!t)return e;const n=u(Object.create(null),e);for(const r in t)n[r]=er(e[r],t[r]);return n},provide:Zn,inject:function(e,t){return tr(Qn(e),Qn(t))}};function Zn(e,t){return t?e?function(){return u(g(e)?e.call(this,this):e,g(t)?t.call(this,this):t)}:t:e}function Qn(e){if(f(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function er(e,t){return e?[...new Set([].concat(e,t))]:t}function tr(e,t){return e?u(Object.create(null),e,t):t}function nr(e,t){return e?f(e)&&f(t)?[...new Set([...e,...t])]:u(Object.create(null),zn(e),zn(null!=t?t:{})):t}function rr(){return{app:null,config:{isNativeTag:a,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ir=0;function or(e,t){return function(n,r=null){g(n)||(n=u({},n)),null==r||_(r)||(r=null);const i=rr(),o=new WeakSet,s=[];let a=!1;const l=i.app={_uid:ir++,_component:n,_props:r,_container:null,_context:i,_instance:null,version:zi,get config(){return i.config},set config(e){0},use:(e,...t)=>(o.has(e)||(e&&g(e.install)?(o.add(e),e.install(l,...t)):g(e)&&(o.add(e),e(l,...t))),l),mixin:e=>(__VUE_OPTIONS_API__&&(i.mixins.includes(e)||i.mixins.push(e)),l),component:(e,t)=>t?(i.components[e]=t,l):i.components[e],directive:(e,t)=>t?(i.directives[e]=t,l):i.directives[e],mount(o,s,c){if(!a){0;const u=l._ceVNode||pi(n,r);return u.appContext=i,!0===c?c="svg":!1===c&&(c=void 0),s&&t?t(u,o):e(u,o,c),a=!0,l._container=o,o.__vue_app__=l,__VUE_PROD_DEVTOOLS__&&(l._instance=u.component,function(e,t){Xt("app:init",e,t,{Fragment:Jr,Text:Xr,Comment:Yr,Static:$r})}(l,zi)),Ui(u.component)}},onUnmount(e){s.push(e)},unmount(){a&&(Mt(s,l._instance,16),e(null,l._container),__VUE_PROD_DEVTOOLS__&&(l._instance=null,function(e){Xt("app:unmount",e)}(l)),delete l._container.__vue_app__)},provide:(e,t)=>(i.provides[e]=t,l),runWithContext(e){const t=sr;sr=l;try{return e()}finally{sr=t}}};return l}}let sr=null;function ar(e,t,n=!1){const r=Ei||tn;if(r||sr){const i=sr?sr._context.provides:r?null==r.parent?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&e in i)return i[e];if(arguments.length>1)return n&&g(t)?t.call(r&&r.proxy):t}else 0}const lr={},cr=()=>Object.create(lr),ur=e=>Object.getPrototypeOf(e)===lr;function dr(e,t,n,r=!1){const i={},o=cr();e.propsDefaults=Object.create(null),pr(e,t,i,o);for(const t in e.propsOptions[0])t in i||(i[t]=void 0);n?e.props=r?i:ut(i,!1,Je,tt,it):e.type.props?e.props=i:e.props=o,e.attrs=o}function pr(e,t,n,r){const[o,s]=e.propsOptions;let a,l=!1;if(t)for(let i in t){if(C(i))continue;const c=t[i];let u;o&&h(o,u=M(i))?s&&s.includes(u)?(a||(a={}))[u]=c:n[u]=c:Ur(e.emitsOptions,i)||i in r&&c===r[i]||(r[i]=c,l=!0)}if(s){const t=vt(n),r=a||i;for(let i=0;i<s.length;i++){const a=s[i];n[a]=hr(o,t,a,r[a],e,!h(r,a))}}return l}function hr(e,t,n,r,i,o){const s=e[n];if(null!=s){const e=h(s,"default");if(e&&void 0===r){const e=s.default;if(s.type!==Function&&!s.skipFactory&&g(e)){const{propsDefaults:o}=i;if(n in o)r=o[n];else{const s=Mi(i);r=o[n]=e.call(null,t),s()}}else r=e;i.ce&&i.ce._setProp(n,r)}s[0]&&(o&&!e?r=!1:!s[1]||""!==r&&r!==L(n)||(r=!0))}return r}const fr=new WeakMap;function vr(e,t,n=!1){const r=__VUE_OPTIONS_API__&&n?fr:t.propsCache,s=r.get(e);if(s)return s;const a=e.props,l={},c=[];let d=!1;if(__VUE_OPTIONS_API__&&!g(e)){const r=e=>{d=!0;const[n,r]=vr(e,t,!0);u(l,n),r&&c.push(...r)};!n&&t.mixins.length&&t.mixins.forEach(r),e.extends&&r(e.extends),e.mixins&&e.mixins.forEach(r)}if(!a&&!d)return _(e)&&r.set(e,o),o;if(f(a))for(let e=0;e<a.length;e++){0;const t=M(a[e]);mr(t)&&(l[t]=i)}else if(a){0;for(const e in a){const t=M(e);if(mr(t)){const n=a[e],r=l[t]=f(n)||g(n)?{type:n}:u({},n),i=r.type;let o=!1,s=!0;if(f(i))for(let e=0;e<i.length;++e){const t=i[e],n=g(t)&&t.name;if("Boolean"===n){o=!0;break}"String"===n&&(s=!1)}else o=g(i)&&"Boolean"===i.name;r[0]=o,r[1]=s,(o||h(r,"default"))&&c.push(t)}}}const p=[l,c];return _(e)&&r.set(e,p),p}function mr(e){return"$"!==e[0]&&!C(e)}const gr=e=>"_"===e[0]||"$stable"===e,yr=e=>f(e)?e.map(yi):[yi(e)],br=(e,t,n)=>{if(t._n)return t;const r=on(((...e)=>yr(t(...e))),n);return r._c=!1,r},_r=(e,t,n)=>{const r=e._ctx;for(const n in e){if(gr(n))continue;const i=e[n];if(g(i))t[n]=br(0,i,r);else if(null!=i){0;const e=yr(i);t[n]=()=>e}}},kr=(e,t)=>{const n=yr(t);e.slots.default=()=>n},xr=(e,t,n)=>{for(const r in t)(n||"_"!==r)&&(e[r]=t[r])};const wr=Kr;function Sr(e,t){"boolean"!=typeof __VUE_OPTIONS_API__&&(B().__VUE_OPTIONS_API__=!0),"boolean"!=typeof __VUE_PROD_DEVTOOLS__&&(B().__VUE_PROD_DEVTOOLS__=!1),"boolean"!=typeof __VUE_PROD_HYDRATION_MISMATCH_DETAILS__&&(B().__VUE_PROD_HYDRATION_MISMATCH_DETAILS__=!1);const n=B();n.__VUE__=!0,__VUE_PROD_DEVTOOLS__&&Yt(n.__VUE_DEVTOOLS_GLOBAL_HOOK__,n);const{insert:r,remove:a,patchProp:l,createElement:c,createText:u,createComment:d,setText:p,setElementText:f,parentNode:v,nextSibling:m,setScopeId:g=s,insertStaticContent:y}=e,b=(e,t,n,r=null,i=null,o=null,s=void 0,a=null,l=!!t.dynamicChildren)=>{if(e===t)return;e&&!li(e,t)&&(r=Z(e),K(e,i,o,!0),e=null),-2===t.patchFlag&&(l=!1,t.dynamicChildren=null);const{type:c,ref:u,shapeFlag:d}=t;switch(c){case Xr:_(e,t,n,r);break;case Yr:k(e,t,n,r);break;case $r:null==e&&x(t,n,r,s);break;case Jr:P(e,t,n,r,i,o,s,a,l);break;default:1&d?S(e,t,n,r,i,o,s,a,l):6&d?F(e,t,n,r,i,o,s,a,l):(64&d||128&d)&&c.process(e,t,n,r,i,o,s,a,l,te)}null!=u&&i&&pn(u,e&&e.ref,o,t||e,!t)},_=(e,t,n,i)=>{if(null==e)r(t.el=u(t.children),n,i);else{const n=t.el=e.el;t.children!==e.children&&p(n,t.children)}},k=(e,t,n,i)=>{null==e?r(t.el=d(t.children||""),n,i):t.el=e.el},x=(e,t,n,r)=>{[e.el,e.anchor]=y(e.children,t,n,r,e.el,e.anchor)},w=({el:e,anchor:t})=>{let n;for(;e&&e!==t;)n=m(e),a(e),e=n;a(t)},S=(e,t,n,r,i,o,s,a,l)=>{"svg"===t.type?s="svg":"math"===t.type&&(s="mathml"),null==e?E(t,n,r,i,o,s,a,l):I(e,t,i,o,s,a,l)},E=(e,t,n,i,o,s,a,u)=>{let d,p;const{props:h,shapeFlag:v,transition:m,dirs:g}=e;if(d=e.el=c(e.type,s,h&&h.is,h),8&v?f(d,e.children):16&v&&A(e.children,d,null,i,o,Er(e,s),a,u),g&&sn(e,null,i,"created"),T(d,e,e.scopeId,a,i),h){for(const e in h)"value"===e||C(e)||l(d,e,null,h[e],s,i);"value"in h&&l(d,"value",null,h.value,s),(p=h.onVnodeBeforeMount)&&ki(p,i,e)}__VUE_PROD_DEVTOOLS__&&(D(d,"__vnode",e,!0),D(d,"__vueParentComponent",i,!0)),g&&sn(e,null,i,"beforeMount");const y=Tr(o,m);y&&m.beforeEnter(d),r(d,t,n),((p=h&&h.onVnodeMounted)||y||g)&&wr((()=>{p&&ki(p,i,e),y&&m.enter(d),g&&sn(e,null,i,"mounted")}),o)},T=(e,t,n,r,i)=>{if(n&&g(e,n),r)for(let t=0;t<r.length;t++)g(e,r[t]);if(i){let n=i.subTree;if(t===n||Wr(n.type)&&(n.ssContent===t||n.ssFallback===t)){const t=i.vnode;T(e,t,t.scopeId,t.slotScopeIds,i.parent)}}},A=(e,t,n,r,i,o,s,a,l=0)=>{for(let c=l;c<e.length;c++){const l=e[c]=a?bi(e[c]):yi(e[c]);b(null,l,t,n,r,i,o,s,a)}},I=(e,t,n,r,o,s,a)=>{const c=t.el=e.el;__VUE_PROD_DEVTOOLS__&&(c.__vnode=t);let{patchFlag:u,dynamicChildren:d,dirs:p}=t;u|=16&e.patchFlag;const h=e.props||i,v=t.props||i;let m;if(n&&Cr(n,!1),(m=v.onVnodeBeforeUpdate)&&ki(m,n,t,e),p&&sn(t,e,n,"beforeUpdate"),n&&Cr(n,!0),(h.innerHTML&&null==v.innerHTML||h.textContent&&null==v.textContent)&&f(c,""),d?O(e.dynamicChildren,d,c,n,r,Er(t,o),s):a||V(e,t,c,null,n,r,Er(t,o),s,!1),u>0){if(16&u)R(c,h,v,n,o);else if(2&u&&h.class!==v.class&&l(c,"class",null,v.class,o),4&u&&l(c,"style",h.style,v.style,o),8&u){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const r=e[t],i=h[r],s=v[r];s===i&&"value"!==r||l(c,r,i,s,o,n)}}1&u&&e.children!==t.children&&f(c,t.children)}else a||null!=d||R(c,h,v,n,o);((m=v.onVnodeUpdated)||p)&&wr((()=>{m&&ki(m,n,t,e),p&&sn(t,e,n,"updated")}),r)},O=(e,t,n,r,i,o,s)=>{for(let a=0;a<t.length;a++){const l=e[a],c=t[a],u=l.el&&(l.type===Jr||!li(l,c)||70&l.shapeFlag)?v(l.el):n;b(l,c,u,null,r,i,o,s,!0)}},R=(e,t,n,r,o)=>{if(t!==n){if(t!==i)for(const i in t)C(i)||i in n||l(e,i,t[i],null,o,r);for(const i in n){if(C(i))continue;const s=n[i],a=t[i];s!==a&&"value"!==i&&l(e,i,a,s,o,r)}"value"in n&&l(e,"value",t.value,n.value,o)}},P=(e,t,n,i,o,s,a,l,c)=>{const d=t.el=e?e.el:u(""),p=t.anchor=e?e.anchor:u("");let{patchFlag:h,dynamicChildren:f,slotScopeIds:v}=t;v&&(l=l?l.concat(v):v),null==e?(r(d,n,i),r(p,n,i),A(t.children||[],n,p,o,s,a,l,c)):h>0&&64&h&&f&&e.dynamicChildren?(O(e.dynamicChildren,f,n,o,s,a,l),(null!=t.key||o&&t===o.subTree)&&Ar(e,t,!0)):V(e,t,n,p,o,s,a,l,c)},F=(e,t,n,r,i,o,s,a,l)=>{t.slotScopeIds=a,null==e?512&t.shapeFlag?i.ctx.activate(t,n,r,s,l):j(t,n,r,i,o,s,l):U(e,t,l)},j=(e,t,n,r,i,o,s)=>{const a=e.component=Si(e,r,i);if(fn(e)&&(a.ctx.renderer=te),Ni(a,!1,s),a.asyncDep){if(i&&i.registerDep(a,H,s),!e.el){const e=a.subTree=pi(Yr);k(null,e,t,n)}}else H(a,e,t,n,i,o,s)},U=(e,t,n)=>{const r=t.component=e.component;if(function(e,t,n){const{props:r,children:i,component:o}=e,{props:s,children:a,patchFlag:l}=t,c=o.emitsOptions;0;if(t.dirs||t.transition)return!0;if(!(n&&l>=0))return!(!i&&!a||a&&a.$stable)||r!==s&&(r?!s||zr(r,s,c):!!s);if(1024&l)return!0;if(16&l)return r?zr(r,s,c):!!s;if(8&l){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(s[n]!==r[n]&&!Ur(c,n))return!0}}return!1}(e,t,n)){if(r.asyncDep&&!r.asyncResolved)return void q(r,t,n);r.next=t,r.update()}else t.el=e.el,r.vnode=t},H=(e,t,n,r,i,o,s)=>{const a=()=>{if(e.isMounted){let{next:t,bu:n,u:r,parent:l,vnode:c}=e;{const n=Mr(e);if(n)return t&&(t.el=c.el,q(e,t,s)),void n.asyncDep.then((()=>{e.isUnmounted||a()}))}let u,d=t;0,Cr(e,!1),t?(t.el=c.el,q(e,t,s)):t=c,n&&N(n),(u=t.props&&t.props.onVnodeBeforeUpdate)&&ki(u,l,t,c),Cr(e,!0);const p=Hr(e);0;const h=e.subTree;e.subTree=p,b(h,p,v(h.el),Z(h),e,i,o),t.el=p.el,null===d&&Gr(e,p.el),r&&wr(r,i),(u=t.props&&t.props.onVnodeUpdated)&&wr((()=>ki(u,l,t,c)),i),__VUE_PROD_DEVTOOLS__&&Zt(e)}else{let s;const{el:a,props:l}=t,{bm:c,m:u,parent:d,root:p,type:h}=e,f=hn(t);if(Cr(e,!1),c&&N(c),!f&&(s=l&&l.onVnodeBeforeMount)&&ki(s,d,t),Cr(e,!0),a&&ie){const t=()=>{e.subTree=Hr(e),ie(a,e.subTree,e,i,null)};f&&h.__asyncHydrate?h.__asyncHydrate(a,e,t):t()}else{p.ce&&p.ce._injectChildStyle(h);const s=e.subTree=Hr(e);0,b(null,s,n,r,e,i,o),t.el=s.el}if(u&&wr(u,i),!f&&(s=l&&l.onVnodeMounted)){const e=t;wr((()=>ki(s,d,e)),i)}(256&t.shapeFlag||d&&hn(d.vnode)&&256&d.vnode.shapeFlag)&&e.a&&wr(e.a,i),e.isMounted=!0,__VUE_PROD_DEVTOOLS__&&$t(e),t=n=r=null}};e.scope.on();const l=e.effect=new re(a);e.scope.off();const c=e.update=l.run.bind(l),u=e.job=l.runIfDirty.bind(l);u.i=e,u.id=e.uid,l.scheduler=()=>Bt(u),Cr(e,!0),c()},q=(e,t,n)=>{t.component=e;const r=e.vnode.props;e.vnode=t,e.next=null,function(e,t,n,r){const{props:i,attrs:o,vnode:{patchFlag:s}}=e,a=vt(i),[l]=e.propsOptions;let c=!1;if(!(r||s>0)||16&s){let r;pr(e,t,i,o)&&(c=!0);for(const o in a)t&&(h(t,o)||(r=L(o))!==o&&h(t,r))||(l?!n||void 0===n[o]&&void 0===n[r]||(i[o]=hr(l,a,o,void 0,e,!0)):delete i[o]);if(o!==a)for(const e in o)t&&h(t,e)||(delete o[e],c=!0)}else if(8&s){const n=e.vnode.dynamicProps;for(let r=0;r<n.length;r++){let s=n[r];if(Ur(e.emitsOptions,s))continue;const u=t[s];if(l)if(h(o,s))u!==o[s]&&(o[s]=u,c=!0);else{const t=M(s);i[t]=hr(l,a,t,u,e,!1)}else u!==o[s]&&(o[s]=u,c=!0)}}c&&Ie(e.attrs,"set","")}(e,t.props,r,n),((e,t,n)=>{const{vnode:r,slots:o}=e;let s=!0,a=i;if(32&r.shapeFlag){const e=t._;e?n&&1===e?s=!1:xr(o,t,n):(s=!t.$stable,_r(t,o)),a=t}else t&&(kr(e,t),a={default:1});if(s)for(const e in o)gr(e)||null!=a[e]||delete o[e]})(e,t.children,n),ye(),qt(e),be()},V=(e,t,n,r,i,o,s,a,l=!1)=>{const c=e&&e.children,u=e?e.shapeFlag:0,d=t.children,{patchFlag:p,shapeFlag:h}=t;if(p>0){if(128&p)return void G(c,d,n,r,i,o,s,a,l);if(256&p)return void z(c,d,n,r,i,o,s,a,l)}8&h?(16&u&&$(c,i,o),d!==c&&f(n,d)):16&u?16&h?G(c,d,n,r,i,o,s,a,l):$(c,i,o,!0):(8&u&&f(n,""),16&h&&A(d,n,r,i,o,s,a,l))},z=(e,t,n,r,i,s,a,l,c)=>{t=t||o;const u=(e=e||o).length,d=t.length,p=Math.min(u,d);let h;for(h=0;h<p;h++){const r=t[h]=c?bi(t[h]):yi(t[h]);b(e[h],r,n,null,i,s,a,l,c)}u>d?$(e,i,s,!0,!1,p):A(t,n,r,i,s,a,l,c,p)},G=(e,t,n,r,i,s,a,l,c)=>{let u=0;const d=t.length;let p=e.length-1,h=d-1;for(;u<=p&&u<=h;){const r=e[u],o=t[u]=c?bi(t[u]):yi(t[u]);if(!li(r,o))break;b(r,o,n,null,i,s,a,l,c),u++}for(;u<=p&&u<=h;){const r=e[p],o=t[h]=c?bi(t[h]):yi(t[h]);if(!li(r,o))break;b(r,o,n,null,i,s,a,l,c),p--,h--}if(u>p){if(u<=h){const e=h+1,o=e<d?t[e].el:r;for(;u<=h;)b(null,t[u]=c?bi(t[u]):yi(t[u]),n,o,i,s,a,l,c),u++}}else if(u>h)for(;u<=p;)K(e[u],i,s,!0),u++;else{const f=u,v=u,m=new Map;for(u=v;u<=h;u++){const e=t[u]=c?bi(t[u]):yi(t[u]);null!=e.key&&m.set(e.key,u)}let g,y=0;const _=h-v+1;let k=!1,x=0;const w=new Array(_);for(u=0;u<_;u++)w[u]=0;for(u=f;u<=p;u++){const r=e[u];if(y>=_){K(r,i,s,!0);continue}let o;if(null!=r.key)o=m.get(r.key);else for(g=v;g<=h;g++)if(0===w[g-v]&&li(r,t[g])){o=g;break}void 0===o?K(r,i,s,!0):(w[o-v]=u+1,o>=x?x=o:k=!0,b(r,t[o],n,null,i,s,a,l,c),y++)}const S=k?function(e){const t=e.slice(),n=[0];let r,i,o,s,a;const l=e.length;for(r=0;r<l;r++){const l=e[r];if(0!==l){if(i=n[n.length-1],e[i]<l){t[r]=i,n.push(r);continue}for(o=0,s=n.length-1;o<s;)a=o+s>>1,e[n[a]]<l?o=a+1:s=a;l<e[n[o]]&&(o>0&&(t[r]=n[o-1]),n[o]=r)}}o=n.length,s=n[o-1];for(;o-- >0;)n[o]=s,s=t[s];return n}(w):o;for(g=S.length-1,u=_-1;u>=0;u--){const e=v+u,o=t[e],p=e+1<d?t[e+1].el:r;0===w[u]?b(null,o,n,p,i,s,a,l,c):k&&(g<0||u!==S[g]?W(o,n,p,2):g--)}}},W=(e,t,n,i,o=null)=>{const{el:s,type:a,transition:l,children:c,shapeFlag:u}=e;if(6&u)return void W(e.component.subTree,t,n,i);if(128&u)return void e.suspense.move(t,n,i);if(64&u)return void a.move(e,t,n,te);if(a===Jr){r(s,t,n);for(let e=0;e<c.length;e++)W(c[e],t,n,i);return void r(e.anchor,t,n)}if(a===$r)return void(({el:e,anchor:t},n,i)=>{let o;for(;e&&e!==t;)o=m(e),r(e,n,i),e=o;r(t,n,i)})(e,t,n);if(2!==i&&1&u&&l)if(0===i)l.beforeEnter(s),r(s,t,n),wr((()=>l.enter(s)),o);else{const{leave:e,delayLeave:i,afterLeave:o}=l,a=()=>r(s,t,n),c=()=>{e(s,(()=>{a(),o&&o()}))};i?i(s,a,c):c()}else r(s,t,n)},K=(e,t,n,r=!1,i=!1)=>{const{type:o,props:s,ref:a,children:l,dynamicChildren:c,shapeFlag:u,patchFlag:d,dirs:p,cacheIndex:h}=e;if(-2===d&&(i=!1),null!=a&&pn(a,null,n,e,!0),null!=h&&(t.renderCache[h]=void 0),256&u)return void t.ctx.deactivate(e);const f=1&u&&p,v=!hn(e);let m;if(v&&(m=s&&s.onVnodeBeforeUnmount)&&ki(m,t,e),6&u)Y(e.component,n,r);else{if(128&u)return void e.suspense.unmount(n,r);f&&sn(e,null,t,"beforeUnmount"),64&u?e.type.remove(e,t,n,te,r):c&&!c.hasOnce&&(o!==Jr||d>0&&64&d)?$(c,t,n,!1,!0):(o===Jr&&384&d||!i&&16&u)&&$(l,t,n),r&&J(e)}(v&&(m=s&&s.onVnodeUnmounted)||f)&&wr((()=>{m&&ki(m,t,e),f&&sn(e,null,t,"unmounted")}),n)},J=e=>{const{type:t,el:n,anchor:r,transition:i}=e;if(t===Jr)return void X(n,r);if(t===$r)return void w(e);const o=()=>{a(n),i&&!i.persisted&&i.afterLeave&&i.afterLeave()};if(1&e.shapeFlag&&i&&!i.persisted){const{leave:t,delayLeave:r}=i,s=()=>t(n,o);r?r(e.el,o,s):s()}else o()},X=(e,t)=>{let n;for(;e!==t;)n=m(e),a(e),e=n;a(t)},Y=(e,t,n)=>{const{bum:r,scope:i,job:o,subTree:s,um:a,m:l,a:c}=e;var u;Ir(l),Ir(c),r&&N(r),i.stop(),o&&(o.flags|=8,K(s,e,t,n)),a&&wr(a,t),wr((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve()),__VUE_PROD_DEVTOOLS__&&(u=e,Wt&&"function"==typeof Wt.cleanupBuffer&&!Wt.cleanupBuffer(u)&&Qt(u))},$=(e,t,n,r=!1,i=!1,o=0)=>{for(let s=o;s<e.length;s++)K(e[s],t,n,r,i)},Z=e=>{if(6&e.shapeFlag)return Z(e.component.subTree);if(128&e.shapeFlag)return e.suspense.next();const t=m(e.anchor||e.el),n=t&&t[an];return n?m(n):t};let Q=!1;const ee=(e,t,n)=>{null==e?t._vnode&&K(t._vnode,null,null,!0):b(t._vnode||null,e,t,null,null,null,n),t._vnode=e,Q||(Q=!0,qt(),Vt(),Q=!1)},te={p:b,um:K,m:W,r:J,mt:j,mc:A,pc:V,pbc:O,n:Z,o:e};let ne,ie;return t&&([ne,ie]=t(te)),{render:ee,hydrate:ne,createApp:or(ee,ne)}}function Er({type:e,props:t},n){return"svg"===n&&"foreignObject"===e||"mathml"===n&&"annotation-xml"===e&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Cr({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Tr(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Ar(e,t,n=!1){const r=e.children,i=t.children;if(f(r)&&f(i))for(let e=0;e<r.length;e++){const t=r[e];let o=i[e];1&o.shapeFlag&&!o.dynamicChildren&&((o.patchFlag<=0||32===o.patchFlag)&&(o=i[e]=bi(i[e]),o.el=t.el),n||-2===o.patchFlag||Ar(t,o)),o.type===Xr&&(o.el=t.el)}}function Mr(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Mr(t)}function Ir(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const Lr=Symbol.for("v-scx"),Or=()=>{{const e=ar(Lr);return e}};function Rr(e,t,n){return Pr(e,t,n)}function Pr(e,t,n=i){const{immediate:r,deep:o,flush:a,once:l}=n;const c=u({},n);const d=t&&r||!t&&"post"!==a;let p;if(Pi)if("sync"===a){const e=Or();p=e.__watcherHandles||(e.__watcherHandles=[])}else if(!d){const e=()=>{};return e.stop=s,e.resume=s,e.pause=s,e}const h=Ei;c.call=(e,t,n)=>Mt(e,h,t,n);let f=!1;"post"===a?c.scheduler=e=>{wr(e,h&&h.suspense)}:"sync"!==a&&(f=!0,c.scheduler=(e,t)=>{t?e():Bt(e)}),c.augmentJob=e=>{t&&(e.flags|=4),f&&(e.flags|=2,h&&(e.id=h.uid,e.i=h))};const v=Ct(e,t,c);return Pi&&(p?p.push(v):d&&v()),v}function Nr(e,t,n){const r=this.proxy,i=y(e)?e.includes(".")?Dr(r,e):()=>r[e]:e.bind(r,r);let o;g(t)?o=t:(o=t.handler,n=t);const s=Mi(this),a=Pr(i,o.bind(r),n);return s(),a}function Dr(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}const Fr=(e,t)=>"modelValue"===t||"model-value"===t?e.modelModifiers:e[`${t}Modifiers`]||e[`${M(t)}Modifiers`]||e[`${L(t)}Modifiers`];function jr(e,t,...n){if(e.isUnmounted)return;const r=e.vnode.props||i;let o=n;const s=t.startsWith("update:"),a=s&&Fr(r,t.slice(7));let l;a&&(a.trim&&(o=n.map((e=>y(e)?e.trim():e))),a.number&&(o=n.map(F))),__VUE_PROD_DEVTOOLS__&&function(e,t,n){Xt("component:emit",e.appContext.app,e,t,n)}(e,t,o);let c=r[l=R(t)]||r[l=R(M(t))];!c&&s&&(c=r[l=R(L(t))]),c&&Mt(c,e,6,o);const u=r[l+"Once"];if(u){if(e.emitted){if(e.emitted[l])return}else e.emitted={};e.emitted[l]=!0,Mt(u,e,6,o)}}function Br(e,t,n=!1){const r=t.emitsCache,i=r.get(e);if(void 0!==i)return i;const o=e.emits;let s={},a=!1;if(__VUE_OPTIONS_API__&&!g(e)){const r=e=>{const n=Br(e,t,!0);n&&(a=!0,u(s,n))};!n&&t.mixins.length&&t.mixins.forEach(r),e.extends&&r(e.extends),e.mixins&&e.mixins.forEach(r)}return o||a?(f(o)?o.forEach((e=>s[e]=null)):u(s,o),_(e)&&r.set(e,s),s):(_(e)&&r.set(e,null),null)}function Ur(e,t){return!(!e||!l(t))&&(t=t.slice(2).replace(/Once$/,""),h(e,t[0].toLowerCase()+t.slice(1))||h(e,L(t))||h(e,t))}function Hr(e){const{type:t,vnode:n,proxy:r,withProxy:i,propsOptions:[o],slots:s,attrs:a,emit:l,render:u,renderCache:d,props:p,data:h,setupState:f,ctx:v,inheritAttrs:m}=e,g=rn(e);let y,b;try{if(4&n.shapeFlag){const e=i||r,t=e;y=yi(u.call(t,e,d,p,f,h,v)),b=a}else{const e=t;0,y=yi(e.length>1?e(p,{attrs:a,slots:s,emit:l}):e(p,null)),b=t.props?a:qr(a)}}catch(t){Zr.length=0,It(t,e,1),y=pi(Yr)}let _=y;if(b&&!1!==m){const e=Object.keys(b),{shapeFlag:t}=_;e.length&&7&t&&(o&&e.some(c)&&(b=Vr(b,o)),_=fi(_,b,!1,!0))}return n.dirs&&(_=fi(_,null,!1,!0),_.dirs=_.dirs?_.dirs.concat(n.dirs):n.dirs),n.transition&&un(_,n.transition),y=_,rn(g),y}const qr=e=>{let t;for(const n in e)("class"===n||"style"===n||l(n))&&((t||(t={}))[n]=e[n]);return t},Vr=(e,t)=>{const n={};for(const r in e)c(r)&&r.slice(9)in t||(n[r]=e[r]);return n};function zr(e,t,n){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let i=0;i<r.length;i++){const o=r[i];if(t[o]!==e[o]&&!Ur(n,o))return!0}return!1}function Gr({vnode:e,parent:t},n){for(;t;){const r=t.subTree;if(r.suspense&&r.suspense.activeBranch===e&&(r.el=e.el),r!==e)break;(e=t.vnode).el=n,t=t.parent}}const Wr=e=>e.__isSuspense;function Kr(e,t){t&&t.pendingBranch?f(e)?t.effects.push(...e):t.effects.push(e):Ht(e)}const Jr=Symbol.for("v-fgt"),Xr=Symbol.for("v-txt"),Yr=Symbol.for("v-cmt"),$r=Symbol.for("v-stc"),Zr=[];let Qr=null;function ei(e=!1){Zr.push(Qr=e?null:[])}function ti(){Zr.pop(),Qr=Zr[Zr.length-1]||null}let ni=1;function ri(e,t=!1){ni+=e,e<0&&Qr&&t&&(Qr.hasOnce=!0)}function ii(e){return e.dynamicChildren=ni>0?Qr||o:null,ti(),ni>0&&Qr&&Qr.push(e),e}function oi(e,t,n,r,i,o){return ii(di(e,t,n,r,i,o,!0))}function si(e,t,n,r,i){return ii(pi(e,t,n,r,i,!0))}function ai(e){return!!e&&!0===e.__v_isVNode}function li(e,t){return e.type===t.type&&e.key===t.key}const ci=({key:e})=>null!=e?e:null,ui=({ref:e,ref_key:t,ref_for:n})=>("number"==typeof e&&(e=""+e),null!=e?y(e)||yt(e)||g(e)?{i:tn,r:e,k:t,f:!!n}:e:null);function di(e,t=null,n=null,r=0,i=null,o=(e===Jr?0:1),s=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&ci(t),ref:t&&ui(t),scopeId:nn,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:tn};return a?(_i(l,n),128&o&&e.normalize(l)):n&&(l.shapeFlag|=y(n)?8:16),ni>0&&!s&&Qr&&(l.patchFlag>0||6&o)&&32!==l.patchFlag&&Qr.push(l),l}const pi=hi;function hi(e,t=null,n=null,r=0,i=null,o=!1){if(e&&e!==Dn||(e=Yr),ai(e)){const r=fi(e,t,!0);return n&&_i(r,n),ni>0&&!o&&Qr&&(6&r.shapeFlag?Qr[Qr.indexOf(e)]=r:Qr.push(r)),r.patchFlag=-2,r}if(qi(e)&&(e=e.__vccOpts),t){t=function(e){return e?ft(e)||ur(e)?u({},e):e:null}(t);let{class:e,style:n}=t;e&&!y(e)&&(t.class=G(e)),_(n)&&(ft(n)&&!f(n)&&(n=u({},n)),t.style=U(n))}return di(e,t,n,r,i,y(e)?1:Wr(e)?128:ln(e)?64:_(e)?4:g(e)?2:0,o,!0)}function fi(e,t,n=!1,r=!1){const{props:i,ref:o,patchFlag:s,children:a,transition:c}=e,u=t?function(...e){const t={};for(let n=0;n<e.length;n++){const r=e[n];for(const e in r)if("class"===e)t.class!==r.class&&(t.class=G([t.class,r.class]));else if("style"===e)t.style=U([t.style,r.style]);else if(l(e)){const n=t[e],i=r[e];!i||n===i||f(n)&&n.includes(i)||(t[e]=n?[].concat(n,i):i)}else""!==e&&(t[e]=r[e])}return t}(i||{},t):i,d={__v_isVNode:!0,__v_skip:!0,type:e.type,props:u,key:u&&ci(u),ref:t&&t.ref?n&&o?f(o)?o.concat(ui(t)):[o,ui(t)]:ui(t):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Jr?-1===s?16:16|s:s,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:c,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&fi(e.ssContent),ssFallback:e.ssFallback&&fi(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return c&&r&&un(d,c.clone(d)),d}function vi(e=" ",t=0){return pi(Xr,null,e,t)}function mi(e,t){const n=pi($r,null,e);return n.staticCount=t,n}function gi(e="",t=!1){return t?(ei(),si(Yr,null,e)):pi(Yr,null,e)}function yi(e){return null==e||"boolean"==typeof e?pi(Yr):f(e)?pi(Jr,null,e.slice()):ai(e)?bi(e):pi(Xr,null,String(e))}function bi(e){return null===e.el&&-1!==e.patchFlag||e.memo?e:fi(e)}function _i(e,t){let n=0;const{shapeFlag:r}=e;if(null==t)t=null;else if(f(t))n=16;else if("object"==typeof t){if(65&r){const n=t.default;return void(n&&(n._c&&(n._d=!1),_i(e,n()),n._c&&(n._d=!0)))}{n=32;const r=t._;r||ur(t)?3===r&&tn&&(1===tn.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=tn}}else g(t)?(t={default:t,_ctx:tn},n=32):(t=String(t),64&r?(n=16,t=[vi(t)]):n=8);e.children=t,e.shapeFlag|=n}function ki(e,t,n,r=null){Mt(e,t,7,[n,r])}const xi=rr();let wi=0;function Si(e,t,n){const r=e.type,o=(t?t.appContext:e.appContext)||xi,s={uid:wi++,vnode:e,type:r,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new te(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:vr(r,o),emitsOptions:Br(r,o),emit:null,emitted:null,propsDefaults:i,inheritAttrs:r.inheritAttrs,ctx:i,data:i,props:i,attrs:i,slots:i,refs:i,setupState:i,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=jr.bind(null,s),e.ce&&e.ce(s),s}let Ei=null;const Ci=()=>Ei||tn;let Ti,Ai;{const e=B(),t=(t,n)=>{let r;return(r=e[t])||(r=e[t]=[]),r.push(n),e=>{r.length>1?r.forEach((t=>t(e))):r[0](e)}};Ti=t("__VUE_INSTANCE_SETTERS__",(e=>Ei=e)),Ai=t("__VUE_SSR_SETTERS__",(e=>Pi=e))}const Mi=e=>{const t=Ei;return Ti(e),e.scope.on(),()=>{e.scope.off(),Ti(t)}},Ii=()=>{Ei&&Ei.scope.off(),Ti(null)};function Li(e){return 4&e.vnode.shapeFlag}let Oi,Ri,Pi=!1;function Ni(e,t=!1,n=!1){t&&Ai(t);const{props:r,children:i}=e.vnode,o=Li(e);dr(e,r,o,t),((e,t,n)=>{const r=e.slots=cr();if(32&e.vnode.shapeFlag){const e=t._;e?(xr(r,t,n),n&&D(r,"_",e,!0)):_r(t,r)}else t&&kr(e,t)})(e,i,n);const s=o?function(e,t){const n=e.type;0;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Vn),!1;const{setup:r}=n;if(r){ye();const n=e.setupContext=r.length>1?Bi(e):null,i=Mi(e),o=At(r,e,0,[e.props,n]),s=k(o);if(be(),i(),!s&&!e.sp||hn(e)||dn(e),s){if(o.then(Ii,Ii),t)return o.then((n=>{Di(e,n,t)})).catch((t=>{It(t,e,0)}));e.asyncDep=o}else Di(e,o,t)}else Fi(e,t)}(e,t):void 0;return t&&Ai(!1),s}function Di(e,t,n){g(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:_(t)&&(__VUE_PROD_DEVTOOLS__&&(e.devtoolsRawSetupState=t),e.setupState=kt(t)),Fi(e,n)}function Fi(e,t,n){const r=e.type;if(!e.render){if(!t&&Oi&&!r.render){const t=r.template||__VUE_OPTIONS_API__&&Xn(e).template;if(t){0;const{isCustomElement:n,compilerOptions:i}=e.appContext.config,{delimiters:o,compilerOptions:s}=r,a=u(u({isCustomElement:n,delimiters:o},i),s);r.render=Oi(t,a)}}e.render=r.render||s,Ri&&Ri(e)}if(__VUE_OPTIONS_API__){const t=Mi(e);ye();try{Wn(e)}finally{be(),t()}}}const ji={get:(e,t)=>(Me(e,0,""),e[t])};function Bi(e){const t=t=>{e.exposed=t||{}};return{attrs:new Proxy(e.attrs,ji),slots:e.slots,emit:e.emit,expose:t}}function Ui(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(kt((t=e.exposed,!h(t,"__v_skip")&&Object.isExtensible(t)&&D(t,"__v_skip",!0),t)),{get:(t,n)=>n in t?t[n]:n in Hn?Hn[n](e):void 0,has:(e,t)=>t in e||t in Hn})):e.proxy;var t}function Hi(e,t=!0){return g(e)?e.displayName||e.name:e.name||t&&e.__name}function qi(e){return g(e)&&"__vccOpts"in e}const Vi=(e,t)=>{const n=function(e,t,n=!1){let r,i;return g(e)?r=e:(r=e.get,i=e.set),new xt(r,i,n)}(e,0,Pi);return n};const zi="3.5.13";var Gi={class:"c-app_inner"},Wi={id:"loading",class:"c-loading"},Ki=["src"],Ji={class:"c-app_header"},Xi={class:"c-app_body"},Yi={class:"container"};function $i(e){return function(e){if(Array.isArray(e))return eo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Qi(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zi(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Qi(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Qi(e,t){if(e){if("string"==typeof e)return eo(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eo(e,t):void 0}}function eo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function to(e){var t="function"==typeof Map?new Map:void 0;return to=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(io())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var i=new(e.bind.apply(e,r));return n&&ao(i,n.prototype),i}(e,arguments,oo(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),ao(n,e)},to(e)}function no(e,t,n){return t=oo(t),function(e,t){if(t&&("object"==vo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ro(e)}(e,io()?Reflect.construct(t,n||[],oo(e).constructor):t.apply(e,n))}function ro(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function io(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(io=function(){return!!e})()}function oo(e){return oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},oo(e)}function so(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ao(e,t)}function ao(e,t){return ao=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ao(e,t)}function lo(){lo=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof g?t:g,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(e,n,a)}),s}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var p="suspendedStart",h="suspendedYield",f="executing",v="completed",m={};function g(){}function y(){}function b(){}var _={};c(_,s,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==n&&r.call(x,s)&&(_=x);var w=b.prototype=g.prototype=Object.create(_);function S(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function n(i,o,s,a){var l=d(e[i],e,o);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==vo(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(u).then((function(e){c.value=e,s(c)}),(function(e){return n("throw",e,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function C(t,n,r){var i=p;return function(o,s){if(i===f)throw Error("Generator is already running");if(i===v){if("throw"===o)throw s;return{value:e,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=T(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===p)throw i=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=f;var c=d(t,n,r);if("normal"===c.type){if(i=r.done?v:h,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=v,r.method="throw",r.arg=c.arg)}}}function T(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,T(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=d(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(vo(t)+" is not iterable")}return y.prototype=b,i(w,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},S(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var s=new E(u(e,n,r,i),o);return t.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},S(w),c(w,l,"Generator"),c(w,s,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return a.type="throw",a.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),M(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m}},t}function co(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function uo(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){co(o,r,i,s,a,"next",e)}function a(e){co(o,r,i,s,a,"throw",e)}s(void 0)}))}}function po(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ho(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?po(Object(n),!0).forEach((function(t){fo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):po(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fo(e,t,n){return(t=bo(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vo(e){return vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vo(e)}function mo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function go(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,bo(r.key),r)}}function yo(e,t,n){return t&&go(e.prototype,t),n&&go(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function bo(e){var t=function(e,t){if("object"!=vo(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=vo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==vo(t)?t:t+""}var _o=function(){return yo((function e(){mo(this,e)}),null,[{key:"render",value:function(e,t){var n=document.createElement("div");n.id="error-view",n.innerText=t,e.replaceChildren(n)}}])}(),ko=function(){function e(){mo(this,e)}return yo(e,null,[{key:"onLoad",value:function(e){e.innerHTML='<div id="large-loading-ring"></div>'}},{key:"createElements",value:function(){var e=document.createElement("div");return e.id="validate-property-key-view",e}},{key:"render",value:function(t,n,r){var i=e.createElements(),o={onSuccess:n,onFail:_o.render.bind(this,t,"Your 'key' has failed authentication"),onLoad:e.onLoad.bind(this,i)};r.key&&r.verifyKey(r.key,o),t.replaceChildren(i)}}])}(),xo=function(){function e(){mo(this,e)}return yo(e,null,[{key:"unsetStyle",value:function(e,t){var n=Object.keys(t).reduce((function(e,t){return e[t]="",e}),{});Object.assign(e.style,n)}},{key:"unsetActivityCSSMouseStates",value:function(t,n){n.click&&e.unsetStyle(t,n.click),n.hover&&e.unsetStyle(t,n.hover)}},{key:"unsetAllCSSMouseStates",value:function(t,n){e.unsetActivityCSSMouseStates(t,n),n.default&&e.unsetStyle(t,n.default)}},{key:"processStateful",value:function(e,t,n){var r=e.default||{},i=Object.assign(JSON.parse(JSON.stringify(ho(ho({},r),t))),null==e?void 0:e.hover);return{default:r,hover:i,click:Object.assign(JSON.parse(JSON.stringify(ho(ho({},i),n))),null==e?void 0:e.click)}}},{key:"mergeStatefulStyles",value:function(e){var t={default:{},hover:{},click:{}};return e.forEach((function(e){t.default=Object.assign(t.default,e.default),t.hover=Object.assign(t.hover,e.hover),t.click=Object.assign(t.click,e.click)})),t}},{key:"overwriteDefaultWithAlreadyApplied",value:function(e,t){Object.keys(e.default||[]).forEach((function(n){var r,i=n;t.style[i]&&null!=(r=e.default)&&r[i]&&(e.default[n]=t.style[i])}))}},{key:"applyToStyleIfNotDefined",value:function(e,t){for(var n in t){var r=t[n];""===e[n]&&r&&(e[n]=r)}}}])}(),wo=function(){function e(){mo(this,e)}return yo(e,null,[{key:"attemptAppendStyleSheetToHead",value:function(t){if(!t.fontFamily||t.fontFamily===e.DEFAULT_FONT_FAMILY){var n=document.getElementsByTagName("head")[0];if(!Array.from(n.getElementsByTagName("link")).some((function(t){return t.getAttribute("href")===e.FONT_URL}))){var r=document.createElement("link");r.rel="stylesheet",r.href=e.FONT_URL,n.appendChild(r)}}}}])}();wo.FONT_URL="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap",wo.DEFAULT_FONT_FAMILY="'Inter', sans-serif, Avenir, Helvetica, Arial";var So=wo,Eo=function(){function e(){mo(this,e)}return yo(e,null,[{key:"apply",value:function(t,n){if(n)try{e.applyStyleSheet(t,n)}catch(r){e.addStyleElement(t,n)}}},{key:"applyStyleSheet",value:function(e,t){var n=new CSSStyleSheet;n.replaceSync(e),t.adoptedStyleSheets.push(n)}},{key:"addStyleElement",value:function(e,t){var n=document.createElement("style");n.innerHTML=e,t.appendChild(n)}},{key:"applyDefaultStyleToComponent",value:function(t,n){n&&xo.applyToStyleIfNotDefined(t,n),xo.applyToStyleIfNotDefined(t,e.DEFAULT_COMPONENT_STYLE)}}])}();Eo.DEFAULT_COMPONENT_STYLE={height:"350px",width:"320px",border:"1px solid #cacaca",fontFamily:So.DEFAULT_FONT_FAMILY,fontSize:"0.9rem",backgroundColor:"white",position:"relative",overflow:"hidden"};var Co,To=Eo,Ao=function(e){return e.ESCAPE="Escape",e.ENTER="Enter",e.TAB="Tab",e.ARROW_UP="ArrowUp",e.ARROW_DOWN="ArrowDown",e.ARROW_RIGHT="ArrowRight",e.ARROW_LEFT="ArrowLeft",e.BACKSPACE="Backspace",e.DELETE="Delete",e.META="Meta",e.CONTROL="Control",e}(Ao||{}),Mo=((Co=yo((function e(){mo(this,e)}))).IS_SAFARI=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),Co.IS_CHROMIUM=window.chrome,Co),Io=function(){function e(){mo(this,e)}return yo(e,null,[{key:"add",value:function(t,n,r,i){void 0!==r&&t.addEventListener("keydown",e.onKeyDown.bind(this,r)),t.oninput=e.onInput.bind(this,r,i),t.addEventListener("paste",(function(e){var t;e.preventDefault(),null!=(t=e.clipboardData)&&t.files.length&&n.addFilesToAnyType(Array.from(e.clipboardData.files))}))}},{key:"onKeyDown",value:function(t,n){var r=n.target.textContent;r&&r.length>=t&&!e.PERMITTED_KEYS.has(n.key)&&!e.isKeyCombinationPermitted(n)&&n.preventDefault()}},{key:"isKeyCombinationPermitted",value:function(e){return"a"===e.key&&(e.ctrlKey||e.metaKey)}},{key:"onInput",value:function(e,t,n){var r=n.target,i=r.textContent||"";void 0!==e&&i.length>e&&(r.textContent=i.substring(0,e),No.focusEndOfInput(r)),null==t||t()}}])}();Io.PERMITTED_KEYS=new Set([Ao.BACKSPACE,Ao.DELETE,Ao.ARROW_RIGHT,Ao.ARROW_LEFT,Ao.ARROW_DOWN,Ao.ARROW_UP,Ao.META,Ao.CONTROL,Ao.ENTER]);var Lo=Io,Oo=function(){return yo((function e(){mo(this,e)}),null,[{key:"sanitizePastedTextContent",value:function(e){var t,n;e.preventDefault();var r=null==(t=e.clipboardData)?void 0:t.getData("text/plain");r&&(null==(n=document.execCommand)||n.call(document,"insertText",!1,r))}}])}(),Ro=function(){function e(t,n,r){var i,o,s,a=this;mo(this,e);var l=e.processConfig(n,t.textInput);this.elementRef=e.createContainerElement(null==(i=null==l?void 0:l.styles)?void 0:i.container),this.inputElementRef=this.createInputElement(l),this._config=l,this.elementRef.appendChild(this.inputElementRef),t.setPlaceholderText=this.setPlaceholderText.bind(this,t),t.setPlaceholderText((null==(s=null==(o=t.textInput)?void 0:o.placeholder)?void 0:s.text)||"Ask me anything!"),setTimeout((function(){var e;Lo.add(a.inputElementRef,r,null==(e=t.textInput)?void 0:e.characterLimit,t._validationHandler)}))}return yo(e,[{key:"createInputElement",value:function(t){var n,r,i=document.createElement("div");return i.id=e.TEXT_INPUT_ID,i.classList.add("text-input-styling",e.PLACEHOLDER_TEXT_CLASS),Mo.IS_CHROMIUM&&e.preventAutomaticScrollUpOnNewLine(i),"boolean"==typeof(null==t?void 0:t.disabled)&&!0===t.disabled?(i.contentEditable="false",i.classList.add("text-input-disabled")):(i.contentEditable="true",this.addEventListeners(i,t)),Object.assign(i.style,null==(n=null==t?void 0:t.styles)?void 0:n.text),Object.assign(i.style,null==(r=null==t?void 0:t.placeholder)?void 0:r.style),i}},{key:"removeTextIfPlaceholder",value:function(){var t,n,r,i;this.inputElementRef.classList.contains(e.PLACEHOLDER_TEXT_CLASS)&&!this.inputElementRef.classList.contains("text-input-disabled")&&(null!=(t=this._config.placeholder)&&t.style&&(xo.unsetStyle(this.inputElementRef,null==(n=this._config.placeholder)?void 0:n.style),Object.assign(this.inputElementRef.style,null==(i=null==(r=this._config)?void 0:r.styles)?void 0:i.text)),e.clear(this.inputElementRef),this.inputElementRef.classList.remove(e.PLACEHOLDER_TEXT_CLASS))}},{key:"addEventListeners",value:function(e,t){var n,r,i;e.onfocus=this.onFocus.bind(this,null==(n=null==t?void 0:t.styles)?void 0:n.focus),null!=(r=null==t?void 0:t.styles)&&r.focus&&(e.onblur=this.onBlur.bind(this,t.styles.focus,null==(i=null==t?void 0:t.styles)?void 0:i.container)),e.addEventListener("keydown",this.onKeydown.bind(this)),e.addEventListener("paste",Oo.sanitizePastedTextContent)}},{key:"onFocus",value:function(e){var t=this;Mo.IS_SAFARI?setTimeout((function(){t.removeTextIfPlaceholder()})):this.removeTextIfPlaceholder(),Object.assign(this.elementRef.style,e)}},{key:"onBlur",value:function(e,t){xo.unsetStyle(this.elementRef,e),t&&Object.assign(this.elementRef.style,t)}},{key:"onKeydown",value:function(e){var t;e.key===Ao.ENTER&&!e.ctrlKey&&!e.shiftKey&&(e.preventDefault(),null==(t=this.submit)||t.call(this))}},{key:"setPlaceholderText",value:function(t,n){document.activeElement!==t&&(""===this.inputElementRef.textContent&&this.inputElementRef.classList.add(e.PLACEHOLDER_TEXT_CLASS),this.inputElementRef.classList.contains(e.PLACEHOLDER_TEXT_CLASS)&&(this.inputElementRef.textContent=n))}}],[{key:"processConfig",value:function(e,t){var n,r,i,o,s;return null!==(n=t)&&void 0!==n||(t={}),null!==(r=t.disabled)&&void 0!==r||(t.disabled=e.isTextInputDisabled),null!==(i=t.placeholder)&&void 0!==i||(t.placeholder={}),null!==(o=(s=t.placeholder).text)&&void 0!==o||(s.text=e.textInputPlaceholderText),t}},{key:"preventAutomaticScrollUpOnNewLine",value:function(e){var t;e.addEventListener("keydown",(function(){t=window.scrollY})),e.addEventListener("input",(function(){t!==window.scrollY&&window.scrollTo({top:t})}))}},{key:"clear",value:function(e){var t=window.scrollY;e.classList.contains("text-input-disabled")||(e.textContent=""),Mo.IS_CHROMIUM&&window.scrollTo({top:t})}},{key:"toggleEditability",value:function(e,t){e.contentEditable=t?"true":"false"}},{key:"createContainerElement",value:function(e){var t=document.createElement("div");return t.id="text-input-container",Object.assign(t.style,e),t}}])}();Ro.TEXT_INPUT_ID="text-input",Ro.PLACEHOLDER_TEXT_CLASS="text-input-placeholder";var Po=Ro,No=function(){function e(){mo(this,e)}return yo(e,null,[{key:"focusEndOfInput",value:function(e){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var n=window.getSelection();null==n||n.removeAllRanges(),null==n||n.addRange(t)}},{key:"focusFromParentElement",value:function(t){var n=t.querySelector("#".concat(Po.TEXT_INPUT_ID));n&&e.focusEndOfInput(n)}}])}();function Do(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Fo(e,t,n,r){var i="\n".concat(Do(t)," message: ").concat(JSON.stringify(e)," \n"),o=n?"".concat(Do(t)," message after interceptor: ").concat(function(e){return e&&JSON.stringify(e)}(r)," \n"):"";return i+o}var jo="Make sure the events are using {text: string} or {html: string} format.\nYou can also augment them using the responseInterceptor property: https://deepchat.dev/docs/interceptors#responseInterceptor",Bo={INVALID_KEY:"Invalid API Key",CONNECTION_FAILED:"Failed to connect",INVALID_RESPONSE:function(e,t,n,r){return"".concat(Fo(e,t,n,r),"Make sure the ").concat(t," message is using the Response format: https://deepchat.dev/docs/connect/#Response \nYou can also augment it using the responseInterceptor property: https://deepchat.dev/docs/interceptors#responseInterceptor")},INVALID_MODEL_REQUEST:function(e,t){var n="request";return"".concat(Fo(e,n,t),"Make sure the ").concat(n,' message is using the {body: {text: string}} format, e.g: {body: {text: "Model Response"}}')},INVALID_MODEL_RESPONSE:function(e,t,n){var r="response";return"".concat(Fo(e,r,t,n),"Make sure the ").concat(r,' message is using the {text: string} format, e.g: {text: "Model Response"}')},INVALID_STREAM_EVENT:jo,INVALID_STREAM_EVENT_MIX:"Cannot mix {text: string} and {html: string} responses.",NO_VALID_STREAM_EVENTS_SENT:"No valid stream events were sent.\n".concat(jo)},Uo=function(){function e(){mo(this,e)}return yo(e,null,[{key:"addElements",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach((function(t){return e.appendChild(t)}))}},{key:"isScrollbarAtBottomOfElement",value:function(t){var n=t.scrollHeight,r=t.clientHeight;return t.scrollTop>=n-r-e.CODE_SNIPPET_GENERATION_JUMP}},{key:"cloneElement",value:function(e){var t=e.cloneNode(!0);return e.parentNode.replaceChild(t,e),t}},{key:"scrollToBottom",value:function(e){e.scrollTop=e.scrollHeight}},{key:"scrollToTop",value:function(e){e.scrollTop=0}}])}();Uo.CODE_SNIPPET_GENERATION_JUMP=.5;var Ho=Uo,qo=function(){function e(){mo(this,e)}return yo(e,null,[{key:"speak",value:function(e,t){if(window.SpeechSynthesisUtterance){var n=new SpeechSynthesisUtterance(e);Object.assign(n,t),speechSynthesis.speak(n)}}},{key:"processConfig",value:function(t,n){var r={};setTimeout((function(){if("object"==vo(t)&&(t.lang&&(r.lang=t.lang),t.pitch&&(r.pitch=t.pitch),t.rate&&(r.rate=t.rate),t.volume&&(r.volume=t.volume),t.voiceName)){var e=window.speechSynthesis.getVoices().find((function(e){var n;return e.name.toLocaleLowerCase()===(null==(n=t.voiceName)?void 0:n.toLocaleLowerCase())}));e&&(r.voice=e)}n(r)}),e.LOAD_VOICES_MS)}}])}();qo.LOAD_VOICES_MS=200;var Vo=qo,zo=function(){return yo((function e(){mo(this,e)}),null,[{key:"checkForContainerStyles",value:function(e,t){var n=e.containerStyle;n&&(Object.assign(t.style,n),console.error("The containerStyle property is deprecated since version 1.3.14."),console.error("Please change to using the style property instead: https://deepchat.dev/docs/styles#style"))}},{key:"handleResponseProperty",value:function(e){return console.error("The {result: ....} response object type is deprecated since version 1.3.0."),console.error("Please change to using the new response object: https://deepchat.dev/docs/connect#Response"),e.result}},{key:"processHistory",value:function(e){var t=e.initialMessages;if(t)return console.error("The initialMessages property is deprecated since version 2.0.0."),console.error("Please change to using the history property instead: https://deepchat.dev/docs/messages/#history"),t}},{key:"processHistoryFile",value:function(e){var t=e.file;t&&(console.error("The file property in MessageContent is deprecated since version 1.3.17."),console.error("Please change to using the files array property: https://deepchat.dev/docs/messages/#MessageContent"),e.files=[t])}},{key:"processValidateInput",value:function(e){var t=e.validateMessageBeforeSending;if(t)return console.error("The validateMessageBeforeSending property is deprecated since version 1.3.24."),console.error("Please change to using validateInput: https://deepchat.dev/docs/interceptors#validateInput"),t}},{key:"processSubmitUserMessage",value:function(e){return console.error("The submitUserMessage(text: string) argument string type is deprecated since version 1.4.4."),console.error("Please change to using the new argument type: https://deepchat.dev/docs/methods#submitUserMessage"),{text:e}}},{key:"flagHTMLUpdateClass",value:function(e){var t;null!=(t=e.children[0])&&t.classList.contains("deep-chat-update-message")&&(console.error('The "deep-chat-update-message" html class is deprecated since version 1.4.4.'),console.error("Please change to using {..., overwrite: true} object: https://deepchat.dev/docs/connect#Response"))}},{key:"processConnect",value:function(e){var t=e;t.request&&(t.connect?Object.assign(t.connect,t.request):t.connect=t.request,console.error("The request property is deprecated since version 2.0.0."),console.error("Please see the connect object: https://deepchat.dev/docs/connect#connect-1"))}},{key:"checkForStream",value:function(e){var t=e.stream;if(t)return console.error("The stream property has been moved to the connect object in version 2.0.0."),console.error("Please see the connect object: https://deepchat.dev/docs/connect#connect-1"),t}},{key:"fireOnNewMessage",value:function(e,t){var n,r=e;r.onNewMessage&&(console.error("The onNewMessage event has been deprecated since version 2.0.0."),console.error("Please see the onMessage event: https://deepchat.dev/docs/events#onMessage"),null==(n=r.onNewMessage)||n.call(r,t)),e.dispatchEvent(new CustomEvent("new-message",{detail:t}))}},{key:"processFileConfigConnect",value:function(e){var t=e;t.request&&(console.error("The request property in file configuration is deprecated since version 2.0.0."),console.error("Please use the connect property instead: https://deepchat.dev/docs/files"),t.connect||(t.connect=t.request))}}])}(),Go=function(){function e(){mo(this,e)}return yo(e,null,[{key:"hide",value:function(t){var n;(n=t.getElementsByClassName(e.CONTAINER_CLASS)[0].style).visibility||(n.visibility="hidden")}},{key:"applyCustomStylesToElements",value:function(e,t,n){Object.assign(e.style,n.container),Object.assign(t.style,n.avatar)}},{key:"applyCustomStyles",value:function(t,n,r,i){var o,s,a,l;if(null!=(o=r.default)&&o.styles&&e.applyCustomStylesToElements(t,n,r.default.styles),i===$o.USER_ROLE)null!=(s=r.user)&&s.styles&&e.applyCustomStylesToElements(t,n,r.user.styles);else{null!=(a=r.ai)&&a.styles&&e.applyCustomStylesToElements(t,n,r.ai.styles);var c=null==(l=r[i])?void 0:l.styles;c&&e.applyCustomStylesToElements(t,n,c)}}},{key:"createAvatar",value:function(t,n){var r,i,o,s,a,l=document.createElement("img");t===$o.USER_ROLE?l.src=(null==(r=null==n?void 0:n.user)?void 0:r.src)||(null==(i=null==n?void 0:n.default)?void 0:i.src)||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPoAAAD6CAMAAAC/MqoPAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAADNQTFRF////9vX18vLy/Pz86enp4+Li2tnZ1tbWzczM+fn57Ozs4N/f09LS0M/P5uXl7+/v3dzcwtncCAAAAAFiS0dEAIgFHUgAAAAJcEhZcwAAAEgAAABIAEbJaz4AAAZNSURBVHja7d3bdtsqEABQYABZSLH9/3+ZpnUsIcF5iOM6PfElNoMHMfPQdq3GmL0GkLhEUqLaUExnOtOZznSmM53pTGc605nOdKYznelMZzrTmV4LXSqllKyJDkob26xWq8Zae/iH0QoWTm9d1xur4WuypQJtTd+5dqn0VjcxzNO5/57mEBvdLo8Oron6aseWOjYOFkVvjQs3DmgyONMuht52EfztP+4hdu0i6LCO808/M8c1lE/fuPGej41uUzgdtoO/75N+2ELJ9I3b3//hPXbiMenm3pR/Jt4USgcLBIp4Bh10gqKVhvLo0klCxeSky96nKcj3siw6pJIL4XsoiQ7apyvMY/V3HHrSRioLopvEhSpTCn2TPEuwKYMOIX0tAxRBf/Hpa+lfSqBv9gi1FPsNfTrMAiVmIE/vJhz61FGnQxRIEYE4vfNYdN8Rp6MlHaHotHTn8ejekaZPAjEmyvQWdZFTtYTpXqCGJ0zvcek9Yfoel76nS0ffv1NMp1ca+pkgyfRCGind4L7OWWc605l+cxjsyhqy9AGbPpClc1/nvl5VX0c/3Alk6RU3+Am7shNZ+h6bvidLr7jBB+zKBrL0irOOudmIUDzTmf5gIP+iEuXtRuTVaEmY/oZLfyNMrzjryPc0gerMTdpVg0tvjJUU6bLPcGOoUv46SLL6Wi8yhLf06C7TUyekI0efRaaYqdFltkeNpPumRPSMDxgBYvSM035FrKAmH72hRW99PrpvSdEHkTEGUvSsK3yKVDkuJ92RohcZaehzzirPpOg+J92Tolfc4Cumx5xVXpGiZ34+ICX6W84qv5GiR5NPbiIpOv6BCoSvSkTX+eiaGP092zINvBOj4x8mSf9FqejvNo/cvpOji19ZbmviL0GPLsYMFzgzCor0+Bv/ePDvSJKOb9dJ5UlnbnEHiHgzv6cdTpJOWuc/u3FEucLDOL75xGtBiefrcwgoC9NDSH/jkH6pAuXmBqPQ9HSUPVdZBH1GGOrMXAQdYxcKZfxAoK+KKBKFLosoEoX+u4giUehz8jlcnAuhp78I46yDYNAd+QLR6K+pr+yvxdBTHyVDubQh0UfSxaHSd0lbvNkVRE87JGOtc+PQd2QLQ6fHhJkKsSh6yg13tO08JPprsgrrXWH0dJd2vH1MLPprot4eXoujpzrdhngiD40ek2y92lggPcnWa8qN1Yz0BFuvZhRl0uOfR0v4Ewuli/Bg4Qr3lArqGdndQ3UPO1EunXYwnelMZzrTmc50pjOd6UxnOtOZznSmM53pTGf6kuj6oedFKV0s3fX6sX1S3bsi6a4PD7+/YAqYeBw6pIB/4qEgOqxdSPbGiim4NRRCbzs3Jj0L4UfXtQXQVRfn5IdA/Bw7RZzurEV6EtdsLeGXkIPuA+K1UoVeA0l62zmN/LqfSSft9KkepmoRuvi3nd5uKNFB9zbbXEANqdr941XO0NJx2v2jdJenpf+/3bvn0ts16ph+sd6hX7dPo2+2cZzE02Ia43bzDHqr+2Evnhz74ZHU30ffbKOeng1/NPV30Ns1gYQnSP2P6e65Pfxc6h02XZqXQCjhJ6kPL6bFo4NrGvAU4UII4SE2P1vQuZkuOxckVfehisF1MjUddN/MZBN+kvq5uf0O/xa66gyNS9ktMWlz44rO1Z8C19i5FPdHzPamXn+F3hryPfxMr78+4F+kq22kO6Rf6fUQt+puuustyWv4rbG3l/duztFB96GYoe1cTBdXMr+nw9qVM6ZfxOvzezff0nXi/ZOndvrR6Zvpm0c3h6nhdb+5iS7tsIim/qXZD9+97/Jf+rpZ5BET1ayv0GUzLhEuhBBjIy/RdVPgndutIRt9nt7p5cKFEEJ3Z+jQFDZL+XnMDXxHB73gxn5s9Kc3d3/pFciFkN/QTSXHJpX5l66gDrkQoP6hL3xsPw39la4qOiV8tH78XeSbue6N9mvWa6J/ybpc1CT1Wnh5Qq9meP8IOKH3ddH7E/ri1iYux/SXDrXR4UiPdck/wUpU+FtPf6/orja6O9KL3l56LOvVxe5Ib2qjN0d6Vbex4ghWlU3bPqI90If66MNng680FNpbJijH6kCvaF3uMzQ3+IrpFerV4Y9dffQdN3im10ivbuImhD3Qq5u4HdZkua8znelMZ/pS4z9CPVKkxowNxgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNy0wMy0yN1QxNTo0NToxNSswMDowMN1xSg4AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTctMDMtMjdUMTU6NDU6MTUrMDA6MDCsLPKyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAABJRU5ErkJggg==":l.src=(null==(o=null==n?void 0:n[t])?void 0:o.src)||(null==(s=null==n?void 0:n.ai)?void 0:s.src)||(null==(a=null==n?void 0:n.default)?void 0:a.src)||"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='iso-8859-1'?%3e%3csvg%20fill='%23000000'%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0%200%2032%2032'%20xml:space='preserve'%3e%3cpath%20d='M23,30.36H9c-2.404,0-4.36-1.956-4.36-4.36V15c0-2.404,1.956-4.36,4.36-4.36h3.659%20c0.167-1.566,1.415-2.813,2.981-2.981V5.333c-1.131-0.174-2-1.154-2-2.333c0-1.301,1.059-2.36,2.36-2.36%20c1.302,0,2.36,1.059,2.36,2.36c0,1.179-0.869,2.159-2,2.333V7.66c1.566,0.167,2.814,1.415,2.981,2.981H23%20c2.404,0,4.36,1.956,4.36,4.36v11C27.36,28.404,25.404,30.36,23,30.36z%20M9,11.36c-2.007,0-3.64,1.633-3.64,3.64v11%20c0,2.007,1.633,3.64,3.64,3.64h14c2.007,0,3.64-1.633,3.64-3.64V15c0-2.007-1.633-3.64-3.64-3.64H9z%20M13.384,10.64h5.231%20C18.439,9.354,17.334,8.36,16,8.36C14.667,8.36,13.561,9.354,13.384,10.64z%20M16,1.36c-0.904,0-1.64,0.736-1.64,1.64%20S15.096,4.64,16,4.64c0.904,0,1.64-0.736,1.64-1.64S16.904,1.36,16,1.36z%20M20,27.36h-8c-1.301,0-2.36-1.059-2.36-2.36%20s1.059-2.36,2.36-2.36h8c1.302,0,2.36,1.059,2.36,2.36S21.302,27.36,20,27.36z%20M12,23.36c-0.904,0-1.64,0.735-1.64,1.64%20s0.736,1.64,1.64,1.64h8c0.904,0,1.64-0.735,1.64-1.64s-0.735-1.64-1.64-1.64H12z%20M31,23.86h-2c-0.199,0-0.36-0.161-0.36-0.36V15%20c0-0.199,0.161-0.36,0.36-0.36h2c0.199,0,0.36,0.161,0.36,0.36v8.5C31.36,23.699,31.199,23.86,31,23.86z%20M29.36,23.14h1.279v-7.78%20H29.36V23.14z%20M3,23.86H1c-0.199,0-0.36-0.161-0.36-0.36V15c0-0.199,0.161-0.36,0.36-0.36h2c0.199,0,0.36,0.161,0.36,0.36v8.5%20C3.36,23.699,3.199,23.86,3,23.86z%20M1.36,23.14h1.28v-7.78H1.36V23.14z%20M20,20.36c-1.302,0-2.36-1.059-2.36-2.36%20s1.059-2.36,2.36-2.36s2.36,1.059,2.36,2.36C22.36,19.302,21.302,20.36,20,20.36z%20M20,16.36c-0.904,0-1.64,0.736-1.64,1.64%20s0.735,1.64,1.64,1.64s1.64-0.735,1.64-1.64S20.904,16.36,20,16.36z%20M12,20.36c-1.301,0-2.36-1.059-2.36-2.36s1.059-2.36,2.36-2.36%20s2.36,1.059,2.36,2.36C14.36,19.302,13.301,20.36,12,20.36z%20M12,16.36c-0.904,0-1.64,0.736-1.64,1.64s0.736,1.64,1.64,1.64%20s1.64-0.735,1.64-1.64S12.904,16.36,12,16.36z'/%3e%3crect%20style='fill:none;'%20width='32'%20height='32'/%3e%3c/svg%3e",l.classList.add("avatar");var c=document.createElement("div");return c.classList.add(e.CONTAINER_CLASS),c.appendChild(l),n&&e.applyCustomStyles(c,l,n,t),c}},{key:"getPosition",value:function(e,t){var n,r,i,o,s,a,l,c,u,d=null==(s=null==(o=null==t?void 0:t[e])?void 0:o.styles)?void 0:s.position;return e!==$o.USER_ROLE&&(null!==(n=d)&&void 0!==n||(d=null==(l=null==(a=null==t?void 0:t.ai)?void 0:a.styles)?void 0:l.position)),null!==(r=d)&&void 0!==r||(d=null==(u=null==(c=null==t?void 0:t.default)?void 0:c.styles)?void 0:u.position),null!==(i=d)&&void 0!==i||(d=e===$o.USER_ROLE?"right":"left"),d}},{key:"add",value:function(t,n,r){var i="boolean"==typeof r?void 0:r,o=e.createAvatar(n,i),s=e.getPosition(n,i);o.classList.add("left"===s?"left-item-position":"right-item-position"),t.insertAdjacentElement("left"===s?"beforebegin":"afterend",o)}}])}();Go.CONTAINER_CLASS="avatar-container";var Wo=Go,Ko=function(){function e(){mo(this,e)}return yo(e,null,[{key:"hide",value:function(t){var n;(n=t.getElementsByClassName(e.NAME_CLASS)[0].style).visibility||(n.visibility="hidden")}},{key:"getPosition",value:function(e,t){var n,r,i,o,s,a,l=null==(o=null==t?void 0:t[e])?void 0:o.position;return e!==$o.USER_ROLE&&(null!==(n=l)&&void 0!==n||(l=null==(s=null==t?void 0:t.ai)?void 0:s.position)),null!==(r=l)&&void 0!==r||(l=null==(a=null==t?void 0:t.default)?void 0:a.position),null!==(i=l)&&void 0!==i||(l=e===$o.USER_ROLE?"right":"left"),l}},{key:"applyStyle",value:function(e,t,n){var r,i,o,s;Object.assign(e.style,null==(r=n.default)?void 0:r.style),t===$o.USER_ROLE?Object.assign(e.style,null==(i=n.user)?void 0:i.style):(Object.assign(e.style,null==(o=n.ai)?void 0:o.style),Object.assign(e.style,null==(s=n[t])?void 0:s.style))}},{key:"getNameText",value:function(e,t){var n,r,i,o,s,a;return e===$o.USER_ROLE?(null==(n=t.user)?void 0:n.text)||(null==(r=t.default)?void 0:r.text)||"User":e===$o.AI_ROLE?(null==(i=t.ai)?void 0:i.text)||(null==(o=t.default)?void 0:o.text)||"AI":(null==(s=t[e])?void 0:s.text)||(null==(a=t.default)?void 0:a.text)||e}},{key:"createName",value:function(t,n){var r=document.createElement("div");return r.classList.add(e.NAME_CLASS),r.textContent=e.getNameText(t,n),e.applyStyle(r,t,n),r}},{key:"add",value:function(t,n,r){var i="boolean"==typeof r?{}:r,o=e.createName(n,i),s=e.getPosition(n,i);o.classList.add("left"===s?"left-item-position":"right-item-position"),t.insertAdjacentElement("left"===s?"beforebegin":"afterend",o)}}])}();Ko.NAME_CLASS="name";var Jo=Ko,Xo=function(){function e(){mo(this,e)}return yo(e,null,[{key:"getLastElementsByClass",value:function(e,t,n){for(var r,i=function(){var r=e[o];if(r.bubbleElement.classList.contains(t[0])&&!t.slice(1).find((function(e){return!r.bubbleElement.classList.contains(e)}))){if(!n)return{v:r};if(!n.find((function(e){return r.bubbleElement.classList.contains(e)})))return{v:r}}},o=e.length-1;o>=0;o-=1)if(r=i())return r.v}},{key:"getLastMessage",value:function(e,t,n){for(var r=e.length-1;r>=0;r-=1)if(e[r].role===t){if(!n)return e[r];if(e[r][n])return e[r]}}},{key:"getLastTextToElement",value:function(e,t){for(var n=e.length-1;n>=0;n-=1)if(e[n][0]===t)return e[n]}},{key:"overwriteMessage",value:function(t,n,r,i,o,s){var a=e.getLastElementsByClass(n,[e.getRoleClass(i),s],["loading-message-text"]),l=e.getLastMessage(t,i,o);return l&&(l[o]=r),a}},{key:"getRoleClass",value:function(e){return"".concat(e,"-message")}},{key:"fillEmptyMessageElement",value:function(t,n){0===n.trim().length&&(t.classList.add(e.EMPTY_MESSAGE_CLASS),t.innerHTML='<div style="color:#00000000">.</div>')}},{key:"unfillEmptyMessageElement",value:function(t,n){t.classList.contains(e.EMPTY_MESSAGE_CLASS)&&n.trim().length>0&&t.replaceChildren()}},{key:"getLastMessageBubbleElement",value:function(t){var n,r,i;return Array.from((null==(i=null==(r=null==(n=e.getLastMessageElement(t))?void 0:n.children)?void 0:r[0])?void 0:i.children)||[]).find((function(e){return e.classList.contains("message-bubble")}))}},{key:"getLastMessageElement",value:function(e){return e.children[e.children.length-1]}},{key:"addRoleElements",value:function(e,t,n,r){n&&Wo.add(e,t,n),r&&Jo.add(e,t,r)}},{key:"hideRoleElements",value:function(e,t,n){var r=e[e.length-1].innerContainer;t&&Wo.hide(r),n&&Jo.hide(r)}},{key:"updateRefArr",value:function(e,t,n){n?e.unshift(t):e.push(t)}}])}();Xo.AI_ROLE="ai",Xo.USER_ROLE="user",Xo.EMPTY_MESSAGE_CLASS="empty-message";var Yo,$o=Xo,Zo=function(){function e(){mo(this,e)}return yo(e,null,[{key:"mouseUp",value:function(e,t){xo.unsetAllCSSMouseStates(e,t),Object.assign(e.style,t.default),Object.assign(e.style,t.hover)}},{key:"mouseDown",value:function(e,t){Object.assign(e.style,t.click)}},{key:"mouseLeave",value:function(e,t){xo.unsetAllCSSMouseStates(e,t),Object.assign(e.style,t.default)}},{key:"mouseEnter",value:function(e,t){Object.assign(e.style,t.hover)}},{key:"add",value:function(t,n){t.addEventListener("mouseenter",e.mouseEnter.bind(this,t,n)),t.addEventListener("mouseleave",e.mouseLeave.bind(this,t,n)),t.addEventListener("mousedown",e.mouseDown.bind(this,t,n)),t.addEventListener("mouseup",e.mouseUp.bind(this,t,n))}}])}(),Qo={"deep-chat-button":{styles:{default:{backgroundColor:"white",padding:"5px",paddingLeft:"7px",paddingRight:"7px",border:"1px solid #c2c2c2",borderRadius:"6px",cursor:"pointer"},hover:{backgroundColor:"#fafafa"},click:{backgroundColor:"#f1f1f1"}}}},es=Object.keys(Qo),ts=function(){function e(){mo(this,e)}return yo(e,null,[{key:"applySuggestionEvent",value:function(e,t){setTimeout((function(){t.addEventListener("click",(function(){var n,r;null==(r=e.submitUserMessage)||r.call(e,{text:(null==(n=t.textContent)?void 0:n.trim())||""})}))}))}},{key:"isElementTemporary",value:function(e){var t;return!!e&&(null==(t=e.bubbleElement.children[0])?void 0:t.classList.contains("deep-chat-temporary-message"))}},{key:"doesElementContainDeepChatClass",value:function(e){return es.find((function(t){return e.classList.contains(t)}))}},{key:"applyEvents",value:function(e,t){var n=Qo[t].events;Object.keys(n||[]).forEach((function(t){e.addEventListener(t,null==n?void 0:n[t])}))}},{key:"getProcessedStyles",value:function(e,t,n){var r=Array.from(t.classList).reduce((function(t,n){var r,i=null==(r=e[n])?void 0:r.styles;return i&&e[n].styles&&t.push(i),t}),[]),i=Qo[n].styles;if(i){var o=JSON.parse(JSON.stringify(i));o.default&&xo.overwriteDefaultWithAlreadyApplied(o,t),r.unshift(o)}var s=xo.mergeStatefulStyles(r);return xo.processStateful(s,{},{})}},{key:"applyDeepChatUtilities",value:function(t,n,r){es.forEach((function(t){var i=r.getElementsByClassName(t);Array.from(i||[]).forEach((function(r){var i=e.getProcessedStyles(n,r,t);ns.applyStylesToElement(r,i),e.applyEvents(r,t)}))}));var i=r.getElementsByClassName("deep-chat-suggestion-button");Array.from(i).forEach((function(n){return e.applySuggestionEvent(t,n)}))}}])}(),ns=function(){function e(){mo(this,e)}return yo(e,null,[{key:"applyStylesToElement",value:function(e,t){var n=xo.processStateful(t,{},{});Zo.add(e,n),Object.assign(e.style,n.default)}},{key:"applyEventsToElement",value:function(e,t){Object.keys(t).forEach((function(n){var r=t[n];r&&e.addEventListener(n,r)}))}},{key:"applyClassUtilitiesToElement",value:function(t,n){var r=n.events,i=n.styles;r&&e.applyEventsToElement(t,r),i&&!ts.doesElementContainDeepChatClass(t)&&e.applyStylesToElement(t,i)}},{key:"applyCustomClassUtilities",value:function(t,n){Object.keys(t).forEach((function(r){var i=n.getElementsByClassName(r);Array.from(i).forEach((function(n){t[r]&&e.applyClassUtilitiesToElement(n,t[r])}))}))}},{key:"apply",value:function(t,n){ts.applyDeepChatUtilities(t,t.htmlClassUtilities,n),e.applyCustomClassUtilities(t.htmlClassUtilities,n)}},{key:"traverseNodes",value:function(t,n){t.nodeType===Node.ELEMENT_NODE&&n.push(t.outerHTML),t.childNodes.forEach((function(t){e.traverseNodes(t,n)}))}},{key:"splitHTML",value:function(t){var n=(new DOMParser).parseFromString(t,"text/html"),r=[];return n.body.childNodes.forEach((function(t){e.traverseNodes(t,r)})),r}}])}(),rs=function(){function e(){mo(this,e)}return yo(e,null,[{key:"addElement",value:function(e,t){e.elementRef.appendChild(t),e.elementRef.scrollTop=e.elementRef.scrollHeight}},{key:"createElements",value:function(e,t,n,r){var i=e.createMessageElementsOnOrientation("",n,r);return i.bubbleElement.classList.add("html-message"),i.bubbleElement.innerHTML=t,i}},{key:"overwrite",value:function(e,t,n,r){var i=e.messages,o=$o.overwriteMessage(i,r,t,n,"html","html-message");return o&&(o.bubbleElement.innerHTML=t,ns.apply(e,o.outerContainer),zo.flagHTMLUpdateClass(o.bubbleElement)),o}},{key:"add",value:function(t,n,r,i,o){var s,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(null!=o&&o.status){var l=this.overwrite(t,n,r,i);if(l)return l;o.status=!1}var c=e.createElements(t,n,r,a);return $o.fillEmptyMessageElement(c.bubbleElement,n),ns.apply(t,c.outerContainer),zo.flagHTMLUpdateClass(c.bubbleElement),t.applyCustomStyles(c,r,!1,null==(s=t.messageStyles)?void 0:s.html),a||e.addElement(t,c.outerContainer),c}}])}();function is(e){return(Yo=Yo||document.createElement("textarea")).innerHTML="&"+e+";",Yo.value}var os=Object.prototype.hasOwnProperty;function ss(e){return[].slice.call(arguments,1).forEach((function(t){if(t){if("object"!=vo(t))throw new TypeError(t+"must be object");Object.keys(t).forEach((function(n){e[n]=t[n]}))}})),e}var as=/\\([\\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function ls(e){return e.indexOf("\\")<0?e:e.replace(as,"$1")}function cs(e){return!(e>=55296&&e<=57343||e>=64976&&e<=65007||!(65535&~e)||65534==(65535&e)||e>=0&&e<=8||11===e||e>=14&&e<=31||e>=127&&e<=159||e>1114111)}function us(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}var ds=/&([a-z#][a-z0-9]{1,31});/gi,ps=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i;function hs(e,t){var n=0,r=is(t);return t!==r?r:35===t.charCodeAt(0)&&ps.test(t)&&cs(n="x"===t[1].toLowerCase()?parseInt(t.slice(2),16):parseInt(t.slice(1),10))?us(n):e}function fs(e){return e.indexOf("&")<0?e:e.replace(ds,hs)}var vs=/[&<>"]/,ms=/[&<>"]/g,gs={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function ys(e){return gs[e]}function bs(e){return vs.test(e)?e.replace(ms,ys):e}var _s={};function ks(e,t){return++t>=e.length-2?t:"paragraph_open"===e[t].type&&e[t].tight&&"inline"===e[t+1].type&&0===e[t+1].content.length&&"paragraph_close"===e[t+2].type&&e[t+2].tight?ks(e,t+2):t}_s.blockquote_open=function(){return"<blockquote>\n"},_s.blockquote_close=function(e,t){return"</blockquote>"+xs(e,t)},_s.code=function(e,t){return e[t].block?"<pre><code>"+bs(e[t].content)+"</code></pre>"+xs(e,t):"<code>"+bs(e[t].content)+"</code>"},_s.fence=function(e,t,n,r,i){var o,s,a=e[t],l="",c=n.langPrefix;if(a.params){if(s=(o=a.params.split(/\s+/g)).join(" "),function(e,t){return!!e&&os.call(e,t)}(i.rules.fence_custom,o[0]))return i.rules.fence_custom[o[0]](e,t,n,r,i);l=' class="'+c+bs(fs(ls(s)))+'"'}return"<pre><code"+l+">"+(n.highlight&&n.highlight.apply(n.highlight,[a.content].concat(o))||bs(a.content))+"</code></pre>"+xs(e,t)},_s.fence_custom={},_s.heading_open=function(e,t){return"<h"+e[t].hLevel+">"},_s.heading_close=function(e,t){return"</h"+e[t].hLevel+">\n"},_s.hr=function(e,t,n){return(n.xhtmlOut?"<hr />":"<hr>")+xs(e,t)},_s.bullet_list_open=function(){return"<ul>\n"},_s.bullet_list_close=function(e,t){return"</ul>"+xs(e,t)},_s.list_item_open=function(){return"<li>"},_s.list_item_close=function(){return"</li>\n"},_s.ordered_list_open=function(e,t){var n=e[t];return"<ol"+(n.order>1?' start="'+n.order+'"':"")+">\n"},_s.ordered_list_close=function(e,t){return"</ol>"+xs(e,t)},_s.paragraph_open=function(e,t){return e[t].tight?"":"<p>"},_s.paragraph_close=function(e,t){var n=!(e[t].tight&&t&&"inline"===e[t-1].type&&!e[t-1].content);return(e[t].tight?"":"</p>")+(n?xs(e,t):"")},_s.link_open=function(e,t,n){var r=e[t].title?' title="'+bs(fs(e[t].title))+'"':"",i=n.linkTarget?' target="'+n.linkTarget+'"':"";return'<a href="'+bs(e[t].href)+'"'+r+i+">"},_s.link_close=function(){return"</a>"},_s.image=function(e,t,n){var r=' src="'+bs(e[t].src)+'"',i=e[t].title?' title="'+bs(fs(e[t].title))+'"':"";return"<img"+r+(' alt="'+(e[t].alt?bs(fs(ls(e[t].alt))):"")+'"')+i+(n.xhtmlOut?" /":"")+">"},_s.table_open=function(){return"<table>\n"},_s.table_close=function(){return"</table>\n"},_s.thead_open=function(){return"<thead>\n"},_s.thead_close=function(){return"</thead>\n"},_s.tbody_open=function(){return"<tbody>\n"},_s.tbody_close=function(){return"</tbody>\n"},_s.tr_open=function(){return"<tr>"},_s.tr_close=function(){return"</tr>\n"},_s.th_open=function(e,t){var n=e[t];return"<th"+(n.align?' style="text-align:'+n.align+'"':"")+">"},_s.th_close=function(){return"</th>"},_s.td_open=function(e,t){var n=e[t];return"<td"+(n.align?' style="text-align:'+n.align+'"':"")+">"},_s.td_close=function(){return"</td>"},_s.strong_open=function(){return"<strong>"},_s.strong_close=function(){return"</strong>"},_s.em_open=function(){return"<em>"},_s.em_close=function(){return"</em>"},_s.del_open=function(){return"<del>"},_s.del_close=function(){return"</del>"},_s.ins_open=function(){return"<ins>"},_s.ins_close=function(){return"</ins>"},_s.mark_open=function(){return"<mark>"},_s.mark_close=function(){return"</mark>"},_s.sub=function(e,t){return"<sub>"+bs(e[t].content)+"</sub>"},_s.sup=function(e,t){return"<sup>"+bs(e[t].content)+"</sup>"},_s.hardbreak=function(e,t,n){return n.xhtmlOut?"<br />\n":"<br>\n"},_s.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?"<br />\n":"<br>\n":"\n"},_s.text=function(e,t){return bs(e[t].content)},_s.htmlblock=function(e,t){return e[t].content},_s.htmltag=function(e,t){return e[t].content},_s.abbr_open=function(e,t){return'<abbr title="'+bs(fs(e[t].title))+'">'},_s.abbr_close=function(){return"</abbr>"},_s.footnote_ref=function(e,t){var n=Number(e[t].id+1).toString(),r="fnref"+n;return e[t].subId>0&&(r+=":"+e[t].subId),'<sup class="footnote-ref"><a href="#fn'+n+'" id="'+r+'">['+n+"]</a></sup>"},_s.footnote_block_open=function(e,t,n){return(n.xhtmlOut?'<hr class="footnotes-sep" />\n':'<hr class="footnotes-sep">\n')+'<section class="footnotes">\n<ol class="footnotes-list">\n'},_s.footnote_block_close=function(){return"</ol>\n</section>\n"},_s.footnote_open=function(e,t){return'<li id="fn'+Number(e[t].id+1).toString()+'"  class="footnote-item">'},_s.footnote_close=function(){return"</li>\n"},_s.footnote_anchor=function(e,t){var n="fnref"+Number(e[t].id+1).toString();return e[t].subId>0&&(n+=":"+e[t].subId),' <a href="#'+n+'" class="footnote-backref"></a>'},_s.dl_open=function(){return"<dl>\n"},_s.dt_open=function(){return"<dt>"},_s.dd_open=function(){return"<dd>"},_s.dl_close=function(){return"</dl>\n"},_s.dt_close=function(){return"</dt>\n"},_s.dd_close=function(){return"</dd>\n"};var xs=_s.getBreak=function(e,t){return(t=ks(e,t))<e.length&&"list_item_close"===e[t].type?"":"\n"};function ws(){this.rules=ss({},_s),this.getBreak=_s.getBreak}function Ss(){this.__rules__=[],this.__cache__=null}function Es(e,t,n,r,i){this.src=e,this.env=r,this.options=n,this.parser=t,this.tokens=i,this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache=[],this.isInLabel=!1,this.linkLevel=0,this.linkContent="",this.labelUnmatchedScopes=0}function Cs(e,t){var n,r,i,o=-1,s=e.posMax,a=e.pos,l=e.isInLabel;if(e.isInLabel)return-1;if(e.labelUnmatchedScopes)return e.labelUnmatchedScopes--,-1;for(e.pos=t+1,e.isInLabel=!0,n=1;e.pos<s;){if(91===(i=e.src.charCodeAt(e.pos)))n++;else if(93===i&&0===--n){r=!0;break}e.parser.skipToken(e)}return r?(o=e.pos,e.labelUnmatchedScopes=0):e.labelUnmatchedScopes=n-1,e.pos=a,e.isInLabel=l,o}function Ts(e,t,n,r){var i,o,s,a,l,c;if(42!==e.charCodeAt(0)||91!==e.charCodeAt(1)||-1===e.indexOf("]:")||((o=Cs(i=new Es(e,t,n,r,[]),1))<0||58!==e.charCodeAt(o+1)))return-1;for(a=i.posMax,s=o+2;s<a&&10!==i.src.charCodeAt(s);s++);return l=e.slice(2,o),0===(c=e.slice(o+2,s).trim()).length?-1:(r.abbreviations||(r.abbreviations={}),vo(r.abbreviations[":"+l])>"u"&&(r.abbreviations[":"+l]=c),s)}function As(e){var t=fs(e);try{t=decodeURI(t)}catch(e){}return encodeURI(t)}function Ms(e,t){var n,r,i,o=t,s=e.posMax;if(60===e.src.charCodeAt(t)){for(t++;t<s;){if(10===(n=e.src.charCodeAt(t)))return!1;if(62===n)return i=As(ls(e.src.slice(o+1,t))),!!e.parser.validateLink(i)&&(e.pos=t+1,e.linkContent=i,!0);92===n&&t+1<s?t+=2:t++}return!1}for(r=0;t<s&&!(32===(n=e.src.charCodeAt(t))||n<32||127===n);)if(92===n&&t+1<s)t+=2;else{if(40===n&&++r>1||41===n&&--r<0)break;t++}return!(o===t||(i=ls(e.src.slice(o,t)),!e.parser.validateLink(i)))&&(e.linkContent=i,e.pos=t,!0)}function Is(e,t){var n,r=t,i=e.posMax,o=e.src.charCodeAt(t);if(34!==o&&39!==o&&40!==o)return!1;for(t++,40===o&&(o=41);t<i;){if((n=e.src.charCodeAt(t))===o)return e.pos=t+1,e.linkContent=ls(e.src.slice(r+1,t)),!0;92===n&&t+1<i?t+=2:t++}return!1}function Ls(e){return e.trim().replace(/\s+/g," ").toUpperCase()}function Os(e,t,n,r){var i,o,s,a,l,c,u,d,p;if(91!==e.charCodeAt(0)||-1===e.indexOf("]:")||((o=Cs(i=new Es(e,t,n,r,[]),0))<0||58!==e.charCodeAt(o+1)))return-1;for(a=i.posMax,s=o+2;s<a&&(32===(l=i.src.charCodeAt(s))||10===l);s++);if(!Ms(i,s))return-1;for(u=i.linkContent,c=s=i.pos,s+=1;s<a&&(32===(l=i.src.charCodeAt(s))||10===l);s++);for(s<a&&c!==s&&Is(i,s)?(d=i.linkContent,s=i.pos):(d="",s=c);s<a&&32===i.src.charCodeAt(s);)s++;return s<a&&10!==i.src.charCodeAt(s)?-1:(p=Ls(e.slice(1,o)),vo(r.references[p])>"u"&&(r.references[p]={title:d,href:u}),s)}ws.prototype.renderInline=function(e,t,n){for(var r=this.rules,i=e.length,o=0,s="";i--;)s+=r[e[o].type](e,o++,t,n,this);return s},ws.prototype.render=function(e,t,n){for(var r=this.rules,i=e.length,o=-1,s="";++o<i;)"inline"===e[o].type?s+=this.renderInline(e[o].children,t,n):s+=r[e[o].type](e,o,t,n,this);return s},Ss.prototype.__find__=function(e){for(var t=this.__rules__.length,n=-1;t--;)if(this.__rules__[++n].name===e)return n;return-1},Ss.prototype.__compile__=function(){var e=this,t=[""];e.__rules__.forEach((function(e){e.enabled&&e.alt.forEach((function(e){t.indexOf(e)<0&&t.push(e)}))})),e.__cache__={},t.forEach((function(t){e.__cache__[t]=[],e.__rules__.forEach((function(n){n.enabled&&(t&&n.alt.indexOf(t)<0||e.__cache__[t].push(n.fn))}))}))},Ss.prototype.at=function(e,t,n){var r=this.__find__(e),i=n||{};if(-1===r)throw new Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=i.alt||[],this.__cache__=null},Ss.prototype.before=function(e,t,n,r){var i=this.__find__(e),o=r||{};if(-1===i)throw new Error("Parser rule not found: "+e);this.__rules__.splice(i,0,{name:t,enabled:!0,fn:n,alt:o.alt||[]}),this.__cache__=null},Ss.prototype.after=function(e,t,n,r){var i=this.__find__(e),o=r||{};if(-1===i)throw new Error("Parser rule not found: "+e);this.__rules__.splice(i+1,0,{name:t,enabled:!0,fn:n,alt:o.alt||[]}),this.__cache__=null},Ss.prototype.push=function(e,t,n){var r=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:r.alt||[]}),this.__cache__=null},Ss.prototype.enable=function(e,t){e=Array.isArray(e)?e:[e],t&&this.__rules__.forEach((function(e){e.enabled=!1})),e.forEach((function(e){var t=this.__find__(e);if(t<0)throw new Error("Rules manager: invalid rule name "+e);this.__rules__[t].enabled=!0}),this),this.__cache__=null},Ss.prototype.disable=function(e){(e=Array.isArray(e)?e:[e]).forEach((function(e){var t=this.__find__(e);if(t<0)throw new Error("Rules manager: invalid rule name "+e);this.__rules__[t].enabled=!1}),this),this.__cache__=null},Ss.prototype.getRules=function(e){return null===this.__cache__&&this.__compile__(),this.__cache__[e]||[]},Es.prototype.pushPending=function(){this.tokens.push({type:"text",content:this.pending,level:this.pendingLevel}),this.pending=""},Es.prototype.push=function(e){this.pending&&this.pushPending(),this.tokens.push(e),this.pendingLevel=this.level},Es.prototype.cacheSet=function(e,t){for(var n=this.cache.length;n<=e;n++)this.cache.push(0);this.cache[e]=t},Es.prototype.cacheGet=function(e){return e<this.cache.length?this.cache[e]:0};var Rs=" \n()[]'\".,!?-";function Ps(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1")}var Ns=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,Ds=/\((c|tm|r|p)\)/gi,Fs={c:"",r:"",p:"",tm:""};function js(e){return e.indexOf("(")<0?e:e.replace(Ds,(function(e,t){return Fs[t.toLowerCase()]}))}var Bs=/['"]/,Us=/['"]/g,Hs=/[-\s()\[\]]/;function qs(e,t){return!(t<0||t>=e.length)&&!Hs.test(e[t])}function Vs(e,t,n){return e.substr(0,t)+n+e.substr(t+1)}var zs=[["block",function(e){e.inlineMode?e.tokens.push({type:"inline",content:e.src.replace(/\n/g," ").trim(),level:0,lines:[0,1],children:[]}):e.block.parse(e.src,e.options,e.env,e.tokens)}],["abbr",function(e){var t,n,r,i,o=e.tokens;if(!e.inlineMode)for(t=1,n=o.length-1;t<n;t++)if("paragraph_open"===o[t-1].type&&"inline"===o[t].type&&"paragraph_close"===o[t+1].type){for(r=o[t].content;r.length&&!((i=Ts(r,e.inline,e.options,e.env))<0);)r=r.slice(i).trim();o[t].content=r,r.length||(o[t-1].tight=!0,o[t+1].tight=!0)}}],["references",function(e){var t,n,r,i,o=e.tokens;if(e.env.references=e.env.references||{},!e.inlineMode)for(t=1,n=o.length-1;t<n;t++)if("inline"===o[t].type&&"paragraph_open"===o[t-1].type&&"paragraph_close"===o[t+1].type){for(r=o[t].content;r.length&&!((i=Os(r,e.inline,e.options,e.env))<0);)r=r.slice(i).trim();o[t].content=r,r.length||(o[t-1].tight=!0,o[t+1].tight=!0)}}],["inline",function(e){var t,n,r,i=e.tokens;for(n=0,r=i.length;n<r;n++)"inline"===(t=i[n]).type&&e.inline.parse(t.content,e.options,e.env,t.children)}],["footnote_tail",function(e){var t,n,r,i,o,s,a,l,c,u=0,d=!1,p={};if(e.env.footnotes&&(e.tokens=e.tokens.filter((function(e){return"footnote_reference_open"===e.type?(d=!0,l=[],c=e.label,!1):"footnote_reference_close"===e.type?(d=!1,p[":"+c]=l,!1):(d&&l.push(e),!d)})),e.env.footnotes.list)){for(s=e.env.footnotes.list,e.tokens.push({type:"footnote_block_open",level:u++}),t=0,n=s.length;t<n;t++){for(e.tokens.push({type:"footnote_open",id:t,level:u++}),s[t].tokens?((a=[]).push({type:"paragraph_open",tight:!1,level:u++}),a.push({type:"inline",content:"",level:u,children:s[t].tokens}),a.push({type:"paragraph_close",tight:!1,level:--u})):s[t].label&&(a=p[":"+s[t].label]),e.tokens=e.tokens.concat(a),o="paragraph_close"===e.tokens[e.tokens.length-1].type?e.tokens.pop():null,i=s[t].count>0?s[t].count:1,r=0;r<i;r++)e.tokens.push({type:"footnote_anchor",id:t,subId:r,level:u});o&&e.tokens.push(o),e.tokens.push({type:"footnote_close",level:--u})}e.tokens.push({type:"footnote_block_close",level:--u})}}],["abbr2",function(e){var t,n,r,i,o,s,a,l,c,u,d,p,h=e.tokens;if(e.env.abbreviations)for(e.env.abbrRegExp||(p="(^|["+Rs.split("").map(Ps).join("")+"])("+Object.keys(e.env.abbreviations).map((function(e){return e.substr(1)})).sort((function(e,t){return t.length-e.length})).map(Ps).join("|")+")($|["+Rs.split("").map(Ps).join("")+"])",e.env.abbrRegExp=new RegExp(p,"g")),u=e.env.abbrRegExp,n=0,r=h.length;n<r;n++)if("inline"===h[n].type)for(t=(i=h[n].children).length-1;t>=0;t--)if("text"===(o=i[t]).type){for(l=0,s=o.content,u.lastIndex=0,c=o.level,a=[];d=u.exec(s);)u.lastIndex>l&&a.push({type:"text",content:s.slice(l,d.index+d[1].length),level:c}),a.push({type:"abbr_open",title:e.env.abbreviations[":"+d[2]],level:c++}),a.push({type:"text",content:d[2],level:c}),a.push({type:"abbr_close",level:--c}),l=u.lastIndex-d[3].length;a.length&&(l<s.length&&a.push({type:"text",content:s.slice(l),level:c}),h[n].children=i=[].concat(i.slice(0,t),a,i.slice(t+1)))}}],["replacements",function(e){var t,n,r,i,o;if(e.options.typographer)for(o=e.tokens.length-1;o>=0;o--)if("inline"===e.tokens[o].type)for(t=(i=e.tokens[o].children).length-1;t>=0;t--)"text"===(n=i[t]).type&&(r=js(r=n.content),Ns.test(r)&&(r=r.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---([^-]|$)/gm,"$1$2").replace(/(^|\s)--(\s|$)/gm,"$1$2").replace(/(^|[^-\s])--([^-\s]|$)/gm,"$1$2")),n.content=r)}],["smartquotes",function(e){var t,n,r,i,o,s,a,l,c,u,d,p,h,f,v,m,g;if(e.options.typographer)for(g=[],v=e.tokens.length-1;v>=0;v--)if("inline"===e.tokens[v].type)for(m=e.tokens[v].children,g.length=0,t=0;t<m.length;t++)if("text"===(n=m[t]).type&&!Bs.test(n.text)){for(a=m[t].level,h=g.length-1;h>=0&&!(g[h].level<=a);h--);g.length=h+1,o=0,s=(r=n.content).length;e:for(;o<s&&(Us.lastIndex=o,i=Us.exec(r),i);)if(l=!qs(r,i.index-1),o=i.index+1,f="'"===i[0],(c=!qs(r,o))||l){if(d=!c,p=!l)for(h=g.length-1;h>=0&&(u=g[h],!(g[h].level<a));h--)if(u.single===f&&g[h].level===a){u=g[h],f?(m[u.token].content=Vs(m[u.token].content,u.pos,e.options.quotes[2]),n.content=Vs(n.content,i.index,e.options.quotes[3])):(m[u.token].content=Vs(m[u.token].content,u.pos,e.options.quotes[0]),n.content=Vs(n.content,i.index,e.options.quotes[1])),g.length=h;continue e}d?g.push({token:t,pos:i.index,single:f,level:a}):p&&f&&(n.content=Vs(n.content,i.index,""))}else f&&(n.content=Vs(n.content,i.index,""))}}]];function Gs(){this.options={},this.ruler=new Ss;for(var e=0;e<zs.length;e++)this.ruler.push(zs[e][0],zs[e][1])}function Ws(e,t,n,r,i){var o,s,a,l,c,u,d;for(this.src=e,this.parser=t,this.options=n,this.env=r,this.tokens=i,this.bMarks=[],this.eMarks=[],this.tShift=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.parentType="root",this.ddIndent=-1,this.level=0,this.result="",u=0,d=!1,a=l=u=0,c=(s=this.src).length;l<c;l++){if(o=s.charCodeAt(l),!d){if(32===o){u++;continue}d=!0}(10===o||l===c-1)&&(10!==o&&l++,this.bMarks.push(a),this.eMarks.push(l),this.tShift.push(u),d=!1,u=0,a=l+1)}this.bMarks.push(s.length),this.eMarks.push(s.length),this.tShift.push(0),this.lineMax=this.bMarks.length-1}function Ks(e,t){var n,r,i;return(r=e.bMarks[t]+e.tShift[t])>=(i=e.eMarks[t])||42!==(n=e.src.charCodeAt(r++))&&45!==n&&43!==n||r<i&&32!==e.src.charCodeAt(r)?-1:r}function Js(e,t){var n,r=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(r+1>=i||((n=e.src.charCodeAt(r++))<48||n>57))return-1;for(;;){if(r>=i)return-1;if(!((n=e.src.charCodeAt(r++))>=48&&n<=57)){if(41===n||46===n)break;return-1}}return r<i&&32!==e.src.charCodeAt(r)?-1:r}Gs.prototype.process=function(e){var t,n,r;for(t=0,n=(r=this.ruler.getRules("")).length;t<n;t++)r[t](e)},Ws.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]},Ws.prototype.skipEmptyLines=function(e){for(var t=this.lineMax;e<t&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e},Ws.prototype.skipSpaces=function(e){for(var t=this.src.length;e<t&&32===this.src.charCodeAt(e);e++);return e},Ws.prototype.skipChars=function(e,t){for(var n=this.src.length;e<n&&this.src.charCodeAt(e)===t;e++);return e},Ws.prototype.skipCharsBack=function(e,t,n){if(e<=n)return e;for(;e>n;)if(t!==this.src.charCodeAt(--e))return e+1;return e},Ws.prototype.getLines=function(e,t,n,r){var i,o,s,a,l,c=e;if(e>=t)return"";if(c+1===t)return o=this.bMarks[c]+Math.min(this.tShift[c],n),s=r?this.eMarks[c]+1:this.eMarks[c],this.src.slice(o,s);for(a=new Array(t-e),i=0;c<t;c++,i++)(l=this.tShift[c])>n&&(l=n),l<0&&(l=0),o=this.bMarks[c]+l,s=c+1<t||r?this.eMarks[c]+1:this.eMarks[c],a[i]=this.src.slice(o,s);return a.join("")};var Xs={};["article","aside","button","blockquote","body","canvas","caption","col","colgroup","dd","div","dl","dt","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","iframe","li","map","object","ol","output","p","pre","progress","script","section","style","table","tbody","td","textarea","tfoot","th","tr","thead","ul","video"].forEach((function(e){Xs[e]=!0}));var Ys=/^<([a-zA-Z]{1,15})[\s\/>]/,$s=/^<\/([a-zA-Z]{1,15})[\s>]/;function Zs(e,t){var n=e.bMarks[t]+e.blkIndent,r=e.eMarks[t];return e.src.substr(n,r-n)}function Qs(e,t){var n,r,i=e.bMarks[t]+e.tShift[t],o=e.eMarks[t];return i>=o||126!==(r=e.src.charCodeAt(i++))&&58!==r||i===(n=e.skipSpaces(i))||n>=o?-1:n}var ea=[["code",function(e,t,n){var r,i;if(e.tShift[t]-e.blkIndent<4)return!1;for(i=r=t+1;r<n;)if(e.isEmpty(r))r++;else{if(!(e.tShift[r]-e.blkIndent>=4))break;i=++r}return e.line=r,e.tokens.push({type:"code",content:e.getLines(t,i,4+e.blkIndent,!0),block:!0,lines:[t,e.line],level:e.level}),!0}],["fences",function(e,t,n,r){var i,o,s,a,l,c=!1,u=e.bMarks[t]+e.tShift[t],d=e.eMarks[t];if(u+3>d||126!==(i=e.src.charCodeAt(u))&&96!==i||(l=u,(o=(u=e.skipChars(u,i))-l)<3)||(s=e.src.slice(u,d).trim()).indexOf("`")>=0)return!1;if(r)return!0;for(a=t;!(++a>=n||(u=l=e.bMarks[a]+e.tShift[a],d=e.eMarks[a],u<d&&e.tShift[a]<e.blkIndent));)if(!(e.src.charCodeAt(u)!==i||e.tShift[a]-e.blkIndent>=4||(u=e.skipChars(u,i),u-l<o||(u=e.skipSpaces(u),u<d)))){c=!0;break}return o=e.tShift[t],e.line=a+(c?1:0),e.tokens.push({type:"fence",params:s,content:e.getLines(t+1,a,o,!0),lines:[t,e.line],level:e.level}),!0},["paragraph","blockquote","list"]],["blockquote",function(e,t,n,r){var i,o,s,a,l,c,u,d,p,h,f,v=e.bMarks[t]+e.tShift[t],m=e.eMarks[t];if(v>m||62!==e.src.charCodeAt(v++)||e.level>=e.options.maxNesting)return!1;if(r)return!0;for(32===e.src.charCodeAt(v)&&v++,l=e.blkIndent,e.blkIndent=0,a=[e.bMarks[t]],e.bMarks[t]=v,o=(v=v<m?e.skipSpaces(v):v)>=m,s=[e.tShift[t]],e.tShift[t]=v-e.bMarks[t],d=e.parser.ruler.getRules("blockquote"),i=t+1;i<n&&!((v=e.bMarks[i]+e.tShift[i])>=(m=e.eMarks[i]));i++)if(62!==e.src.charCodeAt(v++)){if(o)break;for(f=!1,p=0,h=d.length;p<h;p++)if(d[p](e,i,n,!0)){f=!0;break}if(f)break;a.push(e.bMarks[i]),s.push(e.tShift[i]),e.tShift[i]=-1337}else 32===e.src.charCodeAt(v)&&v++,a.push(e.bMarks[i]),e.bMarks[i]=v,o=(v=v<m?e.skipSpaces(v):v)>=m,s.push(e.tShift[i]),e.tShift[i]=v-e.bMarks[i];for(c=e.parentType,e.parentType="blockquote",e.tokens.push({type:"blockquote_open",lines:u=[t,0],level:e.level++}),e.parser.tokenize(e,t,i),e.tokens.push({type:"blockquote_close",level:--e.level}),e.parentType=c,u[1]=e.line,p=0;p<s.length;p++)e.bMarks[p+t]=a[p],e.tShift[p+t]=s[p];return e.blkIndent=l,!0},["paragraph","blockquote","list"]],["hr",function(e,t,n,r){var i,o,s,a=e.bMarks[t],l=e.eMarks[t];if((a+=e.tShift[t])>l||42!==(i=e.src.charCodeAt(a++))&&45!==i&&95!==i)return!1;for(o=1;a<l;){if((s=e.src.charCodeAt(a++))!==i&&32!==s)return!1;s===i&&o++}return!(o<3)&&(r||(e.line=t+1,e.tokens.push({type:"hr",lines:[t,e.line],level:e.level})),!0)},["paragraph","blockquote","list"]],["list",function(e,t,n,r){var i,o,s,a,l,c,u,d,p,h,f,v,m,g,y,b,_,k,x,w,S,E=!0;if((d=Js(e,t))>=0)v=!0;else{if(!((d=Ks(e,t))>=0))return!1;v=!1}if(e.level>=e.options.maxNesting)return!1;if(f=e.src.charCodeAt(d-1),r)return!0;for(g=e.tokens.length,v?(u=e.bMarks[t]+e.tShift[t],h=Number(e.src.substr(u,d-u-1)),e.tokens.push({type:"ordered_list_open",order:h,lines:b=[t,0],level:e.level++})):e.tokens.push({type:"bullet_list_open",lines:b=[t,0],level:e.level++}),i=t,y=!1,k=e.parser.ruler.getRules("list");i<n&&((p=(m=e.skipSpaces(d))>=e.eMarks[i]?1:m-d)>4&&(p=1),p<1&&(p=1),o=d-e.bMarks[i]+p,e.tokens.push({type:"list_item_open",lines:_=[t,0],level:e.level++}),a=e.blkIndent,l=e.tight,s=e.tShift[t],c=e.parentType,e.tShift[t]=m-e.bMarks[t],e.blkIndent=o,e.tight=!0,e.parentType="list",e.parser.tokenize(e,t,n,!0),(!e.tight||y)&&(E=!1),y=e.line-t>1&&e.isEmpty(e.line-1),e.blkIndent=a,e.tShift[t]=s,e.tight=l,e.parentType=c,e.tokens.push({type:"list_item_close",level:--e.level}),i=t=e.line,_[1]=i,m=e.bMarks[t],!(i>=n||e.isEmpty(i)||e.tShift[i]<e.blkIndent));){for(S=!1,x=0,w=k.length;x<w;x++)if(k[x](e,i,n,!0)){S=!0;break}if(S)break;if(v){if((d=Js(e,i))<0)break}else if((d=Ks(e,i))<0)break;if(f!==e.src.charCodeAt(d-1))break}return e.tokens.push({type:v?"ordered_list_close":"bullet_list_close",level:--e.level}),b[1]=i,e.line=i,E&&function(e,t){var n,r,i=e.level+2;for(n=t+2,r=e.tokens.length-2;n<r;n++)e.tokens[n].level===i&&"paragraph_open"===e.tokens[n].type&&(e.tokens[n+2].tight=!0,e.tokens[n].tight=!0,n+=2)}(e,g),!0},["paragraph","blockquote"]],["footnote",function(e,t,n,r){var i,o,s,a,l,c=e.bMarks[t]+e.tShift[t],u=e.eMarks[t];if(c+4>u||91!==e.src.charCodeAt(c)||94!==e.src.charCodeAt(c+1)||e.level>=e.options.maxNesting)return!1;for(a=c+2;a<u;a++){if(32===e.src.charCodeAt(a))return!1;if(93===e.src.charCodeAt(a))break}return!(a===c+2||a+1>=u||58!==e.src.charCodeAt(++a))&&(r||(a++,e.env.footnotes||(e.env.footnotes={}),e.env.footnotes.refs||(e.env.footnotes.refs={}),l=e.src.slice(c+2,a-2),e.env.footnotes.refs[":"+l]=-1,e.tokens.push({type:"footnote_reference_open",label:l,level:e.level++}),i=e.bMarks[t],o=e.tShift[t],s=e.parentType,e.tShift[t]=e.skipSpaces(a)-a,e.bMarks[t]=a,e.blkIndent+=4,e.parentType="footnote",e.tShift[t]<e.blkIndent&&(e.tShift[t]+=e.blkIndent,e.bMarks[t]-=e.blkIndent),e.parser.tokenize(e,t,n,!0),e.parentType=s,e.blkIndent-=4,e.tShift[t]=o,e.bMarks[t]=i,e.tokens.push({type:"footnote_reference_close",level:--e.level})),!0)},["paragraph"]],["heading",function(e,t,n,r){var i,o,s,a=e.bMarks[t]+e.tShift[t],l=e.eMarks[t];if(a>=l||(35!==(i=e.src.charCodeAt(a))||a>=l))return!1;for(o=1,i=e.src.charCodeAt(++a);35===i&&a<l&&o<=6;)o++,i=e.src.charCodeAt(++a);return!(o>6||a<l&&32!==i)&&(r||(l=e.skipCharsBack(l,32,a),(s=e.skipCharsBack(l,35,a))>a&&32===e.src.charCodeAt(s-1)&&(l=s),e.line=t+1,e.tokens.push({type:"heading_open",hLevel:o,lines:[t,e.line],level:e.level}),a<l&&e.tokens.push({type:"inline",content:e.src.slice(a,l).trim(),level:e.level+1,lines:[t,e.line],children:[]}),e.tokens.push({type:"heading_close",hLevel:o,level:e.level})),!0)},["paragraph","blockquote"]],["lheading",function(e,t,n){var r,i,o,s=t+1;return!(s>=n||e.tShift[s]<e.blkIndent||e.tShift[s]-e.blkIndent>3||(i=e.bMarks[s]+e.tShift[s],o=e.eMarks[s],i>=o)||(r=e.src.charCodeAt(i),45!==r&&61!==r)||(i=e.skipChars(i,r),i=e.skipSpaces(i),i<o))&&(i=e.bMarks[t]+e.tShift[t],e.line=s+1,e.tokens.push({type:"heading_open",hLevel:61===r?1:2,lines:[t,e.line],level:e.level}),e.tokens.push({type:"inline",content:e.src.slice(i,e.eMarks[t]).trim(),level:e.level+1,lines:[t,e.line-1],children:[]}),e.tokens.push({type:"heading_close",hLevel:61===r?1:2,level:e.level}),!0)}],["htmlblock",function(e,t,n,r){var i,o,s,a=e.bMarks[t],l=e.eMarks[t],c=e.tShift[t];if(a+=c,!e.options.html||c>3||a+2>=l||60!==e.src.charCodeAt(a))return!1;if(33===(i=e.src.charCodeAt(a+1))||63===i){if(r)return!0}else{if(47!==i&&!function(e){var t=32|e;return t>=97&&t<=122}(i))return!1;if(47===i){if(!(o=e.src.slice(a,l).match($s)))return!1}else if(!(o=e.src.slice(a,l).match(Ys)))return!1;if(!0!==Xs[o[1].toLowerCase()])return!1;if(r)return!0}for(s=t+1;s<e.lineMax&&!e.isEmpty(s);)s++;return e.line=s,e.tokens.push({type:"htmlblock",level:e.level,lines:[t,e.line],content:e.getLines(t,s,0,!0)}),!0},["paragraph","blockquote"]],["table",function(e,t,n,r){var i,o,s,a,l,c,u,d,p,h,f;if(t+2>n||(l=t+1,e.tShift[l]<e.blkIndent)||(s=e.bMarks[l]+e.tShift[l])>=e.eMarks[l]||124!==(i=e.src.charCodeAt(s))&&45!==i&&58!==i||(o=Zs(e,t+1),!/^[-:| ]+$/.test(o))||(c=o.split("|"))<=2)return!1;for(d=[],a=0;a<c.length;a++){if(!(p=c[a].trim())){if(0===a||a===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(p))return!1;58===p.charCodeAt(p.length-1)?d.push(58===p.charCodeAt(0)?"center":"right"):58===p.charCodeAt(0)?d.push("left"):d.push("")}if(-1===(o=Zs(e,t).trim()).indexOf("|")||(c=o.replace(/^\||\|$/g,"").split("|"),d.length!==c.length))return!1;if(r)return!0;for(e.tokens.push({type:"table_open",lines:h=[t,0],level:e.level++}),e.tokens.push({type:"thead_open",lines:[t,t+1],level:e.level++}),e.tokens.push({type:"tr_open",lines:[t,t+1],level:e.level++}),a=0;a<c.length;a++)e.tokens.push({type:"th_open",align:d[a],lines:[t,t+1],level:e.level++}),e.tokens.push({type:"inline",content:c[a].trim(),lines:[t,t+1],level:e.level,children:[]}),e.tokens.push({type:"th_close",level:--e.level});for(e.tokens.push({type:"tr_close",level:--e.level}),e.tokens.push({type:"thead_close",level:--e.level}),e.tokens.push({type:"tbody_open",lines:f=[t+2,0],level:e.level++}),l=t+2;l<n&&!(e.tShift[l]<e.blkIndent||(o=Zs(e,l).trim(),-1===o.indexOf("|")));l++){for(c=o.replace(/^\||\|$/g,"").split("|"),e.tokens.push({type:"tr_open",level:e.level++}),a=0;a<c.length;a++)e.tokens.push({type:"td_open",align:d[a],level:e.level++}),u=c[a].substring(124===c[a].charCodeAt(0)?1:0,124===c[a].charCodeAt(c[a].length-1)?c[a].length-1:c[a].length).trim(),e.tokens.push({type:"inline",content:u,level:e.level,children:[]}),e.tokens.push({type:"td_close",level:--e.level});e.tokens.push({type:"tr_close",level:--e.level})}return e.tokens.push({type:"tbody_close",level:--e.level}),e.tokens.push({type:"table_close",level:--e.level}),h[1]=f[1]=l,e.line=l,!0},["paragraph"]],["deflist",function(e,t,n,r){var i,o,s,a,l,c,u,d,p,h,f,v,m,g;if(r)return!(e.ddIndent<0)&&Qs(e,t)>=0;if(u=t+1,e.isEmpty(u)&&++u>n||e.tShift[u]<e.blkIndent||(i=Qs(e,u))<0||e.level>=e.options.maxNesting)return!1;c=e.tokens.length,e.tokens.push({type:"dl_open",lines:l=[t,0],level:e.level++}),s=t,o=u;e:for(;;){for(g=!0,m=!1,e.tokens.push({type:"dt_open",lines:[s,s],level:e.level++}),e.tokens.push({type:"inline",content:e.getLines(s,s+1,e.blkIndent,!1).trim(),level:e.level+1,lines:[s,s],children:[]}),e.tokens.push({type:"dt_close",level:--e.level});;){if(e.tokens.push({type:"dd_open",lines:a=[u,0],level:e.level++}),v=e.tight,p=e.ddIndent,d=e.blkIndent,f=e.tShift[o],h=e.parentType,e.blkIndent=e.ddIndent=e.tShift[o]+2,e.tShift[o]=i-e.bMarks[o],e.tight=!0,e.parentType="deflist",e.parser.tokenize(e,o,n,!0),(!e.tight||m)&&(g=!1),m=e.line-o>1&&e.isEmpty(e.line-1),e.tShift[o]=f,e.tight=v,e.parentType=h,e.blkIndent=d,e.ddIndent=p,e.tokens.push({type:"dd_close",level:--e.level}),a[1]=u=e.line,u>=n||e.tShift[u]<e.blkIndent)break e;if((i=Qs(e,u))<0)break;o=u}if(u>=n||(s=u,e.isEmpty(s))||e.tShift[s]<e.blkIndent||(o=s+1)>=n||(e.isEmpty(o)&&o++,o>=n)||e.tShift[o]<e.blkIndent||(i=Qs(e,o))<0)break}return e.tokens.push({type:"dl_close",level:--e.level}),l[1]=u,e.line=u,g&&function(e,t){var n,r,i=e.level+2;for(n=t+2,r=e.tokens.length-2;n<r;n++)e.tokens[n].level===i&&"paragraph_open"===e.tokens[n].type&&(e.tokens[n+2].tight=!0,e.tokens[n].tight=!0,n+=2)}(e,c),!0},["paragraph"]],["paragraph",function(e,t){var n,r,i,o,s,a,l=t+1;if(l<(n=e.lineMax)&&!e.isEmpty(l))for(a=e.parser.ruler.getRules("paragraph");l<n&&!e.isEmpty(l);l++)if(!(e.tShift[l]-e.blkIndent>3)){for(i=!1,o=0,s=a.length;o<s;o++)if(a[o](e,l,n,!0)){i=!0;break}if(i)break}return r=e.getLines(t,l,e.blkIndent,!1).trim(),e.line=l,r.length&&(e.tokens.push({type:"paragraph_open",tight:!1,lines:[t,e.line],level:e.level}),e.tokens.push({type:"inline",content:r,level:e.level+1,lines:[t,e.line],children:[]}),e.tokens.push({type:"paragraph_close",tight:!1,level:e.level})),!0}]];function ta(){this.ruler=new Ss;for(var e=0;e<ea.length;e++)this.ruler.push(ea[e][0],ea[e][1],{alt:(ea[e][2]||[]).slice()})}ta.prototype.tokenize=function(e,t,n){for(var r,i=this.ruler.getRules(""),o=i.length,s=t,a=!1;s<n&&(e.line=s=e.skipEmptyLines(s),!(s>=n||e.tShift[s]<e.blkIndent));){for(r=0;r<o&&!i[r](e,s,n,!1);r++);if(e.tight=!a,e.isEmpty(e.line-1)&&(a=!0),(s=e.line)<n&&e.isEmpty(s)){if(a=!0,++s<n&&"list"===e.parentType&&e.isEmpty(s))break;e.line=s}}};var na=/[\n\t]/g,ra=/\r[\n\u0085]|[\u2424\u2028\u0085]/g,ia=/\u00a0/g;function oa(e){switch(e){case 10:case 92:case 96:case 42:case 95:case 94:case 91:case 93:case 33:case 38:case 60:case 62:case 123:case 125:case 36:case 37:case 64:case 126:case 43:case 61:case 58:return!0;default:return!1}}ta.prototype.parse=function(e,t,n,r){var i,o=0,s=0;if(!e)return[];(e=(e=e.replace(ia," ")).replace(ra,"\n")).indexOf("\t")>=0&&(e=e.replace(na,(function(t,n){var r;return 10===e.charCodeAt(n)?(o=n+1,s=0,t):(r="    ".slice((n-o-s)%4),s=n-o+1,r)}))),i=new Ws(e,this,t,n,r),this.tokenize(i,i.line,i.lineMax)};for(var sa=[],aa=0;aa<256;aa++)sa.push(0);function la(e){return e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122}function ca(e,t){var n,r,i,o=t,s=!0,a=!0,l=e.posMax,c=e.src.charCodeAt(t);for(n=t>0?e.src.charCodeAt(t-1):-1;o<l&&e.src.charCodeAt(o)===c;)o++;return o>=l&&(s=!1),(i=o-t)>=4?s=a=!1:((32===(r=o<l?e.src.charCodeAt(o):-1)||10===r)&&(s=!1),(32===n||10===n)&&(a=!1),95===c&&(la(n)&&(s=!1),la(r)&&(a=!1))),{can_open:s,can_close:a,delims:i}}"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach((function(e){sa[e.charCodeAt(0)]=1}));var ua=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;var da=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;var pa=["coap","doi","javascript","aaa","aaas","about","acap","cap","cid","crid","data","dav","dict","dns","file","ftp","geo","go","gopher","h323","http","https","iax","icap","im","imap","info","ipp","iris","iris.beep","iris.xpc","iris.xpcs","iris.lwz","ldap","mailto","mid","msrp","msrps","mtqp","mupdate","news","nfs","ni","nih","nntp","opaquelocktoken","pop","pres","rtsp","service","session","shttp","sieve","sip","sips","sms","snmp","soap.beep","soap.beeps","tag","tel","telnet","tftp","thismessage","tn3270","tip","tv","urn","vemmi","ws","wss","xcon","xcon-userid","xmlrpc.beep","xmlrpc.beeps","xmpp","z39.50r","z39.50s","adiumxtra","afp","afs","aim","apt","attachment","aw","beshare","bitcoin","bolo","callto","chrome","chrome-extension","com-eventbrite-attendee","content","cvs","dlna-playsingle","dlna-playcontainer","dtn","dvb","ed2k","facetime","feed","finger","fish","gg","git","gizmoproject","gtalk","hcp","icon","ipn","irc","irc6","ircs","itms","jar","jms","keyparc","lastfm","ldaps","magnet","maps","market","message","mms","ms-help","msnim","mumble","mvn","notes","oid","palm","paparazzi","platform","proxy","psyc","query","res","resource","rmi","rsync","rtmp","secondlife","sftp","sgn","skype","smb","soldat","spotify","ssh","steam","svn","teamspeak","things","udp","unreal","ut2004","ventrilo","view-source","webcal","wtai","wyciwyg","xfire","xri","ymsgr"],ha=/^<([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)>/,fa=/^<([a-zA-Z.\-]{1,25}):([^<>\x00-\x20]*)>/;function va(e,t){return e=e.source,t=t||"",function n(r,i){return r?(i=i.source||i,e=e.replace(r,i),n):new RegExp(e,t)}}var ma=va(/(?:unquoted|single_quoted|double_quoted)/)("unquoted",/[^"'=<>`\x00-\x20]+/)("single_quoted",/'[^']*'/)("double_quoted",/"[^"]*"/)(),ga=va(/(?:\s+attr_name(?:\s*=\s*attr_value)?)/)("attr_name",/[a-zA-Z_:][a-zA-Z0-9:._-]*/)("attr_value",ma)(),ya=va(/<[A-Za-z][A-Za-z0-9]*attribute*\s*\/?>/)("attribute",ga)(),ba=va(/^(?:open_tag|close_tag|comment|processing|declaration|cdata)/)("open_tag",ya)("close_tag",/<\/[A-Za-z][A-Za-z0-9]*\s*>/)("comment",/<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->/)("processing",/<[?].*?[?]>/)("declaration",/<![A-Z]+\s+[^>]*>/)("cdata",/<!\[CDATA\[[\s\S]*?\]\]>/)();var _a=/^&#((?:x[a-f0-9]{1,8}|[0-9]{1,8}));/i,ka=/^&([a-z][a-z0-9]{1,31});/i;var xa=[["text",function(e,t){for(var n=e.pos;n<e.posMax&&!oa(e.src.charCodeAt(n));)n++;return n!==e.pos&&(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}],["newline",function(e,t){var n,r,i=e.pos;if(10!==e.src.charCodeAt(i))return!1;if(n=e.pending.length-1,r=e.posMax,!t)if(n>=0&&32===e.pending.charCodeAt(n))if(n>=1&&32===e.pending.charCodeAt(n-1)){for(var o=n-2;o>=0;o--)if(32!==e.pending.charCodeAt(o)){e.pending=e.pending.substring(0,o+1);break}e.push({type:"hardbreak",level:e.level})}else e.pending=e.pending.slice(0,-1),e.push({type:"softbreak",level:e.level});else e.push({type:"softbreak",level:e.level});for(i++;i<r&&32===e.src.charCodeAt(i);)i++;return e.pos=i,!0}],["escape",function(e,t){var n,r=e.pos,i=e.posMax;if(92!==e.src.charCodeAt(r))return!1;if(++r<i){if((n=e.src.charCodeAt(r))<256&&0!==sa[n])return t||(e.pending+=e.src[r]),e.pos+=2,!0;if(10===n){for(t||e.push({type:"hardbreak",level:e.level}),r++;r<i&&32===e.src.charCodeAt(r);)r++;return e.pos=r,!0}}return t||(e.pending+="\\"),e.pos++,!0}],["backticks",function(e,t){var n,r,i,o,s,a=e.pos;if(96!==e.src.charCodeAt(a))return!1;for(n=a,a++,r=e.posMax;a<r&&96===e.src.charCodeAt(a);)a++;for(i=e.src.slice(n,a),o=s=a;-1!==(o=e.src.indexOf("`",s));){for(s=o+1;s<r&&96===e.src.charCodeAt(s);)s++;if(s-o===i.length)return t||e.push({type:"code",content:e.src.slice(a,o).replace(/[ \n]+/g," ").trim(),block:!1,level:e.level}),e.pos=s,!0}return t||(e.pending+=i),e.pos+=i.length,!0}],["del",function(e,t){var n,r,i,o,s,a=e.posMax,l=e.pos;if(126!==e.src.charCodeAt(l)||t||l+4>=a||126!==e.src.charCodeAt(l+1)||e.level>=e.options.maxNesting||(o=l>0?e.src.charCodeAt(l-1):-1,s=e.src.charCodeAt(l+2),126===o)||126===s||32===s||10===s)return!1;for(r=l+2;r<a&&126===e.src.charCodeAt(r);)r++;if(r>l+3)return e.pos+=r-l,t||(e.pending+=e.src.slice(l,r)),!0;for(e.pos=l+2,i=1;e.pos+1<a;){if(126===e.src.charCodeAt(e.pos)&&126===e.src.charCodeAt(e.pos+1)&&(o=e.src.charCodeAt(e.pos-1),126!==(s=e.pos+2<a?e.src.charCodeAt(e.pos+2):-1)&&126!==o&&(32!==o&&10!==o?i--:32!==s&&10!==s&&i++,i<=0))){n=!0;break}e.parser.skipToken(e)}return n?(e.posMax=e.pos,e.pos=l+2,t||(e.push({type:"del_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"del_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=a,!0):(e.pos=l,!1)}],["ins",function(e,t){var n,r,i,o,s,a=e.posMax,l=e.pos;if(43!==e.src.charCodeAt(l)||t||l+4>=a||43!==e.src.charCodeAt(l+1)||e.level>=e.options.maxNesting||(o=l>0?e.src.charCodeAt(l-1):-1,s=e.src.charCodeAt(l+2),43===o)||43===s||32===s||10===s)return!1;for(r=l+2;r<a&&43===e.src.charCodeAt(r);)r++;if(r!==l+2)return e.pos+=r-l,t||(e.pending+=e.src.slice(l,r)),!0;for(e.pos=l+2,i=1;e.pos+1<a;){if(43===e.src.charCodeAt(e.pos)&&43===e.src.charCodeAt(e.pos+1)&&(o=e.src.charCodeAt(e.pos-1),43!==(s=e.pos+2<a?e.src.charCodeAt(e.pos+2):-1)&&43!==o&&(32!==o&&10!==o?i--:32!==s&&10!==s&&i++,i<=0))){n=!0;break}e.parser.skipToken(e)}return n?(e.posMax=e.pos,e.pos=l+2,t||(e.push({type:"ins_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"ins_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=a,!0):(e.pos=l,!1)}],["mark",function(e,t){var n,r,i,o,s,a=e.posMax,l=e.pos;if(61!==e.src.charCodeAt(l)||t||l+4>=a||61!==e.src.charCodeAt(l+1)||e.level>=e.options.maxNesting||(o=l>0?e.src.charCodeAt(l-1):-1,s=e.src.charCodeAt(l+2),61===o)||61===s||32===s||10===s)return!1;for(r=l+2;r<a&&61===e.src.charCodeAt(r);)r++;if(r!==l+2)return e.pos+=r-l,t||(e.pending+=e.src.slice(l,r)),!0;for(e.pos=l+2,i=1;e.pos+1<a;){if(61===e.src.charCodeAt(e.pos)&&61===e.src.charCodeAt(e.pos+1)&&(o=e.src.charCodeAt(e.pos-1),61!==(s=e.pos+2<a?e.src.charCodeAt(e.pos+2):-1)&&61!==o&&(32!==o&&10!==o?i--:32!==s&&10!==s&&i++,i<=0))){n=!0;break}e.parser.skipToken(e)}return n?(e.posMax=e.pos,e.pos=l+2,t||(e.push({type:"mark_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"mark_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=a,!0):(e.pos=l,!1)}],["emphasis",function(e,t){var n,r,i,o,s,a,l,c=e.posMax,u=e.pos,d=e.src.charCodeAt(u);if(95!==d&&42!==d||t)return!1;if(n=(l=ca(e,u)).delims,!l.can_open)return e.pos+=n,t||(e.pending+=e.src.slice(u,e.pos)),!0;if(e.level>=e.options.maxNesting)return!1;for(e.pos=u+n,a=[n];e.pos<c;)if(e.src.charCodeAt(e.pos)!==d)e.parser.skipToken(e);else{if(r=(l=ca(e,e.pos)).delims,l.can_close){for(o=a.pop(),s=r;o!==s;){if(s<o){a.push(o-s);break}if(s-=o,0===a.length)break;e.pos+=o,o=a.pop()}if(0===a.length){n=o,i=!0;break}e.pos+=r;continue}l.can_open&&a.push(r),e.pos+=r}return i?(e.posMax=e.pos,e.pos=u+n,t||((2===n||3===n)&&e.push({type:"strong_open",level:e.level++}),(1===n||3===n)&&e.push({type:"em_open",level:e.level++}),e.parser.tokenize(e),(1===n||3===n)&&e.push({type:"em_close",level:--e.level}),(2===n||3===n)&&e.push({type:"strong_close",level:--e.level})),e.pos=e.posMax+n,e.posMax=c,!0):(e.pos=u,!1)}],["sub",function(e,t){var n,r,i=e.posMax,o=e.pos;if(126!==e.src.charCodeAt(o)||t||o+2>=i||e.level>=e.options.maxNesting)return!1;for(e.pos=o+1;e.pos<i;){if(126===e.src.charCodeAt(e.pos)){n=!0;break}e.parser.skipToken(e)}return!n||o+1===e.pos||(r=e.src.slice(o+1,e.pos)).match(/(^|[^\\])(\\\\)*\s/)?(e.pos=o,!1):(e.posMax=e.pos,e.pos=o+1,t||e.push({type:"sub",level:e.level,content:r.replace(ua,"$1")}),e.pos=e.posMax+1,e.posMax=i,!0)}],["sup",function(e,t){var n,r,i=e.posMax,o=e.pos;if(94!==e.src.charCodeAt(o)||t||o+2>=i||e.level>=e.options.maxNesting)return!1;for(e.pos=o+1;e.pos<i;){if(94===e.src.charCodeAt(e.pos)){n=!0;break}e.parser.skipToken(e)}return!n||o+1===e.pos||(r=e.src.slice(o+1,e.pos)).match(/(^|[^\\])(\\\\)*\s/)?(e.pos=o,!1):(e.posMax=e.pos,e.pos=o+1,t||e.push({type:"sup",level:e.level,content:r.replace(da,"$1")}),e.pos=e.posMax+1,e.posMax=i,!0)}],["links",function(e,t){var n,r,i,o,s,a,l,c,u=!1,d=e.pos,p=e.posMax,h=e.pos,f=e.src.charCodeAt(h);if(33===f&&(u=!0,f=e.src.charCodeAt(++h)),91!==f||e.level>=e.options.maxNesting||(n=h+1,(r=Cs(e,h))<0))return!1;if((a=r+1)<p&&40===e.src.charCodeAt(a)){for(a++;a<p&&(32===(c=e.src.charCodeAt(a))||10===c);a++);if(a>=p)return!1;for(h=a,Ms(e,a)?(o=e.linkContent,a=e.pos):o="",h=a;a<p&&(32===(c=e.src.charCodeAt(a))||10===c);a++);if(a<p&&h!==a&&Is(e,a))for(s=e.linkContent,a=e.pos;a<p&&(32===(c=e.src.charCodeAt(a))||10===c);a++);else s="";if(a>=p||41!==e.src.charCodeAt(a))return e.pos=d,!1;a++}else{if(e.linkLevel>0)return!1;for(;a<p&&(32===(c=e.src.charCodeAt(a))||10===c);a++);if(a<p&&91===e.src.charCodeAt(a)&&(h=a+1,(a=Cs(e,a))>=0?i=e.src.slice(h,a++):a=h-1),i||(vo(i)>"u"&&(a=r+1),i=e.src.slice(n,r)),!(l=e.env.references[Ls(i)]))return e.pos=d,!1;o=l.href,s=l.title}return t||(e.pos=n,e.posMax=r,u?e.push({type:"image",src:o,title:s,alt:e.src.substr(n,r-n),level:e.level}):(e.push({type:"link_open",href:o,title:s,level:e.level++}),e.linkLevel++,e.parser.tokenize(e),e.linkLevel--,e.push({type:"link_close",level:--e.level}))),e.pos=a,e.posMax=p,!0}],["footnote_inline",function(e,t){var n,r,i,o,s=e.posMax,a=e.pos;return!(a+2>=s||94!==e.src.charCodeAt(a)||91!==e.src.charCodeAt(a+1)||e.level>=e.options.maxNesting||(n=a+2,r=Cs(e,a+1),r<0))&&(t||(e.env.footnotes||(e.env.footnotes={}),e.env.footnotes.list||(e.env.footnotes.list=[]),i=e.env.footnotes.list.length,e.pos=n,e.posMax=r,e.push({type:"footnote_ref",id:i,level:e.level}),e.linkLevel++,o=e.tokens.length,e.parser.tokenize(e),e.env.footnotes.list[i]={tokens:e.tokens.splice(o)},e.linkLevel--),e.pos=r+1,e.posMax=s,!0)}],["footnote_ref",function(e,t){var n,r,i,o,s=e.posMax,a=e.pos;if(a+3>s||!e.env.footnotes||!e.env.footnotes.refs||91!==e.src.charCodeAt(a)||94!==e.src.charCodeAt(a+1)||e.level>=e.options.maxNesting)return!1;for(r=a+2;r<s;r++){if(32===e.src.charCodeAt(r)||10===e.src.charCodeAt(r))return!1;if(93===e.src.charCodeAt(r))break}return!(r===a+2||r>=s||(r++,n=e.src.slice(a+2,r-1),vo(e.env.footnotes.refs[":"+n])>"u"))&&(t||(e.env.footnotes.list||(e.env.footnotes.list=[]),e.env.footnotes.refs[":"+n]<0?(i=e.env.footnotes.list.length,e.env.footnotes.list[i]={label:n,count:0},e.env.footnotes.refs[":"+n]=i):i=e.env.footnotes.refs[":"+n],o=e.env.footnotes.list[i].count,e.env.footnotes.list[i].count++,e.push({type:"footnote_ref",id:i,subId:o,level:e.level})),e.pos=r,e.posMax=s,!0)}],["autolink",function(e,t){var n,r,i,o,s,a=e.pos;return!(60!==e.src.charCodeAt(a)||(n=e.src.slice(a),n.indexOf(">")<0))&&((r=n.match(fa))?!(pa.indexOf(r[1].toLowerCase())<0||(o=r[0].slice(1,-1),s=As(o),!e.parser.validateLink(o)))&&(t||(e.push({type:"link_open",href:s,level:e.level}),e.push({type:"text",content:o,level:e.level+1}),e.push({type:"link_close",level:e.level})),e.pos+=r[0].length,!0):!!(i=n.match(ha))&&(s=As("mailto:"+(o=i[0].slice(1,-1))),!!e.parser.validateLink(s)&&(t||(e.push({type:"link_open",href:s,level:e.level}),e.push({type:"text",content:o,level:e.level+1}),e.push({type:"link_close",level:e.level})),e.pos+=i[0].length,!0)))}],["htmltag",function(e,t){var n,r,i,o=e.pos;return!(!e.options.html||(i=e.posMax,60!==e.src.charCodeAt(o)||o+2>=i)||(n=e.src.charCodeAt(o+1),33!==n&&63!==n&&47!==n&&!function(e){var t=32|e;return t>=97&&t<=122}(n))||(r=e.src.slice(o).match(ba),!r))&&(t||e.push({type:"htmltag",content:e.src.slice(o,o+r[0].length),level:e.level}),e.pos+=r[0].length,!0)}],["entity",function(e,t){var n,r,i=e.pos,o=e.posMax;if(38!==e.src.charCodeAt(i))return!1;if(i+1<o)if(35===e.src.charCodeAt(i+1)){if(r=e.src.slice(i).match(_a))return t||(n="x"===r[1][0].toLowerCase()?parseInt(r[1].slice(1),16):parseInt(r[1],10),e.pending+=cs(n)?us(n):us(65533)),e.pos+=r[0].length,!0}else if(r=e.src.slice(i).match(ka)){var s=is(r[1]);if(r[1]!==s)return t||(e.pending+=s),e.pos+=r[0].length,!0}return t||(e.pending+="&"),e.pos++,!0}]];function wa(){this.ruler=new Ss;for(var e=0;e<xa.length;e++)this.ruler.push(xa[e][0],xa[e][1]);this.validateLink=Sa}function Sa(e){var t=e.trim().toLowerCase();return!(-1!==(t=fs(t)).indexOf(":")&&-1!==["vbscript","javascript","file","data"].indexOf(t.split(":")[0]))}wa.prototype.skipToken=function(e){var t,n,r=this.ruler.getRules(""),i=r.length,o=e.pos;if((n=e.cacheGet(o))>0)e.pos=n;else{for(t=0;t<i;t++)if(r[t](e,!0))return void e.cacheSet(o,e.pos);e.pos++,e.cacheSet(o,e.pos)}},wa.prototype.tokenize=function(e){for(var t,n,r=this.ruler.getRules(""),i=r.length,o=e.posMax;e.pos<o;){for(n=0;n<i&&!(t=r[n](e,!1));n++);if(t){if(e.pos>=o)break}else e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()},wa.prototype.parse=function(e,t,n,r){var i=new Es(e,this,t,n,r);this.tokenize(i)};var Ea={default:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","replacements","smartquotes","references","abbr2","footnote_tail"]},block:{rules:["blockquote","code","fences","footnote","heading","hr","htmlblock","lheading","list","paragraph","table"]},inline:{rules:["autolink","backticks","del","emphasis","entity","escape","footnote_ref","htmltag","links","newline","text"]}}},full:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{},block:{},inline:{}}},commonmark:{options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","abbr2"]},block:{rules:["blockquote","code","fences","heading","hr","htmlblock","lheading","list","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","htmltag","links","newline","text"]}}}};function Ca(e,t,n){this.src=t,this.env=n,this.options=e.options,this.tokens=[],this.inlineMode=!1,this.inline=e.inline,this.block=e.block,this.renderer=e.renderer,this.typographer=e.typographer}function Ta(e,t){"string"!=typeof e&&(t=e,e="default"),t&&null!=t.linkify&&console.warn("linkify option is removed. Use linkify plugin instead:\n\nimport Remarkable from 'remarkable';\nimport linkify from 'remarkable/linkify';\nnew Remarkable().use(linkify)\n"),this.inline=new wa,this.block=new ta,this.core=new Gs,this.renderer=new ws,this.ruler=new Ss,this.options={},this.configure(Ea[e]),this.set(t||{})}Ta.prototype.set=function(e){ss(this.options,e)},Ta.prototype.configure=function(e){var t=this;if(!e)throw new Error("Wrong `remarkable` preset, check name/content");e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach((function(n){e.components[n].rules&&t[n].ruler.enable(e.components[n].rules,!0)}))},Ta.prototype.use=function(e,t){return e(this,t),this},Ta.prototype.parse=function(e,t){var n=new Ca(this,e,t);return this.core.process(n),n.tokens},Ta.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)},Ta.prototype.parseInline=function(e,t){var n=new Ca(this,e,t);return n.inlineMode=!0,this.core.process(n),n.tokens},Ta.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)};var Aa=function(){function e(){mo(this,e)}return yo(e,null,[{key:"instantiate",value:function(){var e=window.hljs;return new Ta(e?{highlight:function(t,n){if(n&&e.getLanguage(n))try{return e.highlight(n,t).value}catch(e){console.error("failed to setup the highlight dependency")}try{return e.highlightAuto(t).value}catch(e){console.error("failed to automatically highlight messages")}return""},html:!1,xhtmlOut:!1,breaks:!0,langPrefix:"language-",linkTarget:"_blank",typographer:!0}:{breaks:!0,linkTarget:"_blank"})}},{key:"createNew",value:function(){var t=e.instantiate();return t.inline.validateLink=function(){return!0},t}}])}(),Ma=function(){function e(){mo(this,e)}return yo(e,null,[{key:"addMessage",value:function(e,t,n,r,i){var o;e.applyCustomStyles(t,r,!0,null==(o=e.messageStyles)?void 0:o[n]),i||(e.elementRef.appendChild(t.outerContainer),e.elementRef.scrollTop=e.elementRef.scrollHeight)}},{key:"wrapInLink",value:function(t,n,r){var i=document.createElement("a");return i.href=n,i.download=r||e.DEFAULT_FILE_NAME,i.target="_blank",i.appendChild(t),i}},{key:"isNonLinkableDataUrl",value:function(e,t){return!(!t.startsWith("data")||"image"===e)&&("any"===e&&t.startsWith("data:text/javascript")||!t.startsWith("data:image")&&!t.startsWith("data:application"))}},{key:"processContent",value:function(t,n,r,i){return!r||e.isNonLinkableDataUrl(t,r)?n:e.wrapInLink(n,r,i)}},{key:"waitToLoadThenScroll",value:function(e){setTimeout((function(){e.scrollTop=e.scrollHeight}),60)}},{key:"scrollDownOnImageLoad",value:function(t,n){if(t.startsWith("data"))e.waitToLoadThenScroll(n);else try{fetch(t,{mode:"no-cors"}).catch((function(){})).finally((function(){e.waitToLoadThenScroll(n)}))}catch(e){n.scrollTop=n.scrollHeight}}},{key:"reAddFileRefToObject",value:function(e,t){var n;null==(n=e.files)||n.forEach((function(e,n){var r;e.ref&&null!=(r=t.message.files)&&r[n]&&(t.message.files[n].ref=e.ref)}))}},{key:"removeFileRef",value:function(e){var t=ho({},e);return delete t.ref,t}},{key:"isAudioFile",value:function(e){var t=e.type,n=e.src;return"audio"===t||(null==n?void 0:n.startsWith("data:audio"))||n&&/\.(mp3|ogg|wav|aac|webm|4a)$/i.test(n)}},{key:"isImageFile",value:function(t){var n=t.type,r=t.src;return"image"===n||(null==r?void 0:r.startsWith("data:image"))||r&&e.isImageFileExtension(r)}},{key:"isImageFileExtension",value:function(e){return/\.(jpg|jpeg|png|gif|bmp)$/i.test(e)}}])}();Ma.DEFAULT_FILE_NAME="file";var Ia=Ma,La=function(){return yo((function e(){mo(this,e)}),null,[{key:"onMessage",value:function(e,t,n){var r,i=JSON.parse(JSON.stringify({message:t,isHistory:n,isInitial:n}));Ia.reAddFileRefToObject(t,i),null==(r=e.onMessage)||r.call(e,i),e.dispatchEvent(new CustomEvent("message",{detail:i})),zo.fireOnNewMessage(e,i)}},{key:"onClearMessages",value:function(e){var t;null==(t=e.onClearMessages)||t.call(e),e.dispatchEvent(new CustomEvent("clear-messages"))}},{key:"onRender",value:function(e){var t;null==(t=e.onComponentRender)||t.call(e,e),e.dispatchEvent(new CustomEvent("render",{detail:e}))}},{key:"onError",value:function(e,t){var n;null==(n=e.onError)||n.call(e,t),e.dispatchEvent(new CustomEvent("error",{detail:t}))}}])}(),Oa=function(){function e(){mo(this,e)}return yo(e,null,[{key:"applyCustomStylesToElements",value:function(e,t,n){if(n&&(Object.assign(e.outerContainer.style,n.outerContainer),Object.assign(e.innerContainer.style,n.innerContainer),Object.assign(e.bubbleElement.style,n.bubble),t)){var r=e.bubbleElement.children[0],i="a"!==r.tagName.toLocaleLowerCase()?r:r.children[0];Object.assign(i.style,n.media)}}},{key:"applySideStyles",value:function(t,n,r,i){i&&(e.applyCustomStylesToElements(t,r,i.shared),n===$o.USER_ROLE?e.applyCustomStylesToElements(t,r,i.user):(e.applyCustomStylesToElements(t,r,i.ai),e.applyCustomStylesToElements(t,r,i[n])))}},{key:"isElementsStyles",value:function(e){return!!(e.outerContainer||e.innerContainer||e.bubble||e.media)}},{key:"applyCustomStyles",value:function(t,n,r,i,o){var s;o&&t.default!==o?e.isElementsStyles(o)?(e.applyCustomStylesToElements(n,i,null==(s=t.default)?void 0:s.shared),e.applyCustomStylesToElements(n,i,o)):(e.applySideStyles(n,r,i,t.default),e.applySideStyles(n,r,i,o)):e.applySideStyles(n,r,i,t.default)}},{key:"extractParticularSharedStyles",value:function(e,t){if(null!=t&&t.shared){var n=t.shared,r={outerContainer:{},innerContainer:{},bubble:{},media:{}};return e.forEach((function(e){var t,i,o,s;r.outerContainer[e]=(null==(t=n.outerContainer)?void 0:t[e])||"",r.innerContainer[e]=(null==(i=n.innerContainer)?void 0:i[e])||"",r.bubble[e]=(null==(o=n.bubble)?void 0:o[e])||"",r.media[e]=(null==(s=n.media)?void 0:s[e])||""})),r}}}])}(),Ra=function(){function e(t){var n=this;mo(this,e),this.messageElementRefs=[],this.messages=[],this.htmlClassUtilities={},this.textElementsToText=[],this.elementRef=e.createContainerElement(),this.messageStyles=t.messageStyles,this._remarkable=Aa.createNew(),this._avatars=t.avatars,this._names=t.names,this._onMessage=La.onMessage.bind(this,t),t.htmlClassUtilities&&(this.htmlClassUtilities=t.htmlClassUtilities),setTimeout((function(){n.submitUserMessage=t.submitUserMessage}))}return yo(e,[{key:"addNewTextMessage",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(null!=n&&n.status){var i=this.overwriteText(t,e,this.messageElementRefs);if(i)return i;n.status=!1}var o=r?this.createAndPrependNewMessageElement(e,t,r):this.createAndAppendNewMessageElement(e,t);o.bubbleElement.classList.add("text-message"),this.applyCustomStyles(o,t,!1),$o.fillEmptyMessageElement(o.bubbleElement,e);var s=[o,e];return $o.updateRefArr(this.textElementsToText,s,r),o}},{key:"overwriteText",value:function(e,t,n){var r=$o.overwriteMessage(this.messages,n,t,e,"text","text-message");if(r){this.renderText(r.bubbleElement,t);var i=$o.getLastTextToElement(this.textElementsToText,r);i&&(i[1]=t)}return r}},{key:"createAndAppendNewMessageElement",value:function(e,t){var n=this,r=this.createNewMessageElement(e,t);return this.elementRef.appendChild(r.outerContainer),setTimeout((function(){return Ho.scrollToBottom(n.elementRef)})),r}},{key:"createAndPrependNewMessageElement",value:function(e,t,n){var r=this.createNewMessageElement(e,t,n);return this.elementRef.insertBefore(r.outerContainer,this.elementRef.firstChild),r}},{key:"createMessageElementsOnOrientation",value:function(e,t,n){return n?this.createAndPrependNewMessageElement(e,t,n):this.createNewMessageElement(e,t,n)}},{key:"createNewMessageElement",value:function(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];null==(r=this._introPanel)||r.hide();var o=this.messageElementRefs[this.messageElementRefs.length-1];return e.isTemporaryElement(o)&&(o.outerContainer.remove(),this.messageElementRefs.pop()),this.createMessageElements(t,n,i)}},{key:"createMessageElements",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.createBaseElements(),o=i.outerContainer,s=i.innerContainer,a=i.bubbleElement;return o.appendChild(s),this.addInnerContainerElements(a,t,n),$o.updateRefArr(this.messageElementRefs,i,r),i}},{key:"addInnerContainerElements",value:function(e,t,n){var r;return(null==(r=this.messages[this.messages.length-1])?void 0:r.role)===n&&!this.isLastMessageError()&&$o.hideRoleElements(this.messageElementRefs,!!this._avatars,!!this._names),e.classList.add("message-bubble",$o.getRoleClass(n),n===$o.USER_ROLE?"user-message-text":"ai-message-text"),this.renderText(e,t),$o.addRoleElements(e,n,this._avatars,this._names),{bubbleElement:e}}},{key:"applyCustomStyles",value:function(e,t,n,r){e&&this.messageStyles&&Oa.applyCustomStyles(this.messageStyles,e,t,n,r)}},{key:"removeLastMessage",value:function(){this.messageElementRefs[this.messageElementRefs.length-1].outerContainer.remove(),this.messageElementRefs.pop()}},{key:"isLastMessageError",value:function(){var e;return null==(e=$o.getLastMessageBubbleElement(this.elementRef))?void 0:e.classList.contains("error-message-text")}},{key:"sendClientUpdate",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null==(t=this._onMessage)||t.call(this,e,n)}},{key:"renderText",value:function(e,t){e.innerHTML=this._remarkable.render(t),0===e.innerText.trim().length&&(e.innerText=t)}},{key:"refreshTextMessages",value:function(){var e=this;this._remarkable=Aa.createNew(),this.textElementsToText.forEach((function(t){e.renderText(t[0].bubbleElement,t[1])}))}}],[{key:"createContainerElement",value:function(){var e=document.createElement("div");return e.id="messages",e}},{key:"isTemporaryElement",value:function(e){return(null==e?void 0:e.bubbleElement.classList.contains("loading-message-text"))||ts.isElementTemporary(e)}},{key:"createBaseElements",value:function(){var e=document.createElement("div"),t=document.createElement("div");t.classList.add("inner-message-container"),e.appendChild(t),e.classList.add("outer-message-container");var n=document.createElement("div");return n.classList.add("message-bubble"),t.appendChild(n),{outerContainer:e,innerContainer:t,bubbleElement:n}}},{key:"createMessageContent",value:function(e){var t=e.text,n=e.files,r=e.html,i=e._sessionId,o={role:e.role||$o.AI_ROLE};return t&&(o.text=t),n&&(o.files=n),r&&(o.html=r),!t&&!n&&!r&&(o.text=""),i&&(o._sessionId=i),o}}])}(),Pa=function(){function e(t){mo(this,e),this._fileAdded=!1,this._streamedContent="",this._streamType="",this._hasStreamEnded=!1,this._messages=t}return yo(e,[{key:"upsertStreamedMessage",value:function(e){var t;if(!this._hasStreamEnded){if(void 0===(null==e?void 0:e.text)&&void 0===(null==e?void 0:e.html))return console.error(Bo.INVALID_STREAM_EVENT);var n=(null==e?void 0:e.text)||(null==e?void 0:e.html)||"",r=Ho.isScrollbarAtBottomOfElement(this._messages.elementRef),i=void 0!==(null==e?void 0:e.text)?"text":"html";if(this._elements||""!==this._streamedContent){if(this._streamType!==i)return console.error(Bo.INVALID_STREAM_EVENT_MIX);this.updateBasedOnType(n,i,null==(t=this._elements)?void 0:t.bubbleElement,null==e?void 0:e.overwrite)}else this.setInitialState(i,n,null==e?void 0:e.role);r&&Ho.scrollToBottom(this._messages.elementRef)}}},{key:"setInitialState",value:function(t,n,r){var i;this._streamType=t,null!==(i=r)&&void 0!==i||(r=$o.AI_ROLE),this._elements="text"===t?this._messages.addNewTextMessage(n,r):rs.add(this._messages,n,r,this._messages.messageElementRefs),this._elements.bubbleElement.classList.add(e.MESSAGE_CLASS),this._streamedContent=n,this._activeMessageRole=r,this._message=fo({role:this._activeMessageRole},t,this._streamedContent),this._messages.messages.push(this._message)}},{key:"updateBasedOnType",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];$o.unfillEmptyMessageElement(n,e),("text"===t?this.updateText:this.updateHTML).bind(this)(e,n,r)}},{key:"updateText",value:function(e,t,n){this._streamedContent=n?e:this._streamedContent+e,this._messages.textElementsToText[this._messages.textElementsToText.length-1][1]=this._streamedContent,this._messages.renderText(t,this._streamedContent)}},{key:"updateHTML",value:function(t,n,r){if(r)this._streamedContent=t,n.innerHTML=t;else{var i=document.createElement("span");i.innerHTML=t,n.appendChild(i),this._streamedContent=e.HTML_CONTENT_PLACEHOLDER}}},{key:"finaliseStreamedMessage",value:function(){var t,n,r=this._messages.textElementsToText;if(!this._endStreamAfterOperation&&(!this._fileAdded||this._elements)){if(!this._elements)throw Error(Bo.NO_VALID_STREAM_EVENTS_SENT);null!=(t=this._elements.bubbleElement)&&t.classList.contains(e.MESSAGE_CLASS)&&("text"===this._streamType?(r[r.length-1][1]=this._streamedContent,this._message&&(this._message.text=this._streamedContent),this._messages.textToSpeech&&Vo.speak(this._streamedContent,this._messages.textToSpeech)):"html"===this._streamType&&(this._streamedContent===e.HTML_CONTENT_PLACEHOLDER&&(this._streamedContent=(null==(n=this._elements.bubbleElement)?void 0:n.innerHTML)||""),this._elements&&ns.apply(this._messages,this._elements.outerContainer),this._message&&(this._message.html=this._streamedContent)),this._message&&this._messages.sendClientUpdate(Ra.createMessageContent(this._message),!1),this._hasStreamEnded=!0)}}},{key:"markFileAdded",value:function(){this._fileAdded=!0}},{key:"newMessage",value:function(){this.finaliseStreamedMessage(),this._elements=void 0,this._streamedContent="",this._fileAdded=!1,this._hasStreamEnded=!1,this._activeMessageRole=void 0}},{key:"endStreamAfterFileDownloaded",value:(t=uo(lo().mark((function e(t,n){var r,i,o,s;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._endStreamAfterOperation=!0,e.next=3,n();case 3:i=e.sent,o=i.text,s=i.files,o&&this.updateBasedOnType(o,"text",null==(r=this._elements)?void 0:r.bubbleElement,!0),this._endStreamAfterOperation=!1,this.finaliseStreamedMessage(),s&&t.addNewMessage({files:s});case 7:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]);var t}();Pa.MESSAGE_CLASS="streamed-message",Pa.HTML_CONTENT_PLACEHOLDER="htmlplaceholder";var Na=Pa,Da=function(){function e(){mo(this,e)}return yo(e,null,[{key:"tempRemoveContentHeader",value:(n=uo(lo().mark((function t(n,r,i){var o,s;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=n&&n.headers){t.next=2;break}throw new Error("Request settings have not been set up");case 2:return o=n.headers[e.CONTENT_TYPE],delete n.headers[e.CONTENT_TYPE],t.prev=4,t.next=7,r(i);case 7:s=t.sent,t.next=13;break;case 10:throw t.prev=10,t.t0=t.catch(4),n.headers[e.CONTENT_TYPE]=o,t.t0;case 13:return t.abrupt("return",(n.headers[e.CONTENT_TYPE]=o,s));case 14:case"end":return t.stop()}}),t,null,[[4,10]])}))),function(e,t,r){return n.apply(this,arguments)})},{key:"displayError",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Service error, please try again.";if(console.error(t),"object"==vo(t))return t instanceof Error?e.addNewErrorMessage("service",t.message):Array.isArray(t)||"string"==typeof t.error?e.addNewErrorMessage("service",t):0===Object.keys(t).length?e.addNewErrorMessage("service",n):e.addNewErrorMessage("service",JSON.stringify(t));e.addNewErrorMessage("service",t)}},{key:"fetch",value:function(e){function t(t,n,r,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n,r){var i,o,s={method:(null==(i=e.connectSettings)?void 0:i.method)||"POST",headers:t};return"GET"!==s.method&&(s.body=n?JSON.stringify(r):r),e.connectSettings.credentials&&(s.credentials=e.connectSettings.credentials),fetch((null==(o=e.connectSettings)?void 0:o.url)||e.url||"",s)}))},{key:"processResponseByType",value:function(e){var t=e.headers.get("content-type");return null!=t&&t.includes("application/json")?e.json():null!=t&&t.includes("text/plain")||!t?e:e.blob()}},{key:"processRequestInterceptor",value:(t=uo(lo().mark((function e(t,n){var r,i,o,s;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=t.requestInterceptor)?void 0:r.call(t,n);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=n;case 5:return i=e.t0,o=i,s=i,e.abrupt("return",{body:o.body,headers:o.headers,error:s.error});case 9:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},{key:"validateResponseFormat",value:function(e){return e&&"object"==vo(e)&&("string"==typeof e.error||"string"==typeof e.text||"string"==typeof e.html||Array.isArray(e.files))}},{key:"onInterceptorError",value:function(e,t,n){e.addNewErrorMessage("service",t),null==n||n()}}]);var t,n}();Da.CONTENT_TYPE="Content-Type";var Fa=Da;function ja(e,t){return Ba.apply(this,arguments)}function Ba(){return(Ba=uo(lo().mark((function e(t,n){var r,i;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.getReader();case 1:return e.next=3,r.read();case 3:if((i=e.sent).done){e.next=7;break}n(i.value);case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ua(e){var t,n,r,i=!1;return function(o){void 0===t?(t=o,n=0,r=-1):t=function(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(t,o);for(var s=t.length,a=0;n<s;){i&&(10===t[n]&&(a=++n),i=!1);for(var l=-1;n<s&&-1===l;++n)switch(t[n]){case 58:-1===r&&(r=n-a);break;case 13:i=!0;case 10:l=n}if(-1===l)break;e(t.subarray(a,l),r),a=n,r=-1}a===s?t=void 0:0!==a&&(t=t.subarray(a),n-=a)}}function Ha(e,t,n){var r={data:"",event:"",id:"",retry:void 0},i=new TextDecoder;return function(o,s){if(0===o.length)null==n||n(r),r={data:"",event:"",id:"",retry:void 0};else if(s>0){var a=i.decode(o.subarray(0,s)),l=s+(32===o[s+1]?2:1),c=i.decode(o.subarray(l));switch(a){case"data":r.data=r.data?r.data+"\n"+c:c;break;case"event":r.event=c;break;case"id":e(r.id=c);break;case"retry":var u=parseInt(c,10);isNaN(u)||t(r.retry=u)}}}}var qa="text/event-stream",Va="last-event-id";function za(e,t){var n=t.signal,r=t.headers,i=t.onopen,o=t.onmessage,s=t.onclose,a=t.onerror,l=t.openWhenHidden,c=t.fetch,u=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise((function(t,d){var p,h=Object.assign({},r);function f(){p.abort(),document.hidden||_()}h.accept||(h.accept=qa),l||document.addEventListener("visibilitychange",f);var v=1e3,m=0;function g(){document.removeEventListener("visibilitychange",f),window.clearTimeout(m),p.abort()}null==n||n.addEventListener("abort",(function(){g(),t()}));var y=null!=c?c:window.fetch,b=null!=i?i:Ga;function _(){return k.apply(this,arguments)}function k(){return(k=uo(lo().mark((function n(){var r,i,l;return lo().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return p=new AbortController,n.prev=1,n.next=4,y(e,Object.assign(Object.assign({},u),{headers:h,signal:p.signal}));case 4:return i=n.sent,n.next=7,b(i);case 7:return n.next=9,ja(i.body,Ua(Ha((function(e){e?h[Va]=e:delete h[Va]}),(function(e){v=e}),o)));case 9:null==s||s(),g(),t(),n.next=17;break;case 14:if(n.prev=14,n.t0=n.catch(1),!p.signal.aborted)try{l=null!==(r=null==a?void 0:a(n.t0))&&void 0!==r?r:v,window.clearTimeout(m),m=window.setTimeout(_,l)}catch(e){g(),d(e)}case 17:case"end":return n.stop()}}),n,null,[[1,14]])})))).apply(this,arguments)}_()}))}function Ga(e){var t=e.headers.get("content-type");if(null==t||!t.startsWith(qa))throw new Error("Expected content-type to be ".concat(qa,", Actual: ").concat(t))}var Wa=function(){function e(){mo(this,e)}return yo(e,null,[{key:"request",value:(t=uo(lo().mark((function t(n,r,i){var o,s,a,l,c,u,d,p,h,f,v,m,g,y,b,_,k,x,w,S=arguments;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=!(S.length>3&&void 0!==S[3])||S[3],s=S.length>4&&void 0!==S[4]&&S[4],h={body:r,headers:null==(a=n.connectSettings)?void 0:a.headers},t.next=5,Fa.processRequestInterceptor(n.deepChat,h);case 5:if(f=t.sent,v=f.body,m=f.headers,g=f.error,y=n.streamHandlers,b=y.onOpen,_=y.onClose,k=y.abortStream,!g){t.next=15;break}return t.abrupt("return",Fa.onInterceptorError(i,g,_));case 15:if(null==(l=n.connectSettings)||!l.handler){t.next=17;break}return t.abrupt("return",Ya.stream(n,v,i));case 17:if((null==(c=n.connectSettings)?void 0:c.url)!==Ja.URL){t.next=19;break}return t.abrupt("return",Ja.requestStream(i,n.streamHandlers));case 19:return x=new Na(i),w=Fa.fetch.bind(this,n,m,o),t.abrupt("return",(za((null==(u=n.connectSettings)?void 0:u.url)||n.url||"",{method:(null==(d=n.connectSettings)?void 0:d.method)||"POST",headers:m,credentials:null==(p=n.connectSettings)?void 0:p.credentials,body:o?JSON.stringify(v):v,openWhenHidden:!0,onopen:function(e){return uo(lo().mark((function t(){return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.ok){t.next=2;break}return t.abrupt("return",b());case 2:return t.next=4,Fa.processResponseByType(e);case 4:throw t.sent;case 5:case"end":return t.stop()}}),t)})))()},onmessage:function(t){return uo(lo().mark((function r(){var o,s,a,l,c;return lo().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(JSON.stringify(t.data)===JSON.stringify("[DONE]")){r.next=9;break}try{l=JSON.parse(t.data)}catch(e){l={}}return r.next=4,null==(s=(o=n.deepChat).responseInterceptor)?void 0:s.call(o,l);case 4:if(r.t0=r.sent,r.t0){r.next=7;break}r.t0=l;case 7:c=r.t0,null==(a=n.extractResultData)||a.call(n,c,w,v).then((function(t){n.asyncCallInProgress&&t&&""!==t.text?(e.simulate(i,n.streamHandlers,t),_(),n.asyncCallInProgress=!1):e.upsertWFiles(i,x.upsertStreamedMessage.bind(x),x,t)})).catch((function(e){return Fa.displayError(i,e)}));case 9:case"end":return r.stop()}}),r)})))()},onerror:function(e){throw _(),e},onclose:function(){if(!n.asyncCallInProgress)try{x.finaliseStreamedMessage(),_()}catch(e){if(!s)throw e}},signal:k.signal}).catch((function(e){var t;i.isLastMessageError()||null==(t=n.extractResultData)||t.call(n,e).then((function(){Fa.displayError(i,e)})).catch((function(e){Fa.displayError(i,e)}))})),x));case 21:case"end":return t.stop()}}),t,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"simulate",value:function(t,n,r){var i=n;if(r.files&&t.addNewMessage(ho({sendUpdate:!1,ignoreText:!0},r),!1),r.text){n.onOpen();var o=r.text.split("");e.populateMessages(o,new Na(t),i,"text")}if(r.html){n.onOpen();var s=ns.splitHTML(r.html);e.populateMessages(s,new Na(t),i,"html")}}},{key:"populateMessages",value:function(t,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=t[o];if(s){n.upsertStreamedMessage(fo({},i,s));var a=setTimeout((function(){e.populateMessages(t,n,r,i,o+1)}),r.simulationInterim||6);r.abortStream.abort=function(){e.abort(a,n,r.onClose)}}else n.finaliseStreamedMessage(),r.onClose()}},{key:"isSimulation",value:function(e){return"object"==vo(e)&&!!e.simulation}},{key:"isSimulatable",value:function(t,n){return e.isSimulation(t)&&n&&(n.text||n.html)}},{key:"abort",value:function(e,t,n){clearTimeout(e),t.finaliseStreamedMessage(),n()}},{key:"upsertWFiles",value:function(e,t,n,r){if(null!=r&&r.text||null!=r&&r.html){var i,o=t(r);null!==(i=n)&&void 0!==i||(n=o||void 0)}null!=r&&r.files&&(e.addNewMessage({files:r.files}),null==n||n.markFileAdded())}}]);var t}(),Ka=function(){function e(){mo(this,e)}return yo(e,null,[{key:"generateResponse",value:function(e){var t=e.messages[e.messages.length-1];if(t.files&&t.files.length>0){if(t.files.length>1)return"These are interesting files!";var n=t.files[0];return n.src&&n.src.startsWith("data:image/gif")?"That is a nice gif!":"image"===n.type?"That is a nice image!":"audio"===n.type?"I like the sound of that!":"That is an interesting file!"}if(t.text){if("?"===t.text.charAt(t.text.length-1))return"I'm sorry but I can't answer that question...";if(t.text.includes("updog"))return"What's updog?"}return"Hi there! This is a demo response!"}},{key:"getCustomResponse",value:function(e,t){return"function"==typeof e?e(t):e}},{key:"getResponse",value:function(t){return t.customDemoResponse?e.getCustomResponse(t.customDemoResponse,t.messages[t.messages.length-1]):{text:e.generateResponse(t)}}},{key:"request",value:function(t,n){var r=e.getResponse(n);setTimeout(uo(lo().mark((function e(){var i,o,s;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(o=(i=t.deepChat).responseInterceptor)?void 0:o.call(i,r);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=r;case 5:(s=e.t0).error?(n.addNewErrorMessage("service",s.error),t.completionsHandlers.onFinish()):Wa.isSimulatable(t.stream,s)?Wa.simulate(n,t.streamHandlers,s):(n.addNewMessage(s),t.completionsHandlers.onFinish());case 7:case"end":return e.stop()}}),e)}))),400)}},{key:"requestStream",value:function(t,n){setTimeout((function(){var r=e.getResponse(t);Wa.simulate(t,n,r)}),400)}}])}();Ka.URL="deep-chat-demo";var Ja=Ka,Xa=function(){function e(){mo(this,e)}return yo(e,null,[{key:"setup",value:function(e){e.connectSettings.url!==Ja.URL&&(e.permittedErrorPrefixes=["Connection error","Error in server message"],e.websocket="pending")}},{key:"isElementPresentInDOM",value:function(e){return e.getRootNode({composed:!0})instanceof Document}},{key:"createConnection",value:function(t,n){if(e.isElementPresentInDOM(t.deepChat)){var r=t.connectSettings.websocket;if(r){if(t.connectSettings.handler)return Ya.websocket(t,n);try{var i="boolean"!=typeof r?r:void 0,o=new WebSocket(t.connectSettings.url||"",i);t.websocket=o,t.websocket.onopen=function(){var r,i;n.removeError(),t.websocket&&"object"==vo(t.websocket)&&e.assignListeners(t,o,n),null==(i=(r=t.deepChat)._validationHandler)||i.call(r)},t.websocket.onerror=function(r){console.error(r),e.retryConnection(t,n)}}catch(i){console.error(i),e.retryConnection(t,n)}}}}},{key:"retryConnection",value:function(t,n){var r,i;null==(i=(r=t.deepChat)._validationHandler)||i.call(r),e.isElementPresentInDOM(t.deepChat)&&(t.websocket="pending",n.isLastMessageError()||n.addNewErrorMessage("service","Connection error"),setTimeout((function(){e.createConnection(t,n)}),5e3))}},{key:"assignListeners",value:function(t,n,r){var i=this,o={};n.onmessage=function(){var n=uo(lo().mark((function n(s){var a,l,c,u,d,p,h;return lo().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.extractResultData){n.next=20;break}return n.prev=1,c=JSON.parse(s.data),n.next=5,null==(l=(a=t.deepChat).responseInterceptor)?void 0:l.call(a,c);case 5:if(n.t0=n.sent,n.t0){n.next=8;break}n.t0=c;case 8:return u=n.t0,n.next=11,t.extractResultData(u);case 11:if((d=n.sent)&&"object"==vo(d)){n.next=14;break}throw Error(Bo.INVALID_RESPONSE(c,"server",!!t.deepChat.responseInterceptor,u));case 14:Wa.isSimulation(t.stream)?(p=e.stream.bind(i,t,r,o),h=o[c.role||$o.AI_ROLE],Wa.upsertWFiles(r,p,h,d)):r.addNewMessage(d),n.next=20;break;case 17:n.prev=17,n.t1=n.catch(1),Fa.displayError(r,n.t1,"Error in server message");case 20:case"end":return n.stop()}}),n,null,[[1,17]])})));return function(e){return n.apply(this,arguments)}}(),n.onclose=function(){console.error("Connection closed"),r.isLastMessageError()||r.addNewErrorMessage("service","Connection error"),t.stream&&t.streamHandlers.abortStream.abort(),e.createConnection(t,r)}}},{key:"sendWebsocket",value:(t=uo(lo().mark((function t(n,r,i){var o,s,a,l,c,u,d,p,h,f=arguments;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=!(f.length>3&&void 0!==f[3])||f[3],(l=n.websocket)&&"pending"!==l){t.next=4;break}return t.abrupt("return");case 4:return c={body:r,headers:null==(s=n.connectSettings)?void 0:s.headers},t.next=7,Fa.processRequestInterceptor(n.deepChat,c);case 7:if(u=t.sent,d=u.body,!(p=u.error)){t.next=12;break}return t.abrupt("return",i.addNewErrorMessage("service",p));case 12:if(e.isWebSocket(l)){t.next=14;break}return t.abrupt("return",l.newUserMessage.listener(d));case 14:if(h=o?JSON.stringify(d):d,(null==(a=n.connectSettings)?void 0:a.url)!==Ja.URL){t.next=17;break}return t.abrupt("return",Ja.request(n,i));case 17:void 0===l.readyState||l.readyState!==l.OPEN?(console.error("Connection is not open"),i.isLastMessageError()||i.addNewErrorMessage("service","Connection error")):(l.send(JSON.stringify(h)),n.completionsHandlers.onFinish());case 18:case"end":return t.stop()}}),t)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"canSendMessage",value:function(t){return!t||"pending"!==t&&(e.isWebSocket(t)?void 0!==t.readyState&&t.readyState===t.OPEN:t.isOpen)}},{key:"isWebSocket",value:function(e){return void 0!==e.send}},{key:"stream",value:function(e,t,n,r){if(r){var i=e.stream.simulation;if("string"==typeof i){var o,s=r.role||$o.AI_ROLE,a=n[s];r.text===i||r.html===i?(null==a||a.finaliseStreamedMessage(),delete n[s]):(null!==(o=n[s])&&void 0!==o||(n[s]=new Na(t)),n[s].upsertStreamedMessage(r))}else Wa.simulate(t,e.streamHandlers,r)}}}]);var t}(),Ya=function(){function e(){mo(this,e)}return yo(e,null,[{key:"request",value:(t=uo(lo().mark((function t(n,r,i){var o,s,a,l,c;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=!0,l=function(){var e=uo(lo().mark((function e(t){var r,o,s;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return a=!1,e.next=5,null==(o=(r=n.deepChat).responseInterceptor)?void 0:o.call(r,t);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0=t;case 8:s=e.t0,Fa.validateResponseFormat(s)?"string"==typeof s.error?(console.error(s.error),i.addNewErrorMessage("service",s.error),n.completionsHandlers.onFinish()):Wa.isSimulatable(n.stream,s)?Wa.simulate(i,n.streamHandlers,s):(i.addNewMessage(s),n.completionsHandlers.onFinish()):(console.error(Bo.INVALID_RESPONSE(t,"server",!!n.deepChat.responseInterceptor,s)),i.addNewErrorMessage("service","Error in server message"),n.completionsHandlers.onFinish());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=e.generateOptionalSignals(),null==(s=(o=n.connectSettings).handler)||s.call(o,r,ho(ho({},c),{},{onResponse:l}));case 3:case"end":return t.stop()}}),t)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"attemptToFinaliseStream",value:function(e,t){try{e.finaliseStreamedMessage()}catch(e){console.error(e),t.addNewErrorMessage("service",e)}}},{key:"stream",value:function(t,n,r){var i,o,s=!0,a=!1,l=new Na(r),c=function(){var e=uo(lo().mark((function e(n){var i,o,a;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,null==(o=(i=t.deepChat).responseInterceptor)?void 0:o.call(i,n);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=n;case 7:a=e.t0,Fa.validateResponseFormat(a)?a.error?(console.error(a.error),l.finaliseStreamedMessage(),r.addNewErrorMessage("service",a.error),t.streamHandlers.onClose(),s=!1):Wa.upsertWFiles(r,l.upsertStreamedMessage.bind(l),l,a):console.error(Bo.INVALID_RESPONSE(n,"server",!!t.deepChat.responseInterceptor,a));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.streamHandlers.abortStream.abort=function(){e.attemptToFinaliseStream(l,r),t.streamHandlers.onClose(),s=!1};var u=e.generateOptionalSignals();null==(o=(i=t.connectSettings).handler)||o.call(i,n,ho(ho({},u),{},{onOpen:function(){a||!s||(t.streamHandlers.onOpen(),a=!0)},onResponse:c,onClose:function(){s&&(e.attemptToFinaliseStream(l,r),t.streamHandlers.onClose(),s=!1)},stopClicked:t.streamHandlers.stopClicked}))}},{key:"websocket",value:function(t,n){var r,i,o=this,s={isOpen:!1,newUserMessage:{listener:function(){}},roleToStream:{}};t.websocket=s;var a=function(){var e=uo(lo().mark((function e(r){var i,a,l,c,u;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.isOpen){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,null==(a=(i=t.deepChat).responseInterceptor)?void 0:a.call(i,r);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=r;case 7:l=e.t0,Fa.validateResponseFormat(l)?"string"==typeof l.error?(console.error(l.error),n.isLastMessageError()||n.addNewErrorMessage("service",l.error)):Wa.isSimulation(t.stream)?(c=Xa.stream.bind(o,t,n,s.roleToStream),u=s.roleToStream[r.role||$o.AI_ROLE],Wa.upsertWFiles(n,c,u,r)):n.addNewMessage(l):(console.error(Bo.INVALID_RESPONSE(r,"server",!!t.deepChat.responseInterceptor,l)),n.addNewErrorMessage("service","Error in server message"));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=e.generateOptionalSignals();null==(i=(r=t.connectSettings).handler)||i.call(r,void 0,ho(ho({},l),{},{onOpen:function(){n.removeError(),s.isOpen=!0},onResponse:a,onClose:function(){s.isOpen=!1},newUserMessage:s.newUserMessage}))}},{key:"generateOptionalSignals",value:function(){return{onClose:function(){},onOpen:function(){},stopClicked:{listener:function(){}},newUserMessage:{listener:function(){}}}}}]);var t}(),$a=function(){function e(){mo(this,e)}return yo(e,null,[{key:"request",value:(n=uo(lo().mark((function e(t,n,r){var i,o,s,a,l,c,u,d,p,h,f,v,m=arguments;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=!(m.length>3&&void 0!==m[3])||m[3],l={body:n,headers:null==(o=t.connectSettings)?void 0:o.headers},e.next=4,Fa.processRequestInterceptor(t.deepChat,l);case 4:if(c=e.sent,u=c.body,d=c.headers,p=c.error,h=t.completionsHandlers.onFinish,!p){e.next=11;break}return e.abrupt("return",Fa.onInterceptorError(r,p,h));case 11:if(null==(s=t.connectSettings)||!s.handler){e.next=13;break}return e.abrupt("return",Ya.request(t,u,r));case 13:if((null==(a=t.connectSettings)?void 0:a.url)!==Ja.URL){e.next=15;break}return e.abrupt("return",Ja.request(t,r));case 15:f=!0,(v=Fa.fetch.bind(this,t,d,i))(u).then((function(e){return f=!!e.ok,e})).then((function(e){return Fa.processResponseByType(e)})).then(function(){var e=uo(lo().mark((function e(n){var i,o,s,a;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.extractResultData){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,null==(o=(i=t.deepChat).responseInterceptor)?void 0:o.call(i,n);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=n;case 7:return s=e.t0,e.next=10,t.extractResultData(s,v,u);case 10:if(a=e.sent,f){e.next=13;break}throw n;case 13:if(a&&"object"==vo(a)){e.next=15;break}throw Error(Bo.INVALID_RESPONSE(n,"response",!!t.deepChat.responseInterceptor,s));case 15:a.makingAnotherRequest||(Wa.isSimulatable(t.stream,a)?Wa.simulate(r,t.streamHandlers,a):(r.addNewMessage(a),h()));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){Fa.displayError(r,e),h()}));case 18:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"executePollRequest",value:function(t,n,r,i){var o=t.completionsHandlers.onFinish;fetch(n,r).then((function(e){return e.json()})).then(function(){var s=uo(lo().mark((function s(a){var l,c,u;return lo().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(t.extractPollResultData){s.next=2;break}return s.abrupt("return");case 2:return s.t0=t,s.next=5,null==(c=(l=t.deepChat).responseInterceptor)?void 0:c.call(l,a);case 5:if(s.t1=s.sent,s.t1){s.next=8;break}s.t1=a;case 8:return s.t2=s.t1,s.next=11,s.t0.extractPollResultData.call(s.t0,s.t2);case 11:(u=s.sent).timeoutMS?setTimeout((function(){e.executePollRequest(t,n,r,i)}),u.timeoutMS):Wa.isSimulatable(t.stream,u)?Wa.simulate(i,t.streamHandlers,u):(i.addNewMessage(u),o());case 13:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}()).catch((function(e){Fa.displayError(i,e),o()}))}},{key:"poll",value:(t=uo(lo().mark((function t(n,r,i){var o,s,a,l,c,u,d,p,h,f,v,m,g,y=arguments;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=!(y.length>3&&void 0!==y[3])||y[3],c={body:r,headers:null==(s=n.connectSettings)?void 0:s.headers},t.next=4,Fa.processRequestInterceptor(n.deepChat,c);case 4:if(u=t.sent,d=u.body,p=u.headers,!(h=u.error)){t.next=10;break}return t.abrupt("return",Fa.onInterceptorError(i,h));case 10:f=(null==(a=n.connectSettings)?void 0:a.url)||n.url||"",v=(null==(l=n.connectSettings)?void 0:l.method)||"POST",m=o?JSON.stringify(d):d,g={method:v,body:m,headers:p},n.connectSettings.credentials&&(g.credentials=n.connectSettings.credentials),e.executePollRequest(n,f,g,i);case 12:case"end":return t.stop()}}),t)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"verifyKey",value:function(e,t,n,r,i,o,s,a,l){if(""===e)return o(Bo.INVALID_KEY);s(),fetch(t,{method:r,headers:n,body:l||null}).then((function(e){return Fa.processResponseByType(e)})).then((function(t){a(t,e,i,o)})).catch((function(e){o(Bo.CONNECTION_FAILED),console.error(e)}))}}]);var t,n}(),Za=function(){function e(){mo(this,e)}return yo(e,null,[{key:"getCharacterLimitMessages",value:function(e,t){var n;if(-1===t)return e;for(var r=0,i=e.length-1;i>=0;i-=1){var o=null==(n=e[i])?void 0:n.text;if(void 0!==o&&(r+=o.length)>t){e[i].text=o.substring(0,o.length-(r-t));break}}return e.slice(Math.max(i,0))}},{key:"getMaxMessages",value:function(e,t){return e.slice(Math.max(e.length-t,0))}},{key:"processMessages",value:function(t,n,r){return void 0!==n?n>0&&(t=e.getMaxMessages(t,n)):t=[t[t.length-1]],t=JSON.parse(JSON.stringify(t)),void 0===r?t:e.getCharacterLimitMessages(t,r)}}])}(),Qa=function(){function e(){mo(this,e)}return yo(e,null,[{key:"parseConfig",value:function(e,t,n,r){var i,o={files:t};if("object"==vo(r)){zo.processFileConfigConnect(r);var s=r.files,a=r.connect,l=r.button;s&&(s.infoModal&&(o.files.infoModal=s.infoModal,null!=(i=s.infoModal)&&i.textMarkDown&&(o.infoModalTextMarkUp=n.render(s.infoModal.textMarkDown))),s.acceptedFormats&&(o.files.acceptedFormats=s.acceptedFormats),s.maxNumberOfFiles&&(o.files.maxNumberOfFiles=s.maxNumberOfFiles)),o.button=l,a&&(a.headers||a.method||a.url||a.credentials||e.headers||e.method||e.url||e.credentials)&&(o.connect={url:(null==a?void 0:a.url)||e.url,method:(null==a?void 0:a.method)||e.method,headers:(null==a?void 0:a.headers)||e.headers,credentials:(null==a?void 0:a.credentials)||e.credentials})}return o}},{key:"processMixedFiles",value:function(t,n,r){if(r){t.fileTypes.mixedFiles=e.parseConfig(t.connectSettings,{acceptedFormats:""},n,r)}}},{key:"processMicrophone",value:function(t,n,r,i){var o,s,a,l,c,u,d,p,h=ho({acceptedFormats:"audio/*"},(null==(a=t.fileTypes.audio)?void 0:a.files)||{});r&&(void 0!==navigator.mediaDevices.getUserMedia?(t.recordAudio=e.parseConfig(t.connectSettings,h,n,r),"object"==vo(r)&&r.files&&(null!==(o=(l=t.recordAudio).files)&&void 0!==o||(l.files={}),t.recordAudio.files.format=null==(c=r.files)?void 0:c.format,t.recordAudio.files.maxDurationSeconds=null==(u=r.files)?void 0:u.maxDurationSeconds,null!=(d=t.fileTypes.audio)&&d.files&&(null!==(s=(p=t.fileTypes.audio.files).maxNumberOfFiles)&&void 0!==s||(p.maxNumberOfFiles=r.files.maxNumberOfFiles)))):i||(t.fileTypes.audio=e.parseConfig(t.connectSettings,h,n,r)))}},{key:"processAudioConfig",value:function(t,n,r,i){if(r||i){var o=ho({acceptedFormats:"audio/*"},(null==i?void 0:i.files)||{});t.fileTypes.audio=e.parseConfig(t.connectSettings,o,n,r)}}},{key:"processGifConfig",value:function(t,n,r,i){if(r||i){var o=ho({acceptedFormats:"image/gif"},(null==i?void 0:i.files)||{});t.fileTypes.gifs=e.parseConfig(t.connectSettings,o,n,r)}}},{key:"processCamera",value:function(t,n,r,i){var o,s,a,l,c,u=ho({acceptedFormats:"image/*"},(null==(s=t.fileTypes.images)?void 0:s.files)||{});r&&(void 0!==navigator.mediaDevices.getUserMedia?(t.camera=e.parseConfig(t.connectSettings,u,n,r),"object"==vo(r)&&(t.camera.modalContainerStyle=r.modalContainerStyle,r.files&&(null!==(o=(a=t.camera).files)&&void 0!==o||(a.files={}),t.camera.files.format=null==(l=r.files)?void 0:l.format,t.camera.files.dimensions=null==(c=r.files)?void 0:c.dimensions))):i||(t.fileTypes.images=e.parseConfig(t.connectSettings,u,n,r)))}},{key:"processImagesConfig",value:function(t,n,r,i){if(r||i){var o=ho({acceptedFormats:"image/*"},(null==i?void 0:i.files)||{});t.fileTypes.images=e.parseConfig(t.connectSettings,o,n,r)}}},{key:"populateDefaultFileIO",value:function(e,t){var n,r,i,o,s;e&&(null!==(n=e.files)&&void 0!==n||(e.files={}),null!==(r=(o=e.files).acceptedFormats)&&void 0!==r||(o.acceptedFormats=t),null!==(i=(s=e.files).maxNumberOfFiles)&&void 0!==i||(s.maxNumberOfFiles=1))}},{key:"set",value:function(t,n,r){e.populateDefaultFileIO(null==r?void 0:r.audio,".4a,.mp3,.webm,.mp4,.mpga,.wav,.mpeg,.m4a"),e.populateDefaultFileIO(null==r?void 0:r.images,".png,.jpg");var i=Aa.createNew();e.processImagesConfig(n,i,t.images,null==r?void 0:r.images),e.processCamera(n,i,t.camera,t.images),e.processGifConfig(n,i,t.gifs,null==r?void 0:r.gifs),e.processAudioConfig(n,i,t.audio,null==r?void 0:r.audio),e.processMicrophone(n,i,t.microphone,t.audio),e.processMixedFiles(n,i,t.mixedFiles)}}])}(),el=function(){function e(t,n,r){var i,o,s,a,l,c;mo(this,e),this.rawBody={},this.validateKeyProperty=!1,this.canSendMessage=e.canSendMessage,this.connectSettings={},this.fileTypes={},this.completionsHandlers={},this.streamHandlers={},this.deepChat=t,this.demo=r,Object.assign(this.rawBody,null==(o=t.connect)?void 0:o.additionalBodyProps),this.totalMessagesMaxCharLength=null==(s=null==t?void 0:t.requestBodyLimits)?void 0:s.totalMessagesMaxCharLength,this.maxMessages=null==(a=null==t?void 0:t.requestBodyLimits)?void 0:a.maxMessages,Qa.set(t,this,n),t.connect&&(this.connectSettings=t.connect),this.demo&&(null!==(i=(l=this.connectSettings).url)&&void 0!==i||(l.url=Ja.URL)),this.connectSettings.websocket&&Xa.setup(this),this.stream=(null==(c=this.deepChat.connect)?void 0:c.stream)||zo.checkForStream(this.deepChat)}return yo(e,[{key:"verifyKey",value:function(e,t){}},{key:"getServiceIOByType",value:function(e){if(e.type.startsWith("audio")&&this.fileTypes.audio)return this.fileTypes.audio;if(e.type.startsWith("image")){if(this.fileTypes.gifs&&e.type.endsWith("/gif"))return this.fileTypes.gifs;if(this.fileTypes.images)return this.fileTypes.images;if(this.camera)return this.camera}return this.fileTypes.mixedFiles}},{key:"request",value:(s=uo(lo().mark((function e(t,n){var r,i=arguments;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(i.length>2&&void 0!==i[2])||i[2],e.abrupt("return",this.stream&&!Wa.isSimulation(this.stream)?Wa.request(this,t,n,r):$a.request(this,t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"callAPIWithText",value:(o=uo(lo().mark((function e(t,n){var r,i,o,s,a,l,c,u;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=ho({messages:n},this.rawBody),u=!1,null!=(o=this.connectSettings.headers)&&o["Content-Type"]||(null!==(r=(s=this.connectSettings).headers)&&void 0!==r||(s.headers={}),null!==(i=(a=this.connectSettings.headers)["Content-Type"])&&void 0!==i||(a["Content-Type"]="application/json"),u=!0),e.next=5,this.request(c,t);case 5:u&&(null==(l=this.connectSettings.headers)||delete l["Content-Type"]);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"callApiWithFiles",value:(i=uo(lo().mark((function t(n,r,i){var o,s,a;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.createCustomFormDataBody(this.rawBody,r,i),s=this.connectSettings,a=this.getServiceIOByType(i[0]),this.connectSettings=(null==a?void 0:a.connect)||this.connectSettings,t.next=4,this.request(o,n,!1);case 4:this.connectSettings=s;case 5:case"end":return t.stop()}}),t,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"callServiceAPI",value:(r=uo(lo().mark((function e(t,n,r){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r?this.callApiWithFiles(t,n,r):this.callAPIWithText(t,n);case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"callAPI",value:(n=uo(lo().mark((function e(t,n){var r,i;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:r=Za.processMessages(n.messages,this.maxMessages,this.totalMessagesMaxCharLength),this.connectSettings.websocket?(i=ho({messages:r},this.rawBody),Xa.sendWebsocket(this,i,n,!1)):this.callServiceAPI(n,r,t.files);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:if(!t.result){e.next=4;break}return e.abrupt("return",zo.handleResponseProperty(t));case 4:if(!Fa.validateResponseFormat(t)){e.next=6;break}return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"isDirectConnection",value:function(){return!1}},{key:"isWebModel",value:function(){return!1}}],[{key:"canSendMessage",value:function(e,t,n){return!!n||(!(!e||""===e.trim())||!!(t&&t.length>0))}},{key:"createCustomFormDataBody",value:function(e,t,n){var r=new FormData;n.forEach((function(e){return r.append("files",e)})),Object.keys(e).forEach((function(t){return r.append(t,String(e[t]))}));var i=0;t.slice(0,t.length-1).forEach((function(e){r.append("message".concat(i+=1),JSON.stringify(e))}));var o=t[t.length-1];return o.text&&(delete o.files,r.append("message".concat(i+=1),JSON.stringify(o))),r}}]);var t,n,r,i,o,s}(),tl=function(){function e(t,n,r,i,o){var s,a;return mo(this,e),(s=no(this,e,[t,o])).insertKeyPlaceholderText="API Key",s.keyHelpUrl="",Object.assign(s.rawBody,null==(a=t.connect)?void 0:a.additionalBodyProps),s.keyVerificationDetails=n,s.buildHeadersFunc=r,i&&s.setApiKeyProperties(i),s.connectSettings=s.buildConnectSettings(s.key||"",t.connect),s}return so(e,el),yo(e,[{key:"setApiKeyProperties",value:function(e){this.key=e.key,e.validateKeyProperty&&(this.validateKeyProperty=e.validateKeyProperty)}},{key:"buildConnectSettings",value:function(e,t){var n,r=null!=t?t:{};return null!==(n=r.headers)&&void 0!==n||(r.headers={}),Object.assign(r.headers,this.buildHeadersFunc(e)),r}},{key:"keyAuthenticated",value:function(e,t){this.connectSettings=this.buildConnectSettings(t,this.connectSettings),this.key=t,e()}},{key:"verifyKey",value:function(e,t){var n=this.keyVerificationDetails,r=n.url,i=n.method,o=n.handleVerificationResult,s=n.createHeaders,a=n.body,l=(null==s?void 0:s(e))||this.buildHeadersFunc(e);$a.verifyKey(e,r,l,i,this.keyAuthenticated.bind(this,t.onSuccess),t.onFail,t.onLoad,o,a)}},{key:"isDirectConnection",value:function(){return!0}}])}(),nl=function(){function e(){mo(this,e)}return yo(e,null,[{key:"waitForPropertiesToBeUpdatedBeforeRender",value:function(t){t._propUpdated_=!1,setTimeout((function(){t._propUpdated_?e.waitForPropertiesToBeUpdatedBeforeRender(t):(t._waitingToRender_=!1,t.onRender())}))}},{key:"attemptRender",value:function(t){t._propUpdated_=!0,t._waitingToRender_||(t._waitingToRender_=!0,e.waitForPropertiesToBeUpdatedBeforeRender(t))}}])}(),rl=function(){function e(){var t;return mo(this,e),(t=no(this,e))._waitingToRender_=!1,t._propUpdated_=!1,Object.keys(e._attributeToProperty_).forEach((function(n){var r=e._attributeToProperty_[n];t.constructPropertyAccessors(r),t.hasOwnProperty(n)||t.constructPropertyAccessors(r,n)})),t}return so(e,to(HTMLElement)),yo(e,[{key:"constructPropertyAccessors",value:function(e,t){var n;Object.defineProperty(this,t||e,{get:function(){return n},set:function(r){n=r,t?this[e]=r:nl.attemptRender(this)}})}},{key:"attributeChangedCallback",value:function(t,n,r){if(n!==r){var i=e._attributes_[t](r);this[e._attributeToProperty_[t]]=i}}},{key:"onRender",value:function(){}}],[{key:"observedAttributes",get:function(){return Object.keys(e._attributes_)||[]}}])}();rl._attributes_={},rl._attributeToProperty_={};var il=rl,ol=function(){return yo((function e(){mo(this,e)}),null,[{key:"createSVGElement",value:function(e){return(new DOMParser).parseFromString(e,"image/svg+xml").documentElement}}])}(),sl=function(){function e(){mo(this,e)}return yo(e,null,[{key:"changeVisibility",value:function(t,n,r,i){i.target.id===e.VISIBLE_ICON_ID?(n.style.display="none",r.style.display="block",t.type="password"):(n.style.display="block",r.style.display="none",t.type="text")}},{key:"createIconElement",value:function(e,t){var n=ol.createSVGElement(e);return n.id=t,n.classList.add("visibility-icon"),n}},{key:"create",value:function(t){var n=document.createElement("div");n.id="visibility-icon-container";var r=e.createIconElement('<?xml version="1.0" standalone="no"?>\n<svg version="1.1"\n\txmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n\txmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="0.9em" height="0.9em"\n\tviewBox="0 0 1200 1200" enable-background="new 0 0 1200 1200">\n\t\t<path id="path6686" inkscape:connector-curvature="0" d="M779.843,599.925c0,95.331-80.664,172.612-180.169,172.612\n\t\t\tc-99.504,0-180.168-77.281-180.168-172.612c0-95.332,80.664-172.612,180.168-172.612\n\t\t\tC699.179,427.312,779.843,504.594,779.843,599.925z M600,240.521c-103.025,0.457-209.814,25.538-310.904,73.557\n\t\t\tc-75.058,37.122-148.206,89.496-211.702,154.141C46.208,501.218,6.431,549,0,599.981c0.76,44.161,48.13,98.669,77.394,131.763\n\t\t\tc59.543,62.106,130.786,113.018,211.702,154.179c94.271,45.751,198.616,72.092,310.904,73.557\n\t\t\tc103.123-0.464,209.888-25.834,310.866-73.557c75.058-37.122,148.243-89.534,211.74-154.179\n\t\t\tc31.185-32.999,70.962-80.782,77.394-131.763c-0.76-44.161-48.13-98.671-77.394-131.764\n\t\t\tc-59.543-62.106-130.824-112.979-211.74-154.141C816.644,268.36,712.042,242.2,600,240.521z M599.924,329.769\n\t\t\tc156.119,0,282.675,120.994,282.675,270.251c0,149.256-126.556,270.25-282.675,270.25S317.249,749.275,317.249,600.02\n\t\t\tC317.249,450.763,443.805,329.769,599.924,329.769L599.924,329.769z"/>\n</svg>\n',e.VISIBLE_ICON_ID);r.style.display="none",n.appendChild(r);var i=e.createIconElement('<?xml version="1.0" standalone="no"?>\n<svg version="1.1"\n\txmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n\txmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="0.9em" height="0.9em"\n\tviewBox="0 0 1200 1200" enable-background="new 0 0 1200 1200">\n\t\t<path d="\n\t\t\tM669.727,273.516c-22.891-2.476-46.15-3.895-69.727-4.248c-103.025,0.457-209.823,25.517-310.913,73.536\n\t\t\tc-75.058,37.122-148.173,89.529-211.67,154.174C46.232,529.978,6.431,577.76,0,628.74c0.76,44.162,48.153,98.67,77.417,131.764\n\t\t\tc59.543,62.106,130.754,113.013,211.67,154.174c2.75,1.335,5.51,2.654,8.276,3.955l-75.072,131.102l102.005,60.286l551.416-960.033\n\t\t\tl-98.186-60.008L669.727,273.516z M902.563,338.995l-74.927,129.857c34.47,44.782,54.932,100.006,54.932,159.888\n\t\t\tc0,149.257-126.522,270.264-282.642,270.264c-6.749,0-13.29-0.728-19.922-1.172l-49.585,85.84c22.868,2.449,45.99,4.233,69.58,4.541\n\t\t\tc103.123-0.463,209.861-25.812,310.84-73.535c75.058-37.122,148.246-89.529,211.743-154.174\n\t\t\tc31.186-32.999,70.985-80.782,77.417-131.764c-0.76-44.161-48.153-98.669-77.417-131.763\n\t\t\tc-59.543-62.106-130.827-113.013-211.743-154.175C908.108,341.478,905.312,340.287,902.563,338.995L902.563,338.995z\n\t\t\tM599.927,358.478c6.846,0,13.638,0.274,20.361,0.732l-58.081,100.561c-81.514,16.526-142.676,85.88-142.676,168.897\n\t\t\tc0,20.854,3.841,40.819,10.913,59.325c0.008,0.021-0.008,0.053,0,0.074l-58.228,100.854\n\t\t\tc-34.551-44.823-54.932-100.229-54.932-160.182C317.285,479.484,443.808,358.477,599.927,358.478L599.927,358.478z M768.896,570.513\n\t\t\tL638.013,797.271c81.076-16.837,141.797-85.875,141.797-168.603C779.81,608.194,775.724,588.729,768.896,570.513L768.896,570.513z"\n\t\t\t/>\n</svg>\n',"not-visible-icon");return n.appendChild(i),n.onclick=e.changeVisibility.bind(this,t,r,i),n}}])}();sl.VISIBLE_ICON_ID="visible-icon";var al=sl,ll=function(){function e(){mo(this,e)}return yo(e,null,[{key:"createCautionText",value:function(){var e=document.createElement("a");return e.classList.add("insert-key-input-help-text"),e.innerText="Please exercise CAUTION when inserting your API key outside of deepchat.dev or localhost!!",e}},{key:"createHelpLink",value:function(e){var t=document.createElement("a");return t.classList.add("insert-key-input-help-text"),t.href=e,t.innerText="Find more info here",t.target="_blank",t}},{key:"createFailText",value:function(){var e=document.createElement("div");return e.id="insert-key-input-invalid-text",e.style.display="none",e}},{key:"createHelpTextContainer",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=document.createElement("div");r.id="insert-key-help-text-container";var i=document.createElement("div");i.id="insert-key-help-text-contents";var o=e.createFailText();if(i.appendChild(o),t){var s=e.createHelpLink(t);i.appendChild(s)}if(!0===n){var a=e.createCautionText();i.appendChild(a)}return r.appendChild(i),{helpTextContainerElement:r,failTextElement:o}}},{key:"onFail",value:function(e,t,n,r){e.classList.replace("insert-key-input-valid","insert-key-input-invalid"),n.innerText=r,n.style.display="block",t.innerText="Start",e.classList.remove("loading")}},{key:"onLoad",value:function(e,t){e.classList.add("loading"),t.innerHTML='<div id="loading-ring"></div>'}},{key:"verifyKey",value:function(e,t,n){var r=e.value.trim();n.verifyKey(r,t)}},{key:"addVerificationEvents",value:function(t,n,r,i,o){var s={onSuccess:i,onFail:e.onFail.bind(this,t,n,r),onLoad:e.onLoad.bind(this,t,n)},a=e.verifyKey.bind(this,t,s,o);n.onclick=a,t.onkeydown=function(e){!t.classList.contains("loading")&&e.key===Ao.ENTER&&a()}}},{key:"createStartButton",value:function(){var e=document.createElement("div");return e.id="start-button",e.innerText="Start",e}},{key:"onInputFocus",value:function(e){e.target.classList.replace("insert-key-input-invalid","insert-key-input-valid")}},{key:"createInput",value:function(t){var n=document.createElement("div");n.id="insert-key-input-container";var r=document.createElement("input");return r.id="insert-key-input",r.placeholder=t||"API Key",r.type="password",r.classList.add("insert-key-input-valid"),r.onfocus=e.onInputFocus,n.appendChild(r),n}},{key:"createContents",value:function(t,n){var r,i=document.createElement("div");i.id="insert-key-contents";var o=e.createInput(n.insertKeyPlaceholderText),s=o.children[0],a=al.create(s);o.appendChild(a),i.appendChild(o);var l=e.createStartButton(),c=e.createHelpTextContainer(n.keyHelpUrl,null==(r=n.deepChat._insertKeyViewStyles)?void 0:r.displayCautionText),u=c.helpTextContainerElement,d=c.failTextElement;return i.appendChild(l),i.appendChild(u),e.addVerificationEvents(s,l,d,t,n),i}},{key:"createElements",value:function(t,n){var r=document.createElement("div");r.id="insert-key-view";var i=e.createContents(t,n);return r.appendChild(i),r}},{key:"render",value:function(t,n,r){var i=e.createElements(n,r);t.replaceChildren(i)}}])}(),cl=function(){function e(){mo(this,e)}return yo(e,null,[{key:"enableButtons",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;window.webLLM?(t&&(t.disabled=!1),n&&(n.disabled=!1)):r<4*hl.MODULE_SEARCH_LIMIT_S&&setTimeout((function(){return e.enableButtons(t,n,r+1)}),250)}},{key:"setUpInitial",value:function(t,n,r,i){var o=(null==n?void 0:n.downloadClass)||e.DOWNLOAD_BUTTON_CLASS,s=(null==n?void 0:n.uploadClass)||e.UPLOAD_BUTTON_CLASS,a=(null==n?void 0:n.fileInputClass)||e.FILE_INPUT_CLASS;return setTimeout((function(){var n=null==r?void 0:r.getElementsByClassName(o)[0],i=null==r?void 0:r.getElementsByClassName(a)[0],l=null==r?void 0:r.getElementsByClassName(s)[0];n&&(n.onclick=function(){return t()}),i&&(i.onchange=function(){i.files&&i.files.length>0&&t(i.files)}),l&&(l.onclick=function(){return i.click()}),(n||l)&&e.enableButtons(n,l)})),(null==n?void 0:n.initialHtml)||'<div>\n        Download or upload a web model that will run entirely on your browser: <br/> \n        <button disabled class="'.concat(o,' deep-chat-button deep-chat-web-model-button">Download</button>\n        ').concat(i?"":'<input type="file" class="'.concat(a,'" hidden multiple />\n          <button disabled class="').concat(s,' deep-chat-button deep-chat-web-model-button">Upload</button>'),"\n      </div>")}},{key:"exportFile",value:function(e){for(var t=document.createElement("a"),n=function(n){setTimeout((function(){for(var r=4*n,i=r;i<Math.min(r+4,e.length);i+=1){var o=URL.createObjectURL(e[i]);t.href=o,t.download=e[i].name,document.body.appendChild(t),t.click(),URL.revokeObjectURL(o)}}),500*n)},r=0;r<e.length/4;r+=1)n(r)}},{key:"setUpAfterLoad",value:function(t,n,r,i){var o=(null==n?void 0:n.exportFilesClass)||e.EXPORT_BUTTON_CLASS;return setTimeout((function(){var n=null==r?void 0:r.getElementsByClassName(o)[0];n&&(n.onclick=function(){return e.exportFile(t)})})),(null==n?void 0:n.afterLoadHtml)||"<div>\n        Model loaded successfully and has been cached for future requests.\n        ".concat(i?"":'<br/> <button style="margin-top: 5px" class="'.concat(o,' deep-chat-button">Export</button>'),"\n      </div>")}}])}();cl.DOWNLOAD_BUTTON_CLASS="deep-chat-download-button",cl.UPLOAD_BUTTON_CLASS="deep-chat-upload-button",cl.FILE_INPUT_CLASS="deep-chat-file-input",cl.EXPORT_BUTTON_CLASS="deep-chat-export-button";var ul=cl,dl={model_list:[{model_url:"https://huggingface.co/mlc-ai/Llama-2-7b-chat-hf-q4f32_1-MLC/resolve/main/",local_id:"Llama-2-7b-chat-hf-q4f32_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Llama-2-7b-chat-hf/Llama-2-7b-chat-hf-q4f32_1-ctx4k_cs1k-webgpu.wasm",vram_required_MB:9109.03,low_resource_required:!1},{model_url:"https://huggingface.co/mlc-ai/Llama-2-7b-chat-hf-q4f16_1-MLC/resolve/main/",local_id:"Llama-2-7b-chat-hf-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Llama-2-7b-chat-hf/Llama-2-7b-chat-hf-q4f16_1-ctx4k_cs1k-webgpu.wasm",vram_required_MB:6749.02,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/Llama-2-7b-chat-hf-q4f16_1-MLC/resolve/main/",local_id:"Llama-2-7b-chat-hf-q4f16_1-1k",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Llama-2-7b-chat-hf/Llama-2-7b-chat-hf-q4f16_1-ctx1k-webgpu.wasm",vram_required_MB:4618.52,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/Llama-2-13b-chat-hf-q4f16_1-MLC/resolve/main/",local_id:"Llama-2-13b-chat-hf-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Llama-2-13b-chat-hf/Llama-2-13b-chat-hf-q4f16_1-ctx4k_cs1k-webgpu.wasm",vram_required_MB:11814.09,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/Llama-2-70b-chat-hf-q4f16_1-MLC/resolve/main/",local_id:"Llama-2-70b-chat-hf-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Llama-2-70b-chat-hf/Llama-2-70b-chat-hf-q4f16_1-ctx4k_cs1k-webgpu.wasm",vram_required_MB:43729.05,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/RedPajama-INCITE-Chat-3B-v1-q4f16_1-MLC/resolve/main/",local_id:"RedPajama-INCITE-Chat-3B-v1-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/RedPajama-INCITE-Chat-3B-v1/RedPajama-INCITE-Chat-3B-v1-q4f16_1-ctx2k-webgpu.wasm",vram_required_MB:2972.09,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/RedPajama-INCITE-Chat-3B-v1-q4f32_1-MLC/resolve/main/",local_id:"RedPajama-INCITE-Chat-3B-v1-q4f32_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/RedPajama-INCITE-Chat-3B-v1/RedPajama-INCITE-Chat-3B-v1-q4f32_1-ctx2k-webgpu.wasm",vram_required_MB:3928.09,low_resource_required:!1},{model_url:"https://huggingface.co/mlc-ai/RedPajama-INCITE-Chat-3B-v1-q4f16_1-MLC/resolve/main/",local_id:"RedPajama-INCITE-Chat-3B-v1-q4f16_1-1k",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/RedPajama-INCITE-Chat-3B-v1/RedPajama-INCITE-Chat-3B-v1-q4f16_1-ctx1k-webgpu.wasm",vram_required_MB:2041.09,low_resource_required:!0,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/RedPajama-INCITE-Chat-3B-v1-q4f32_1-MLC/resolve/main/",local_id:"RedPajama-INCITE-Chat-3B-v1-q4f32_1-1k",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/RedPajama-INCITE-Chat-3B-v1/RedPajama-INCITE-Chat-3B-v1-q4f32_1-ctx1k-webgpu.wasm",vram_required_MB:2558.09,low_resource_required:!0},{model_url:"https://huggingface.co/mlc-ai/WizardMath-7B-V1.1-q4f16_1-MLC/resolve/main/",local_id:"WizardMath-7B-V1.1-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Mistral-7B-Instruct-v0.2/Mistral-7B-Instruct-v0.2-q4f16_1-sw4k_cs1k-webgpu.wasm",vram_required_MB:6079.02,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/Mistral-7B-Instruct-v0.2-q4f16_1-MLC/resolve/main/",local_id:"Mistral-7B-Instruct-v0.2-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Mistral-7B-Instruct-v0.2/Mistral-7B-Instruct-v0.2-q4f16_1-sw4k_cs1k-webgpu.wasm",vram_required_MB:6079.02,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/OpenHermes-2.5-Mistral-7B-q4f16_1-MLC/resolve/main/",local_id:"OpenHermes-2.5-Mistral-7B-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Mistral-7B-Instruct-v0.2/Mistral-7B-Instruct-v0.2-q4f16_1-sw4k_cs1k-webgpu.wasm",vram_required_MB:6079.02,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/NeuralHermes-2.5-Mistral-7B-q4f16_1-MLC/resolve/main/",local_id:"NeuralHermes-2.5-Mistral-7B-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Mistral-7B-Instruct-v0.2/Mistral-7B-Instruct-v0.2-q4f16_1-sw4k_cs1k-webgpu.wasm",vram_required_MB:6079.02,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/TinyLlama-1.1B-Chat-v0.4-q0f16-MLC/resolve/main/",local_id:"TinyLlama-1.1B-Chat-v0.4-q0f16",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/TinyLlama-1.1B-Chat-v0.4/TinyLlama-1.1B-Chat-v0.4-q0f16-ctx2k-webgpu.wasm",vram_required_MB:5063.52,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/TinyLlama-1.1B-Chat-v0.4-q0f32-MLC/resolve/main/",local_id:"TinyLlama-1.1B-Chat-v0.4-q0f32",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/TinyLlama-1.1B-Chat-v0.4/TinyLlama-1.1B-Chat-v0.4-q0f32-ctx2k-webgpu.wasm",vram_required_MB:5394.53,low_resource_required:!1},{model_url:"https://huggingface.co/mlc-ai/TinyLlama-1.1B-Chat-v0.4-q4f16_1-MLC/resolve/main/",local_id:"TinyLlama-1.1B-Chat-v0.4-q4f16_1-1k",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/TinyLlama-1.1B-Chat-v0.4/TinyLlama-1.1B-Chat-v0.4-q4f16_1-ctx1k-webgpu.wasm",vram_required_MB:899.11,low_resource_required:!0,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/TinyLlama-1.1B-Chat-v0.4-q4f32_1-MLC/resolve/main/",local_id:"TinyLlama-1.1B-Chat-v0.4-q4f32_1-1k",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/TinyLlama-1.1B-Chat-v0.4/TinyLlama-1.1B-Chat-v0.4-q4f32_1-ctx1k-webgpu.wasm",vram_required_MB:992.11,low_resource_required:!0}],use_web_worker:!0},pl=function(){function e(t){var n,r,i;return mo(this,e),(n=no(this,e,[t]))._isModelLoaded=!1,n._isModelLoading=!1,n._loadOnFirstMessage=!1,n._webModel={},n.permittedErrorPrefixes=[e.MULTIPLE_MODELS_ERROR,e.WEB_LLM_NOT_FOUND_ERROR,e.GENERIC_ERROR],n._conversationHistory=[],"object"==vo(t.webModel)&&(n._webModel=t.webModel),null!=(r=n._webModel.load)&&r.clearCache&&e.clearAllCache(),n.findModelInWindow(t),n.canSendMessage=n.canSubmit.bind(ro(n)),n._chatEl=null==(i=t.shadowRoot)?void 0:i.children[0],t.history&&e.setUpHistory(n._conversationHistory,t.history),n}return so(e,el),yo(e,[{key:"setUpMessages",value:function(e){var t=this;this._messages=e,this._removeIntro=function(){e.removeIntroductoryMessage(),t._removeIntro=void 0}}},{key:"findModelInWindow",value:function(t){var n,r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;window.webLLM?this.configureInit(this.shouldAddIntroMessage(t.introMessage)):i>e.MODULE_SEARCH_LIMIT_S?(null==(n=this._messages)||n.addNewErrorMessage("service",e.WEB_LLM_NOT_FOUND_ERROR),console.error("The deep-chat-web-llm module has not been attached to the window object. Please see the following guide:"),console.error("https://deepchat.dev/examples/externalModules")):setTimeout((function(){return r.findModelInWindow(t,i+1)}),1e3)}},{key:"shouldAddIntroMessage",value:function(e){var t;return!e&&this._webModel&&!1!==(null==(t=this._webModel.introMessage)?void 0:t.displayed)}},{key:"scrollToTop",value:function(e){var t,n=this;!1!==(null==(t=this._webModel.introMessage)?void 0:t.autoScroll)&&setTimeout((function(){var e,t;null!=(e=n._messages)&&e.elementRef&&Ho.scrollToTop(null==(t=n._messages)?void 0:t.elementRef)}),e)}},{key:"getIntroMessage",value:function(e){if(this.shouldAddIntroMessage(e)&&this._chatEl){var t=ul.setUpInitial(this.init.bind(this),this._webModel.introMessage,this._chatEl,!!this._webModel.worker);return this.scrollToTop(1),{role:$o.AI_ROLE,html:t,sendUpdate:!1}}}},{key:"configureInit",value:(u=uo(lo().mark((function e(t){var n;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this._webModel.load)){e.next=8;break}if(!n.onInit){e.next=5;break}return this.init(),e.abrupt("return");case 5:if(!n.onMessage){e.next=8;break}return this._loadOnFirstMessage=!0,e.abrupt("return");case 8:t||this.init();case 9:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"init",value:(c=uo(lo().mark((function e(t){var n,r;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(n=this._messages)||n.removeError(),r=this.attemptToCreateChat(),e.t0=r,!e.t0){e.next=6;break}return e.next=6,this.loadModel(r,t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"attemptToCreateChat",value:function(){var t;if(e.chat)return null==(t=this._messages)||t.addNewErrorMessage("service",e.MULTIPLE_MODELS_ERROR),void console.error(e.MULTIPLE_MODELS_ERROR);if(!this._isModelLoaded&&!this._isModelLoading){var n=this._webModel.worker;return dl.use_web_worker&&n?new window.webLLM.ChatWorkerClient(n):new window.webLLM.ChatModule}}},{key:"getConfig",value:function(){var t,n=e.DEFAULT_MODEL;this._webModel.model&&(n=this._webModel.model);var r=JSON.parse(JSON.stringify(dl));if(this._webModel.urls){var i=r.model_list.find((function(e){return e.local_id=n}));i&&(this._webModel.urls.model&&(i.model_url=this._webModel.urls.model),this._webModel.urls.wasm&&(i.model_lib_url=this._webModel.urls.wasm))}return null!=(t=this._webModel.load)&&t.skipCache&&(r.use_cache=!1),{model:n,appConfig:r}}},{key:"loadModel",value:(l=uo(lo().mark((function t(n,r){var i,o,s,a,l,c,u,d,p,h,f,v,m,g,y,b=this;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.scrollToTop(),e.chat=n,this._isModelLoading=!0,d=!1===(null==(i=this._webModel.introMessage)?void 0:i.displayed),p=function(e){var t;null==(t=b._messages)||t.addNewMessage({html:"<div>".concat(e.text,"</div>"),overwrite:!0,sendUpdate:!1}),d&&(setTimeout((function(){var e;return Ho.scrollToBottom(null==(e=b._messages)?void 0:e.elementRef)})),d=!1)},e.chat.setInitProgressCallback(p),t.prev=4,f=this.getConfig(),v=f.model,m=f.appConfig,g={},this._webModel.instruction&&(g.conv_config={system:this._webModel.instruction}),this._conversationHistory.length>0&&(g.conversation_history=this._conversationHistory),t.next=10,e.chat.reload(v,g,m,r);case 10:h=t.sent,t.next=16;break;case 13:return t.prev=13,t.t0=t.catch(4),t.abrupt("return",this.unloadChat(t.t0));case 16:null==(s=(o=this.deepChat)._validationHandler)||s.call(o),null!=(a=this._webModel.introMessage)&&a.removeAfterLoad?!1===this._webModel.introMessage.displayed?null==(c=this._messages)||c.removeLastMessage():null==(u=this._removeIntro)||u.call(this):(y=ul.setUpAfterLoad(h,this._webModel.introMessage,this._chatEl,!!this._webModel.worker),null==(l=this._messages)||l.addNewMessage({html:y,overwrite:!0,sendUpdate:!1})),this._isModelLoaded=!0,this._isModelLoading=!1;case 18:case"end":return t.stop()}}),t,this,[[4,13]])}))),function(e,t){return l.apply(this,arguments)})},{key:"unloadChat",value:(a=uo(lo().mark((function t(n){var r;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==(r=this._messages)||r.addNewErrorMessage("service",e.GENERIC_ERROR),console.error(n),this._isModelLoaded=!1,this._isModelLoading=!1,t.t0=e.chat,!t.t0){t.next=9;break}return t.next=8,e.chat.unload();case 8:e.chat=void 0;case 9:case"end":return t.stop()}}),t,this)}))),function(e){return a.apply(this,arguments)})},{key:"immediateResp",value:(s=uo(lo().mark((function t(n,r,i){var o,s;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.generate(r,void 0,0);case 2:return t.t0=t.sent,o={text:t.t0},t.next=6,e.processResponse(this.deepChat,n,o);case 6:(s=t.sent)&&n.addNewMessage(s),this.completionsHandlers.onFinish();case 8:case"end":return t.stop()}}),t,this)}))),function(e,t,n){return s.apply(this,arguments)})},{key:"streamResp",value:(o=uo(lo().mark((function t(n,r,i){var o,s=this;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.streamHandlers.abortStream.abort=function(){i.interruptGenerate()},this.streamHandlers.onOpen(),o=new Na(n),t.next=4,i.generate(r,function(){var t=uo(lo().mark((function t(r,i){var a;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.processResponse(s.deepChat,n,{text:i});case 2:(a=t.sent)&&o.upsertStreamedMessage({text:a.text,overwrite:!0});case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 4:o.finaliseStreamedMessage(),this.streamHandlers.onClose();case 6:case"end":return t.stop()}}),t,this)}))),function(e,t,n){return o.apply(this,arguments)})},{key:"generateRespByType",value:(i=uo(lo().mark((function e(t,n,r,i){var o;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!r){e.next=6;break}return e.next=4,this.streamResp(t,n,i);case 4:e.next=8;break;case 6:return e.next=8,this.immediateResp(t,n,i);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),null==(o=this._messages)||o.addNewErrorMessage("service"),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(e,t,n,r){return i.apply(this,arguments)})},{key:"generateResp",value:(r=uo(lo().mark((function e(t,n,r){var i,o,s,a,l,c,u;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n[n.length-1].text,e.next=3,Fa.processRequestInterceptor(this.deepChat,{body:{text:i}});case 3:o=e.sent,s=o.body,a=o.error,l=!!this.stream;try{a?(Fa.displayError(t,new Error(a)),(l?this.streamHandlers.onClose:this.completionsHandlers.onFinish)()):s&&s.text?this.generateRespByType(t,s.text,!!this.stream,r):(c=Bo.INVALID_MODEL_REQUEST({body:s},!1),console.error(c),u=l?this.streamHandlers.onClose:this.completionsHandlers.onFinish,Fa.onInterceptorError(t,c,u))}catch(e){this.unloadChat(e)}case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"callServiceAPI",value:(n=uo(lo().mark((function t(n,r){var i,o;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isModelLoaded){t.next=7;break}if(!this._loadOnFirstMessage){t.next=6;break}return t.next=4,this.init();case 4:t.next=7;break;case 6:return t.abrupt("return");case 7:!e.chat||this._isModelLoading||(null!=(i=this._webModel.introMessage)&&i.removeAfterMessage&&(null==(o=this._removeIntro)||o.call(this)),n.addLoadingMessage(),this.generateResp(n,r,e.chat));case 8:case"end":return t.stop()}}),t,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"canSubmit",value:function(e){return!(null==e||!e.trim()||this._isModelLoading)&&(!!this._loadOnFirstMessage||!!this._isModelLoaded)}},{key:"isWebModel",value:function(){return!0}}],[{key:"setUpHistory",value:function(e,t){t.forEach((function(n,r){if(n.role===$o.USER_ROLE&&n.text){var i=t[r+1];null!=i&&i.text&&i.role!==$o.USER_ROLE&&e.push([n.text,i.text])}}))}},{key:"processResponse",value:(t=uo(lo().mark((function e(t,n,r){var i,o,s;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(i=t.responseInterceptor)?void 0:i.call(t,r);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=r;case 5:if(!(o=e.t0).error){e.next=11;break}return Fa.displayError(n,new Error(o.error)),e.abrupt("return");case 11:if(o&&o.text){e.next=15;break}return s=Bo.INVALID_MODEL_RESPONSE(r,!!t.responseInterceptor,o),Fa.displayError(n,new Error(s)),e.abrupt("return");case 15:return e.abrupt("return",o);case 16:case"end":return e.stop()}}),e)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"clearAllCache",value:function(){e.clearCache("webllm/model"),e.clearCache("webllm/wasm")}},{key:"clearCache",value:function(e){caches.open(e).then((function(e){e.keys().then((function(t){t.forEach((function(t){e.delete(t)}))}))}))}}]);var t,n,r,i,o,s,a,l,c,u}();pl.GENERIC_ERROR="Error, please check the [troubleshooting](https://deepchat.dev/docs/webModel#troubleshooting) section of documentation for help.",pl.MULTIPLE_MODELS_ERROR="Cannot run multiple web models",pl.WEB_LLM_NOT_FOUND_ERROR="WebLLM module not found",pl.DEFAULT_MODEL="Llama-2-7b-chat-hf-q4f32_1",pl.MODULE_SEARCH_LIMIT_S=5;var hl=pl,fl=function(){function e(){mo(this,e)}return yo(e,null,[{key:"buildHeaders",value:function(e){return{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}},{key:"handleVerificationResult",value:function(e,t,n,r){var i=e;Array.isArray(i.error)&&"Error in `parameters`: field required"===i.error[0]?n(t):r(Bo.INVALID_KEY)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api-inference.huggingface.co/models/gpt2",method:"POST",handleVerificationResult:e.handleVerificationResult}}}])}(),vl=function(){function e(t,n,r,i,o,s){var a;return mo(this,e),(a=no(this,e,[t,fl.buildKeyVerificationDetails(),fl.buildHeaders,o,s])).insertKeyPlaceholderText="Hugging Face Token",a.keyHelpUrl="https://huggingface.co/settings/tokens",a.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Hugging Face</b></div>\n    <p>First message may take an extented amount of time to complete as the model needs to be initialized.</p>',a.permittedErrorPrefixes=["Authorization header"],a.url="".concat(e.URL_PREFIX).concat(r),a.textInputPlaceholderText=n,"object"==vo(i)&&(i.model&&(a.url="".concat(e.URL_PREFIX).concat(i.model)),i.options&&(a.rawBody.options=i.options),i.parameters&&(a.rawBody.parameters=i.parameters)),a}return so(e,tl),yo(e,[{key:"preprocessBody",value:function(e,t,n){var r,i=JSON.parse(JSON.stringify(e)),o=t[t.length-1].text;if(o)return null!==(r=i.options)&&void 0!==r||(i.options={}),i.options.wait_for_model=!0,ho({inputs:o},i)}},{key:"callServiceAPI",value:(t=uo(lo().mark((function e(t,n,r){var i;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:i=this.preprocessBody(this.rawBody,n,r),$a.request(this,i,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}]);var t}();vl.URL_PREFIX="https://api-inference.huggingface.co/models/";var ml=vl,gl=function(){function e(t,n,r,i,o,s){var a;return mo(this,e),(a=no(this,e,[t,n,r,i,o,s])).isTextInputDisabled=!0,a.canSendMessage=e.canSendFile,a}return so(e,ml),yo(e,[{key:"preprocessBody",value:function(e,t,n){return n[0]}},{key:"callServiceAPI",value:(t=uo(lo().mark((function e(t,n,r){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null!=r&&r[0]){e.next=4;break}throw new Error("No file was added");case 4:$a.poll(this,r[0],t,!1);case 5:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}],[{key:"canSendFile",value:function(e,t){return!(null==t||!t[0])}}]);var t}(),yl=function(){function e(t){var n,r,i;return mo(this,e),no(this,e,[t,"Attach an audio file","ehcalabres/wav2vec2-lg-xlsr-en-speech-emotion-recognition",null==(r=null==(n=t.directConnection)?void 0:n.huggingFace)?void 0:r.audioClassification,null==(i=t.directConnection)?void 0:i.huggingFace,{audio:{}}])}return so(e,gl),yo(e,[{key:"extractPollResultData",value:(t=uo(lo().mark((function e(t){var n;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.estimated_time){e.next=2;break}return e.abrupt("return",{timeoutMS:1e3*(t.estimated_time+1)});case 2:if(!t.error){e.next=4;break}throw t.error;case 4:return e.abrupt("return",{text:(null==(n=t[0])?void 0:n.label)||""});case 5:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t}(),bl=function(){function e(t){var n,r,i;return mo(this,e),no(this,e,[t,"Attach an image file","google/vit-base-patch16-224",null==(r=null==(n=t.directConnection)?void 0:n.huggingFace)?void 0:r.imageClassification,null==(i=t.directConnection)?void 0:i.huggingFace,{images:{}}])}return so(e,gl),yo(e,[{key:"extractPollResultData",value:(t=uo(lo().mark((function e(t){var n;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.estimated_time){e.next=2;break}return e.abrupt("return",{timeoutMS:1e3*(t.estimated_time+1)});case 2:if(!t.error){e.next=4;break}throw t.error;case 4:return e.abrupt("return",{text:(null==(n=t[0])?void 0:n.label)||""});case 5:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t}(),_l="data:image/png;base64,",kl=function(){function e(){mo(this,e)}return yo(e,null,[{key:"buildHeaders",value:function(e){return{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}},{key:"handleVerificationResult",value:function(e,t,n,r){e.message?r(Bo.INVALID_KEY):n(t)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.stability.ai/v1/engines/list",method:"GET",handleVerificationResult:e.handleVerificationResult}}}])}(),xl=function(){function e(t,n,r,i,o){var s;return mo(this,e),(s=no(this,e,[t,n,r,i,o])).insertKeyPlaceholderText="Stability AI API Key",s.keyHelpUrl="https://platform.stability.ai/docs/getting-started/authentication",s.permittedErrorPrefixes=["Incorrect","invalid_"],s}return so(e,tl),yo(e)}(),wl=function(){function e(t){var n,r;mo(this,e);var i=JSON.parse(JSON.stringify(t.directConnection)),o=null==i?void 0:i.stabilityAI;(n=no(this,e,[t,kl.buildKeyVerificationDetails(),kl.buildHeaders,o,{images:{files:{acceptedFormats:".png",maxNumberOfFiles:1}}}])).url="https://api.stability.ai/v1/generation/esrgan-v1-x2plus/image-to-image/upscale",n.textInputPlaceholderText="Describe image changes",n.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Stability AI</b></div>\n    <div style="width: 100%; text-align: center; margin-left: -10px; margin-top: 5px"><b>Image to Image Upscale</b></div>\n    <p>Upload an image to generate a new one with higher resolution.</p>\n    <p>Click <a href="https://platform.stability.ai/">here</a> for more info.</p>';var s=null==(r=null==i?void 0:i.stabilityAI)?void 0:r.imageToImageUpscale;return"object"==vo(s)&&(s.engine_id&&(n.url="https://api.stability.ai/v1/generation/".concat(s.engine_id,"/image-to-image/upscale")),e.cleanConfig(s),Object.assign(n.rawBody,s)),n.canSendMessage=e.canSendFileMessage,n}return so(e,xl),yo(e,[{key:"createFormDataBody",value:function(e,t){var n=new FormData;return n.append("image",t),Object.keys(e).forEach((function(t){n.append(t,String(e[t]))})),n}},{key:"callServiceAPI",value:(n=uo(lo().mark((function e(t,n,r){var i;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:if(r){e.next=4;break}throw new Error("Image was not found");case 4:i=this.createFormDataBody(this.rawBody,r[0]),Fa.tempRemoveContentHeader(this.connectSettings,$a.request.bind(this,this,i,t),!1);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.message){e.next=2;break}throw t.message;case 2:return e.abrupt("return",{files:t.artifacts.map((function(e){return{src:"".concat(_l).concat(e.base64),type:"image"}}))});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}],[{key:"cleanConfig",value:function(e){delete e.engine_id}},{key:"canSendFileMessage",value:function(e,t){return!(null==t||!t[0])}}]);var t,n}(),Sl=function(){function e(t){var n,r;mo(this,e);var i=JSON.parse(JSON.stringify(t.directConnection)),o=null==i?void 0:i.stabilityAI;(n=no(this,e,[t,kl.buildKeyVerificationDetails(),kl.buildHeaders,o,{images:{files:{acceptedFormats:".png",maxNumberOfFiles:2}}}])).url="https://api.stability.ai/v1/generation/stable-diffusion-xl-1024-v1-0/image-to-image/masking",n._maskSource="MASK_IMAGE_WHITE",n.textInputPlaceholderText="Describe image changes",n.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Stability AI</b></div>\n    <div style="width: 100%; text-align: center; margin-left: -10px; margin-top: 5px"><b>Image to Image Masking</b></div>\n    <p>Upload an image, its mask image to create a new one based on the changes you have described for the mask area.</p>\n    <p>Click <a href="https://platform.stability.ai/">here</a> for more info.</p>';var s=null==(r=null==i?void 0:i.stabilityAI)?void 0:r.imageToImageMasking;return"object"==vo(s)&&(s.engine_id&&(n.url="https://api.stability.ai/v1/generation/".concat(s.engine_id,"/image-to-image/masking")),void 0!==s.weight&&null!==s.weight&&(n._imageWeight=s.weight),void 0!==s.mask_source&&null!==s.mask_source&&(n._maskSource=s.mask_source),e.cleanConfig(s),Object.assign(n.rawBody,s)),n.canSendMessage=e.canSendFileTextMessage,n}return so(e,xl),yo(e,[{key:"createFormDataBody",value:function(e,t,n,r){var i=new FormData;return i.append("init_image",t),i.append("mask_source",String(this._maskSource)),i.append("mask_image",n),r&&""!==r&&i.append("text_prompts[0][text]",r),void 0!==this._imageWeight&&null!==this._imageWeight&&i.append("text_prompts[0][weight]",String(this._imageWeight)),Object.keys(e).forEach((function(t){i.append(t,String(e[t]))})),void 0===i.get("weight")&&i.append("weight",String(1)),i}},{key:"callServiceAPI",value:(n=uo(lo().mark((function e(t,n,r){var i,o,s,a;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:if(r&&r[0]&&r[1]){e.next=4;break}throw new Error("Image was not found");case 4:s=null==(o=null==(i=n[n.length-1])?void 0:i.text)?void 0:o.trim(),a=this.createFormDataBody(this.rawBody,r[0],r[1],s),Fa.tempRemoveContentHeader(this.connectSettings,$a.request.bind(this,this,a,t),!1);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.message){e.next=2;break}throw t.message;case 2:return e.abrupt("return",{files:t.artifacts.map((function(e){return{src:"".concat(_l).concat(e.base64),type:"image"}}))});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}],[{key:"cleanConfig",value:function(e){delete e.engine_id,delete e.weight}},{key:"canSendFileTextMessage",value:function(e,t){return!(null==t||!t[0]||!e||""===e.trim())}}]);var t,n}(),El=function(){function e(t){var n,r,i;return mo(this,e),no(this,e,[t,"Attach an audio file","facebook/wav2vec2-large-960h-lv60-self",null==(r=null==(n=t.directConnection)?void 0:n.huggingFace)?void 0:r.audioSpeechRecognition,null==(i=t.directConnection)?void 0:i.huggingFace,{audio:{}}])}return so(e,gl),yo(e,[{key:"extractPollResultData",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.estimated_time){e.next=2;break}return e.abrupt("return",{timeoutMS:1e3*(t.estimated_time+1)});case 2:if(!t.error){e.next=4;break}throw t.error;case 4:return e.abrupt("return",{text:t.text||""});case 5:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t}(),Cl=function(){function e(t){var n,r,i;return mo(this,e),no(this,e,[t,"Once upon a time","gpt2",null==(r=null==(n=t.directConnection)?void 0:n.huggingFace)?void 0:r.textGeneration,null==(i=t.directConnection)?void 0:i.huggingFace])}return so(e,ml),yo(e,[{key:"extractResultData",value:(t=uo(lo().mark((function e(t){var n;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:return e.abrupt("return",{text:(null==(n=t[0])?void 0:n.generated_text)||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t}(),Tl=function(){function e(t){var n,r,i,o;mo(this,e);var s=null==(i=null==(r=t.directConnection)?void 0:r.huggingFace)?void 0:i.questionAnswer;return(n=no(this,e,[t,"Ask a question","bert-large-uncased-whole-word-masking-finetuned-squad",s,null==(o=t.directConnection)?void 0:o.huggingFace])).permittedErrorPrefixes=["Authorization header","Error in"],n.context=s.context,n}return so(e,ml),yo(e,[{key:"preprocessBody",value:function(e,t){var n=t[t.length-1].text;if(n)return{inputs:{question:n,context:this.context,options:{wait_for_model:!0}}}}},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:return e.abrupt("return",{text:t.answer||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t}(),Al=function(){function e(t){var n,r,i;return mo(this,e),no(this,e,[t,"Insert text to summarize","facebook/bart-large-cnn",null==(r=null==(n=t.directConnection)?void 0:n.huggingFace)?void 0:r.summarization,null==(i=t.directConnection)?void 0:i.huggingFace])}return so(e,ml),yo(e,[{key:"extractResultData",value:(t=uo(lo().mark((function e(t){var n;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:return e.abrupt("return",{text:(null==(n=t[0])?void 0:n.summary_text)||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t}(),Ml=function(){function e(t){var n,r,i,o,s;return mo(this,e),null!==(n=(r=no(this,e,[t,"Ask me anything!","facebook/blenderbot-400M-distill",null==(o=null==(i=t.directConnection)?void 0:i.huggingFace)?void 0:o.conversation,null==(s=t.directConnection)?void 0:s.huggingFace])).maxMessages)&&void 0!==n||(r.maxMessages=-1),r}return so(e,ml),yo(e,[{key:"processMessages",value:function(e){var t=e.filter((function(e){return e.text})),n=t[t.length-1].text,r=t.slice(0,t.length-1);if(n)return{past_user_inputs:r.filter((function(e){return"user"===e.role})).map((function(e){return e.text})),generated_responses:r.filter((function(e){return"ai"===e.role})).map((function(e){return e.text})),mostRecentMessageText:n}}},{key:"preprocessBody",value:function(e,t){var n,r=JSON.parse(JSON.stringify(e)),i=this.processMessages(t);if(i)return null!==(n=r.options)&&void 0!==n||(r.options={}),r.options.wait_for_model=!0,ho({inputs:{past_user_inputs:i.past_user_inputs,generated_responses:i.generated_responses,text:i.mostRecentMessageText}},r)}},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:return e.abrupt("return",{text:t.generated_text||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t}(),Il=function(){function e(t){var n,r;mo(this,e);var i=JSON.parse(JSON.stringify(t.directConnection)),o=i.stabilityAI;(n=no(this,e,[t,kl.buildKeyVerificationDetails(),kl.buildHeaders,o,{images:{files:{acceptedFormats:".png",maxNumberOfFiles:1}}}])).url="https://api.stability.ai/v1/generation/stable-diffusion-v1-6/image-to-image",n.textInputPlaceholderText="Describe image changes",n.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Stability AI: Image to Image</b></div>\n    <p>Upload an image to create a new one with the changes you have described.</p>\n    <p>Click <a href="https://platform.stability.ai/">here</a> for more info.</p>';var s=null==(r=i.stabilityAI)?void 0:r.imageToImage;return"object"==vo(s)&&(s.engine_id&&(n.url="https://api.stability.ai/v1/generation/".concat(s.engine_id,"/text-to-image")),void 0!==s.weight&&null!==s.weight&&(n._imageWeight=s.weight),e.cleanConfig(s),Object.assign(n.rawBody,s)),n.canSendMessage=e.canSendFileTextMessage,n}return so(e,xl),yo(e,[{key:"createFormDataBody",value:function(e,t,n){var r=new FormData;return r.append("init_image",t),n&&""!==n&&r.append("text_prompts[0][text]",n),void 0!==this._imageWeight&&null!==this._imageWeight&&r.append("text_prompts[0][weight]",String(this._imageWeight)),Object.keys(e).forEach((function(t){r.append(t,String(e[t]))})),void 0===r.get("weight")&&r.append("weight",String(1)),r}},{key:"callServiceAPI",value:(n=uo(lo().mark((function e(t,n,r){var i,o,s,a;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:if(r){e.next=4;break}throw new Error("Image was not found");case 4:s=null==(o=null==(i=n[n.length-1])?void 0:i.text)?void 0:o.trim(),a=this.createFormDataBody(this.rawBody,r[0],s),Fa.tempRemoveContentHeader(this.connectSettings,$a.request.bind(this,this,a,t),!1);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.message){e.next=2;break}throw t.message;case 2:return e.abrupt("return",{files:t.artifacts.map((function(e){return{src:"".concat(_l).concat(e.base64),type:"image"}}))});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}],[{key:"cleanConfig",value:function(e){delete e.engine_id,delete e.weight}},{key:"canSendFileTextMessage",value:function(e,t){return!(null==t||!t[0]||!e||""===e.trim())}}]);var t,n}(),Ll=function(){function e(t){var n,r,i;return mo(this,e),no(this,e,[t,"Insert text to translate","Helsinki-NLP/opus-tatoeba-en-ja",null==(r=null==(n=t.directConnection)?void 0:n.huggingFace)?void 0:r.translation,null==(i=t.directConnection)?void 0:i.huggingFace])}return so(e,ml),yo(e,[{key:"extractResultData",value:(t=uo(lo().mark((function e(t){var n;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:return e.abrupt("return",{text:(null==(n=t[0])?void 0:n.translation_text)||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t}(),Ol=function(){function e(t){var n,r;mo(this,e);var i=JSON.parse(JSON.stringify(t.directConnection)),o=i.stabilityAI;(n=no(this,e,[t,kl.buildKeyVerificationDetails(),kl.buildHeaders,o])).url="https://api.stability.ai/v1/generation/stable-diffusion-v1-6/text-to-image",n.textInputPlaceholderText="Describe an image",n.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Stability AI: Text to Image</b></div>\n    <p>Insert text to generate an image.</p>\n    <p>Click <a href="https://platform.stability.ai/">here</a> for more info.</p>';var s=null==(r=i.stabilityAI)?void 0:r.textToImage;return"object"==vo(s)&&(s.engine_id&&(n.url="https://api.stability.ai/v1/generation/".concat(s.engine_id,"/text-to-image")),void 0!==s.weight&&null!==s.weight&&(n._imageWeight=s.weight),e.cleanConfig(s),Object.assign(n.rawBody,s)),n.canSendMessage=e.canSendTextMessage,n}return so(e,xl),yo(e,[{key:"preprocessBody",value:function(e,t){var n=JSON.parse(JSON.stringify(e)),r={text:t};return this._imageWeight&&(r.weight=this._imageWeight),n.text_prompts=[r],n}},{key:"callServiceAPI",value:(n=uo(lo().mark((function e(t,n){var r;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:r=this.preprocessBody(this.rawBody,n[n.length-1].text),$a.request(this,r,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.message){e.next=2;break}throw t.message;case 2:return e.abrupt("return",{files:t.artifacts.map((function(e){return{src:"".concat(_l).concat(e.base64),type:"image"}}))});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}],[{key:"cleanConfig",value:function(e){delete e.engine_id,delete e.weight}},{key:"canSendTextMessage",value:function(e){return!(!e||""===e.trim())}}]);var t,n}(),Rl=function(){function e(t){var n,r,i,o;return mo(this,e),(n=no(this,e,[t,"The goal of life is [MASK].","bert-base-uncased",null==(i=null==(r=t.directConnection)?void 0:r.huggingFace)?void 0:i.fillMask,null==(o=t.directConnection)?void 0:o.huggingFace])).introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Hugging Face</b></div>\n    <p>Insert a sentence with the word [MASK] and the model will try to fill it for you. E.g. I want [MASK].</p>\n    <p>First message may take an extented amount of time to complete as the model needs to be initialized.</p>',n.permittedErrorPrefixes=["Authorization header","No mask_token"],n}return so(e,ml),yo(e,[{key:"extractResultData",value:(t=uo(lo().mark((function e(t){var n;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:return e.abrupt("return",{text:(null==(n=t[0])?void 0:n.sequence)||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t}(),Pl=function(){function e(){mo(this,e)}return yo(e,null,[{key:"buildHeaders",value:function(e){return{Authorization:"Bearer ".concat(e),"Content-Type":"application/json",accept:"application/json"}}},{key:"handleVerificationResult",value:function(e,t,n,r){var i;null!=(i=e.message)&&i.includes("invalid request: prompt must be at least 1 token long")?n(t):r(Bo.INVALID_KEY)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.cohere.ai/v1/generate",method:"POST",handleVerificationResult:e.handleVerificationResult,body:JSON.stringify({prompt:""})}}}])}(),Nl=function(){function e(t,n,r,i,o){var s;return mo(this,e),(s=no(this,e,[t,Pl.buildKeyVerificationDetails(),Pl.buildHeaders,o])).insertKeyPlaceholderText="Cohere API Key",s.keyHelpUrl="https://dashboard.cohere.ai/api-keys",s.permittedErrorPrefixes=["invalid"],s.url=n,s.textInputPlaceholderText=r,i&&"object"==vo(i)&&Object.assign(s.rawBody,i),s}return so(e,tl),yo(e)}(),Dl=function(){function e(t){var n,r,i;return mo(this,e),no(this,e,[t,"https://api.cohere.ai/v1/generate","Once upon a time",null==(r=null==(n=t.directConnection)?void 0:n.cohere)?void 0:r.textGeneration,null==(i=t.directConnection)?void 0:i.cohere])}return so(e,Nl),yo(e,[{key:"preprocessBody",value:function(e,t){var n=JSON.parse(JSON.stringify(e)),r=t[t.length-1].text;if(r)return ho({prompt:r},n)}},{key:"callServiceAPI",value:(n=uo(lo().mark((function e(t,n){var r;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:r=this.preprocessBody(this.rawBody,n),$a.request(this,r,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){var n;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.message){e.next=2;break}throw t.message;case 2:return e.abrupt("return",{text:(null==(n=t.generations)?void 0:n[0].text)||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t,n}(),Fl=function(){function e(t){var n,r,i;return mo(this,e),no(this,e,[t,"https://api.cohere.ai/v1/summarize","Insert text to summarize",null==(r=null==(n=t.directConnection)?void 0:n.cohere)?void 0:r.summarization,null==(i=t.directConnection)?void 0:i.cohere])}return so(e,Nl),yo(e,[{key:"preprocessBody",value:function(e,t){var n=JSON.parse(JSON.stringify(e)),r=t[t.length-1].text;if(r)return ho({text:r},n)}},{key:"callServiceAPI",value:(n=uo(lo().mark((function e(t,n){var r;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:r=this.preprocessBody(this.rawBody,n),$a.request(this,r,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.message){e.next=2;break}throw t.message;case 2:return e.abrupt("return",{text:t.summary||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t,n}(),jl=function(){function e(){mo(this,e)}return yo(e,null,[{key:"buildHeaders",value:function(e){return{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}},{key:"handleVerificationResult",value:function(e,t,n,r){var i=e;i.error?"invalid_api_key"===i.error.code?r(Bo.INVALID_KEY):r(Bo.CONNECTION_FAILED):n(t)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.openai.com/v1/models",method:"GET",handleVerificationResult:e.handleVerificationResult}}},{key:"directFetch",value:(t=uo(lo().mark((function e(t,n,r){var i,o,s=arguments;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=!(s.length>3&&void 0!==s[3])||s[3],t.connectSettings.method=r,e.next=4,Fa.fetch(t,t.connectSettings.headers,i,n).then((function(e){return Fa.processResponseByType(e)}));case 4:if(!(o=e.sent).error){e.next=7;break}throw o.error.message;case 7:return e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)}))),function(e,n,r){return t.apply(this,arguments)})}]);var t}(),Bl=function(){function e(t){var n,r,i,o,s,a;mo(this,e);var l=JSON.parse(JSON.stringify(t.directConnection)),c=null==l?void 0:l.openAI;(i=no(this,e,[t,jl.buildKeyVerificationDetails(),jl.buildHeaders,c])).insertKeyPlaceholderText="OpenAI API Key",i.keyHelpUrl="https://platform.openai.com/account/api-keys",i.url="https://api.openai.com/v1/audio/speech",i.permittedErrorPrefixes=["Invalid"],i.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>OpenAI : Text To Speech</b></div>\n    <p>Generate an audio file based on your text input.</p>\n    <p>Click <a href="https://platform.openai.com/docs/guides/text-to-speech">here</a> for more information.</p>';var u=null==(o=null==l?void 0:l.openAI)?void 0:o.textToSpeech;return"object"==vo(u)&&Object.assign(i.rawBody,u),null!==(n=(s=i.rawBody).model)&&void 0!==n||(s.model=e.DEFAULT_MODEL),null!==(r=(a=i.rawBody).voice)&&void 0!==r||(a.voice=e.DEFAULT_VOIDE),i.textInputPlaceholderText="Insert text to generate audio",i.rawBody.response_format="mp3",i}return so(e,tl),yo(e,[{key:"preprocessBody",value:function(e,t){var n,r,i=JSON.parse(JSON.stringify(e)),o=null==(r=null==(n=t[t.length-1])?void 0:n.text)?void 0:r.trim();return o&&""!==o&&(i.input=o),i}},{key:"callServiceAPI",value:(n=uo(lo().mark((function e(t,n){var r,i;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(r=this.connectSettings)&&r.headers){e.next=2;break}throw new Error("Request settings have not been set up");case 2:this.url=this.connectSettings.url||this.url,i=this.preprocessBody(this.rawBody,n),$a.request(this,i,t);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t instanceof Blob)){e.next=2;break}return e.abrupt("return",new Promise((function(e){var n=new FileReader;n.readAsDataURL(t),n.onload=function(t){e({files:[{src:t.target.result,type:"audio"}]})}})));case 2:if(!t.error){e.next=4;break}throw t.error.message;case 4:return e.abrupt("return",{error:"error"});case 5:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t,n}();Bl.DEFAULT_MODEL="tts-1",Bl.DEFAULT_VOIDE="alloy";var Ul=Bl,Hl=function(){function e(t){var n,r,i,o;mo(this,e);var s=JSON.parse(JSON.stringify(t.directConnection)),a=null==s?void 0:s.openAI;(r=no(this,e,[t,jl.buildKeyVerificationDetails(),jl.buildHeaders,a,{audio:{}}])).insertKeyPlaceholderText="OpenAI API Key",r.keyHelpUrl="https://platform.openai.com/account/api-keys",r.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>OpenAI : Speech To Text</b></div>\n    <p><b>Upload an audio file</b> to transcribe it into text. You can optionally provide text to guide the audio\n      processing.\n    <p>Click <a href="https://platform.openai.com/docs/guides/speech-to-text">here</a> for more info.</p>',r.url="",r.permittedErrorPrefixes=["Invalid"],r.textInputPlaceholderText="Upload an audio file",r._service_url=e.AUDIO_TRANSCRIPTIONS_URL;var l=null==(i=null==s?void 0:s.openAI)?void 0:i.audio;return"object"==vo(l)&&(r.processConfig(l),e.cleanConfig(l),Object.assign(r.rawBody,l)),null!==(n=(o=r.rawBody).model)&&void 0!==n||(o.model=e.DEFAULT_MODEL),r.rawBody.response_format="json",r.canSendMessage=e.canSendFileMessage,r}return so(e,tl),yo(e,[{key:"processConfig",value:function(t){null!=t&&t.type&&"translation"===t.type&&(this._service_url=e.AUDIO_TRANSLATIONS_URL,delete t.language)}},{key:"preprocessBody",value:function(e,t){var n,r,i=JSON.parse(JSON.stringify(e)),o=null==(r=null==(n=t[t.length-1])?void 0:n.text)?void 0:r.trim();return o&&""!==o&&(i.prompt=o),i}},{key:"callServiceAPI",value:(n=uo(lo().mark((function t(n,r,i){var o,s,a;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(o=this.connectSettings)&&o.headers){t.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null!=i&&i[0]){t.next=4;break}throw new Error("No file was added");case 4:this.url=this.connectSettings.url||this._service_url,s=this.preprocessBody(this.rawBody,r),a=e.createFormDataBody(s,i[0]),Fa.tempRemoveContentHeader(this.connectSettings,$a.request.bind(this,this,a,n),!1);case 7:case"end":return t.stop()}}),t,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error.message;case 2:return e.abrupt("return",{text:t.text});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}],[{key:"canSendFileMessage",value:function(e,t){return!(null==t||!t[0])}},{key:"cleanConfig",value:function(e){delete e.type}},{key:"createFormDataBody",value:function(e,t){var n=new FormData;return n.append("file",t),Object.keys(e).forEach((function(t){n.append(t,String(e[t]))})),n}}]);var t,n}();Hl.AUDIO_TRANSCRIPTIONS_URL="https://api.openai.com/v1/audio/transcriptions",Hl.AUDIO_TRANSLATIONS_URL="https://api.openai.com/v1/audio/translations",Hl.DEFAULT_MODEL="whisper-1";var ql=Hl,Vl=function(){function e(){mo(this,e)}return yo(e,null,[{key:"buildTextToSpeechHeaders",value:function(e,t){return{"Ocp-Apim-Subscription-Key":t,"Content-Type":"application/ssml+xml","X-Microsoft-OutputFormat":e}}},{key:"buildSpeechToTextHeaders",value:function(e){return{"Ocp-Apim-Subscription-Key":e,Accept:"application/json"}}},{key:"handleSpeechVerificationResult",value:function(e,t,n,r){e.error?r(Bo.INVALID_KEY):n(t)}},{key:"buildSpeechKeyVerificationDetails",value:function(t){return{url:"https://".concat(t,".api.cognitive.microsoft.com/sts/v1.0/issuetoken"),method:"POST",createHeaders:function(e){return{"Ocp-Apim-Subscription-Key":"".concat(e)}},handleVerificationResult:e.handleSpeechVerificationResult}}},{key:"buildSummarizationHeader",value:function(e){return{"Ocp-Apim-Subscription-Key":e,"Content-Type":"application/json"}}},{key:"handleLanguageVerificationResult",value:function(e,t,n,r){var i;"401"===(null==(i=e.error)?void 0:i.code)?r(Bo.INVALID_KEY):n(t)}},{key:"buildLanguageKeyVerificationDetails",value:function(t){return{url:"".concat(t,"/language/analyze-text/jobs?api-version=2022-10-01-preview"),method:"POST",createHeaders:function(e){return{"Ocp-Apim-Subscription-Key":"".concat(e)}},handleVerificationResult:e.handleLanguageVerificationResult}}},{key:"handleTranslationVerificationResult",value:function(e,t,n,r){e.json().then((function(e){Array.isArray(e)||401e3!==e.error.code?n(t):r(Bo.INVALID_KEY)}))}},{key:"buildTranslationKeyVerificationDetails",value:function(t){return{url:"https://api.cognitive.microsofttranslator.com/translate?api-version=3.0&to=es",method:"POST",createHeaders:function(n){return e.buildTranslationHeaders(t,n)},handleVerificationResult:e.handleTranslationVerificationResult}}},{key:"buildTranslationHeaders",value:function(e,t){var n={"Ocp-Apim-Subscription-Key":t,"Content-Type":"application/json"};return e&&(n["Ocp-Apim-Subscription-Region"]=e),n}}])}(),zl=function(){function e(t,n,r,i,o){var s;return mo(this,e),(s=no(this,e,[t,Vl.buildLanguageKeyVerificationDetails(r),n,i,o])).insertKeyPlaceholderText="Azure Language Subscription Key",s.keyHelpUrl="https://learn.microsoft.com/en-us/azure/api-management/api-management-subscriptions#create-and-manage-subscriptions-in-azure-portal",s.permittedErrorPrefixes=["Access"],s}return so(e,tl),yo(e)}(),Gl=function(){function e(t){var n,r,i,o,s,a;mo(this,e);var l=null==(o=null==(i=t.directConnection)?void 0:i.azure)?void 0:o.summarization,c=null==(s=t.directConnection)?void 0:s.azure;return(r=no(this,e,[t,Vl.buildSummarizationHeader,l.endpoint,c])).url="",r.textInputPlaceholderText="Insert text to summarize",null!==(n=(a=r.rawBody).language)&&void 0!==n||(a.language="en"),Object.assign(r.rawBody,l),r.url="".concat(l.endpoint,"/language/analyze-text/jobs?api-version=2022-10-01-preview"),r}return so(e,zl),yo(e,[{key:"preprocessBody",value:function(e,t){var n=t[t.length-1].text;if(n)return{analysisInput:{documents:[{id:"1",language:e.language,text:n}]},tasks:[{kind:"ExtractiveSummarization"}]}}},{key:"callServiceAPI",value:(r=uo(lo().mark((function e(t,n){var r;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:r=this.preprocessBody(this.rawBody,n),$a.request(this,r,t),this.messages=t;case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"extractResultData",value:(n=uo(lo().mark((function e(t){var n,r,i;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error.message;case 2:return this.messages&&this.completionsHandlers&&(r=t.headers.get("operation-location"),i={method:"GET",headers:null==(n=this.connectSettings)?void 0:n.headers},$a.executePollRequest(this,r,i,this.messages)),e.abrupt("return",{makingAnotherRequest:!0});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"extractPollResultData",value:(t=uo(lo().mark((function e(t){var n,r,i,o;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:if("running"!==t.status){e.next=4;break}return e.abrupt("return",{timeoutMS:2e3});case 4:if(!(t.errors.length>0)){e.next=6;break}throw t.errors[0];case 6:if(!(t.tasks.items[0].results.errors.length>0)){e.next=8;break}throw t.tasks.items[0].results.errors[0];case 8:n="",r=Zi(t.tasks.items[0].results.documents[0].sentences);try{for(r.s();!(i=r.n()).done;)o=i.value,n+=o.text}catch(e){r.e(e)}finally{r.f()}return e.abrupt("return",{text:n||""});case 12:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t,n,r}(),Wl=function(){function e(){mo(this,e)}return yo(e,null,[{key:"poll",value:(t=uo(lo().mark((function e(t,n){var r,i,o,s;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={authorization:t,"content-type":"application/json"},e.t0="https://api.assemblyai.com/v2/transcript/",e.next=4,fetch("https://api.assemblyai.com/v2/transcript",{method:"POST",body:JSON.stringify({audio_url:n}),headers:r});case 4:return e.next=6,e.sent.json();case 6:e.t1=e.sent.id,i=e.t0.concat.call(e.t0,e.t1);case 8:if(o){e.next=24;break}return e.next=11,fetch(i,{headers:r});case 11:return e.next=13,e.sent.json();case 13:if("completed"!==(s=e.sent).status){e.next=18;break}o=s,e.next=22;break;case 18:if("error"!==s.status){e.next=20;break}throw new Error("Transcription failed: ".concat(s.error));case 20:return e.next=22,new Promise((function(e){return setTimeout(e,3e3)}));case 22:e.next=8;break;case 24:return e.abrupt("return",o);case 25:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},{key:"buildHeaders",value:function(e){return{Authorization:e,"Content-Type":"application/octet-stream"}}},{key:"handleVerificationResult",value:function(e,t,n,r){var i=e;i.error?"invalid_api_key"===i.error.code?r(Bo.INVALID_KEY):r(Bo.CONNECTION_FAILED):n(t)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.assemblyai.com/v2/upload",method:"POST",handleVerificationResult:e.handleVerificationResult}}}]);var t}(),Kl=function(){function e(t){var n,r;mo(this,e);var i=null==(r=t.directConnection)?void 0:r.assemblyAI;return(n=no(this,e,[t,Wl.buildKeyVerificationDetails(),Wl.buildHeaders,i,{audio:{}}])).insertKeyPlaceholderText="AssemblyAI API Key",n.keyHelpUrl="https://www.assemblyai.com/app/account",n.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>AssemblyAI Audio</b></div>\n    <p><b>Upload an audio file</b> to transcribe it into text.\n    <p>\n      Click <a href="https://www.assemblyai.com/docs/Guides/transcribing_an_audio_file#get-started">here</a> for more info.\n    </p>',n.url="https://api.assemblyai.com/v2/upload",n.isTextInputDisabled=!0,n.textInputPlaceholderText="Upload an audio file",n.permittedErrorPrefixes=["Authentication","Invalid"],n.canSendMessage=e.canFileSendMessage,n}return so(e,tl),yo(e,[{key:"callServiceAPI",value:(n=uo(lo().mark((function e(t,n,r){var i;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(i=this.connectSettings)&&i.headers){e.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null!=r&&r[0]){e.next=4;break}throw new Error("No file was added");case 4:$a.request(this,r[0],t,!1);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){var n,r,i;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:return i=null==(r=null==(n=this.connectSettings)?void 0:n.headers)?void 0:r.Authorization,e.next=5,Wl.poll(i,t.upload_url);case 5:return e.t0=e.sent.text,e.abrupt("return",{text:e.t0});case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}],[{key:"canFileSendMessage",value:function(e,t){return!(null==t||!t[0])}}]);var t,n}(),Jl=function(){function e(t,n,r,i,o){var s;return mo(this,e),(s=no(this,e,[t,Vl.buildSpeechKeyVerificationDetails(r),n,i,o])).insertKeyPlaceholderText="Azure Speech Subscription Key",s.keyHelpUrl="https://learn.microsoft.com/en-us/azure/api-management/api-management-subscriptions#create-and-manage-subscriptions-in-azure-portal",s}return so(e,tl),yo(e)}(),Xl=function(){function e(t){var n,r,i,o,s,a,l,c,u,d;mo(this,e);var p=null==(a=null==(s=t.directConnection)?void 0:s.azure)?void 0:a.textToSpeech,h=null==(l=t.directConnection)?void 0:l.azure;return(o=no(this,e,[t,Vl.buildTextToSpeechHeaders.bind({},(null==p?void 0:p.outputFormat)||"audio-16khz-128kbitrate-mono-mp3"),p.region,h])).introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Azure Text To Speech</b></div>\n    <p>Insert text to synthesize it to audio.\n    <p>\n      Click <a href="'.concat(e.HELP_LINK,'">here</a> for more info.\n    </p>'),o.url="",Object.assign(o.rawBody,p),null!==(n=(c=o.rawBody).lang)&&void 0!==n||(c.lang="en-US"),null!==(r=(u=o.rawBody).name)&&void 0!==r||(u.name="en-US-JennyNeural"),null!==(i=(d=o.rawBody).gender)&&void 0!==i||(d.gender="Female"),o.url="https://".concat(p.region,".tts.speech.microsoft.com/cognitiveservices/v1"),o}return so(e,Jl),yo(e,[{key:"preprocessBody",value:function(e,t){var n=t[t.length-1].text;if(n)return"<speak version='1.0' xml:lang='".concat(e.lang,"'>\n      <voice xml:lang='").concat(e.lang,"' xml:gender='").concat(e.gender,"' name='").concat(e.name,"'>\n        ").concat(n,"\n      </voice>\n    </speak>")}},{key:"callServiceAPI",value:(n=uo(lo().mark((function e(t,n){var r;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:r=this.preprocessBody(this.rawBody,n),$a.request(this,r,t,!1);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=new FileReader;n.readAsDataURL(t),n.onload=function(t){e({files:[{src:t.target.result,type:"audio"}]})}})));case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t,n}();Xl.HELP_LINK="https://learn.microsoft.com/en-GB/azure/cognitive-services/speech-service/get-started-text-to-speech?tabs=windows%2Cterminal&pivots=programming-language-rest";var Yl=Xl,$l=function(){function e(t){var n,r,i,o;mo(this,e);var s=null==(i=null==(r=t.directConnection)?void 0:r.azure)?void 0:i.speechToText,a=null==(o=t.directConnection)?void 0:o.azure;(n=no(this,e,[t,Vl.buildSpeechToTextHeaders,s.region,a,{audio:{files:{acceptedFormats:".wav,.ogg"}}}])).introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Azure Speech To Text</b></div>\n    <p><b>Upload a .wav or .ogg audio file</b> to transcribe it into text.\n    <p>\n      Click <a href="'.concat(e.HELP_LINK,'">here</a> for more info.\n    </p>'),n.url="",n.isTextInputDisabled=!0,n.textInputPlaceholderText="Upload an audio file",n.canSendMessage=e.canFileSendMessage;var l=s.lang||"en-US";return n.url="https://".concat(s.region,".stt.speech.microsoft.com/speech/recognition/conversation/cognitiveservices/v1?language=").concat(l,"&format=detailed"),n.recordAudio=void 0,n}return so(e,Jl),yo(e,[{key:"callServiceAPI",value:(n=uo(lo().mark((function e(t,n,r){var i,o;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(i=this.connectSettings)&&i.headers){e.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null!=r&&r[0]){e.next=4;break}throw new Error("No file was added");case 4:null!=(o=this.connectSettings)&&o.headers&&(this.connectSettings.headers["Content-Type"]=r[0].name.toLocaleLowerCase().endsWith(".wav")?"audio/wav; codecs=audio/pcm; samplerate=16000":"audio/ogg; codecs=opus"),$a.request(this,r[0],t,!1);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:return e.abrupt("return",{text:t.DisplayText||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}],[{key:"canFileSendMessage",value:function(e,t){return!(null==t||!t[0])}}]);var t,n}();$l.HELP_LINK="https://learn.microsoft.com/en-GB/azure/cognitive-services/speech-service/get-started-text-to-speech?tabs=windows%2Cterminal&pivots=programming-language-rest";var Zl=$l,Ql=function(){function e(t){var n,r,i,o;mo(this,e);var s=null==(i=null==(r=t.directConnection)?void 0:r.azure)?void 0:i.translation,a=null==(o=t.directConnection)?void 0:o.azure;return(n=no(this,e,[t,Vl.buildTranslationKeyVerificationDetails(s.region),Vl.buildTranslationHeaders.bind({},null==s?void 0:s.region),a])).insertKeyPlaceholderText="Azure Translate Subscription Key",n.keyHelpUrl="https://learn.microsoft.com/en-us/azure/api-management/api-management-subscriptions#create-and-manage-subscriptions-in-azure-portal",n.url="",n.url="https://api.cognitive.microsofttranslator.com/translate?api-version=3.0&to=".concat(s.language||"es"),n}return so(e,tl),yo(e,[{key:"preprocessBody",value:function(e){var t=e[e.length-1].text;if(t)return[{Text:t}]}},{key:"callServiceAPI",value:(n=uo(lo().mark((function e(t,n){var r;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:r=this.preprocessBody(n),$a.request(this,r,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){var n;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Array.isArray(t)){e.next=2;break}return e.abrupt("return",{text:(null==(n=t[0].translations)?void 0:n[0].text)||""});case 2:throw t.error;case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t,n}(),ec=function(){function e(){mo(this,e)}return yo(e,null,[{key:"storeFiles",value:(s=uo(lo().mark((function e(t,n,r){var i,o,s,a;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.connectSettings.headers){e.next=3;break}return e.abrupt("return");case 3:return t.url="https://api.openai.com/v1/files",o=i[Fa.CONTENT_TYPE],delete i[Fa.CONTENT_TYPE],s=r.map(function(){var e=uo(lo().mark((function e(n){var r;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new FormData,e.abrupt("return",(r.append("purpose","assistants"),r.append("file",n),new Promise((function(e){e(jl.directFetch(t,r,"POST",!1))}))));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.prev=7,e.next=10,Promise.all(s);case 10:return a=e.sent.map((function(e){return{id:e.id,name:e.filename}})),e.abrupt("return",(i[Fa.CONTENT_TYPE]=o,a));case 14:throw e.prev=14,e.t0=e.catch(7),i[Fa.CONTENT_TYPE]=o,Fa.displayError(n,e.t0),t.completionsHandlers.onFinish(),e.t0;case 17:case"end":return e.stop()}}),e,null,[[7,14]])}))),function(e,t,n){return s.apply(this,arguments)})},{key:"getType",value:function(e,t){var n=e[t].path;return!n||n.endsWith("png")?"image":"any"}},{key:"getFiles",value:(o=uo(lo().mark((function t(n,r){var i,o;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=r.map((function(e){var t=e.fileId;return n.url="https://api.openai.com/v1/files/".concat(t,"/content"),new Promise((function(e){e(jl.directFetch(n,void 0,"GET",!1))}))})),t.next=3,Promise.all(i);case 3:return o=t.sent.map((function(t,n){return new Promise((function(i){var o=new FileReader;o.readAsDataURL(t),o.onload=function(t){i({src:t.target.result,name:r[n].name,type:e.getType(r,n)})}}))})),t.next=6,Promise.all(o);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)}))),function(e,t){return o.apply(this,arguments)})},{key:"getFileName",value:function(e){var t=e.split("/");return t[t.length-1]}},{key:"getFilesAndNewText",value:(i=uo(lo().mark((function t(n,r,i,o){var s,a,l;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=r.length>0,!t.t0){t.next=6;break}return t.next=4,e.getFiles(n,r);case 4:l=t.sent,null!=(s=null==o?void 0:o.text)&&s.value&&l.forEach((function(e,t){var n;if(e.src){var i=r[t].path;null!=(n=null==o?void 0:o.text)&&n.value&&i&&(o.text.value=o.text.value.replace(i,e.src))}}));case 6:return t.abrupt("return",null!=(a=null==o?void 0:o.text)&&a.value?{text:o.text.value,role:i}:{files:l,role:i});case 7:case"end":return t.stop()}}),t)}))),function(e,t,n,r){return i.apply(this,arguments)})},{key:"getFileDetails",value:function(t,n){var r,i=[];return null!=(r=null==n?void 0:n.text)&&r.value&&t.content.forEach((function(t){var n,r;null==(r=null==(n=t.text)?void 0:n.annotations)||r.forEach((function(t){var n;t.text&&t.text.startsWith("sandbox:")&&null!=(n=t.file_path)&&n.file_id&&i.push({path:t.text,fileId:t.file_path.file_id,name:e.getFileName(t.text)})}))})),null!=n&&n.image_file&&i.push({fileId:n.image_file.file_id}),i}},{key:"getFilesAndText",value:(r=uo(lo().mark((function t(n,r,i){var o;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.getFileDetails(r,i),t.next=3,e.getFilesAndNewText(n,o,r.role,i);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"parseResult",value:function(e,t){var n=[];if(t)n=e.data;else for(var r=0;r<e.data.length;r+=1){var i=e.data[r];if("assistant"!==i.role)break;n.push(i)}return n.reverse()}},{key:"parseMessages",value:function(t,n){var r=[];return n.forEach(function(){var n=uo(lo().mark((function n(i){return lo().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i.content.filter((function(e){return!!e.text||!!e.image_file})).sort((function(e){return e.text?-1:e.image_file?1:0})).forEach(function(){var n=uo(lo().mark((function n(o){return lo().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r.push(e.getFilesAndText(t,i,o));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),Promise.all(r)}},{key:"processStreamMessages",value:(n=uo(lo().mark((function t(n,r){return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.parseMessages(n,[{content:r,role:"assistant"}]));case 1:case"end":return t.stop()}}),t)}))),function(e,t){return n.apply(this,arguments)})},{key:"processAPIMessages",value:(t=uo(lo().mark((function t(n,r,i){var o;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.parseResult(r,i),t.abrupt("return",e.parseMessages(n,o));case 2:case"end":return t.stop()}}),t)}))),function(e,n,r){return t.apply(this,arguments)})}]);var t,n,r,i,o,s}();ec.FILES_WITH_TEXT_ERROR="content with type `text` must have `text` values",ec.FUNCTION_TOOL_RESP_ERROR="Response must contain an array of strings for each individual function/tool_call, see https://deepchat.dev/docs/directConnection/OpenAI/#assistant-functions.";var tc=ec,nc=function(){function e(t){var n,r,i,o,s,a,l,c,u;mo(this,e);var d=JSON.parse(JSON.stringify(t.directConnection)),p=d.openAI;(i=no(this,e,[t,jl.buildKeyVerificationDetails(),jl.buildHeaders,p])).insertKeyPlaceholderText="OpenAI API Key",i.keyHelpUrl="https://platform.openai.com/account/api-keys",i.url="",i.permittedErrorPrefixes=["Incorrect","Please send text"],i.searchedForThreadId=!1,i.config={},i.newAssistantDetails={model:"gpt-4"},i.shouldFetchHistory=!1,i.waitingForStreamResponse=!1,i.isSSEStream=!1;var h=null==(o=d.openAI)?void 0:o.assistant;if("object"==vo(h)){i.config=h;var f=i.config,v=f.new_assistant,m=f.thread_id,g=f.load_thread_history;Object.assign(i.newAssistantDetails,v),m&&(i.sessionId=m),g&&(i.shouldFetchHistory=!0);var y=(null==(a=null==(s=t.directConnection)?void 0:s.openAI)?void 0:a.assistant).function_handler;y&&(i._functionHandler=y),i.filesToolType=h.files_tool_type}else null!=(l=d.openAI)&&l.assistant&&(d.openAI.assistant=h);return null!==(n=(c=i.connectSettings).headers)&&void 0!==n||(c.headers={}),null!==(r=(u=i.connectSettings.headers)["OpenAI-Beta"])&&void 0!==r||(u["OpenAI-Beta"]="assistants=v2"),i.maxMessages=1,i.isSSEStream=!(!i.stream||"object"==vo(i.stream)&&i.stream.simulation),i.shouldFetchHistory&&i.sessionId&&(i.fetchHistory=i.fetchHistoryFunc.bind(i)),i}return so(e,tl),yo(e,[{key:"fetchHistoryFunc",value:(d=uo(lo().mark((function e(){var t,n=this;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return setTimeout((function(){return n.deepChat.disableSubmitButton()}),2),e.prev=1,e.next=4,this.getThreadMessages(this.sessionId,!0);case 4:return t=e.sent,e.abrupt("return",(this.deepChat.disableSubmitButton(!1),t));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",[{error:"failed to fetch thread history"}]);case 11:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(){return d.apply(this,arguments)})},{key:"processMessage",value:function(t,n){var r=this.totalMessagesMaxCharLength||-1,i=Za.getCharacterLimitMessages(t,r)[0];if(n&&n.length>0){var o=this.filesToolType;if("function"==typeof this.filesToolType){var s=this.filesToolType(n.map((function(e){return e.name})));"code_interpreter"===s||"file_search"===s||"images"===s?o=s:(console.error('Tool type "'.concat(s,'" is not valid')),console.error('Expected "code_interpreter" or "file_search" or "images". Going to default to "images"'))}if("file_search"===o)return e.processAttachmentsMessage(i,n,"file_search");if("code_interpreter"===o)return e.processAttachmentsMessage(i,n,"code_interpreter");if(n.find((function(e){var t=e.name;return!Ia.isImageFileExtension(t)})))console.error("The uploaded files contained a non-image file"),console.error('Make sure only images can be uploaded or define a "code_interpreter" or "file_search" value in the "files_tool_type" property'),console.warn('Make sure your existing assistant supports these "tools" or specify them in the "new_assistant" property');else{var a=e.processImageMessage(i,n);if(a)return a}}return{content:i.text||"",role:"user"}}},{key:"createNewThreadMessages",value:function(e,t,n){var r=JSON.parse(JSON.stringify(e)),i=this.processMessage(t,n);return r.thread={messages:[i]},r}},{key:"callService",value:function(t,n,r){if(this.messages=t,this.sessionId){this.url="".concat(e.THREAD_PREFIX,"/").concat(this.sessionId,"/messages");var i=this.processMessage(n,r);$a.request(this,i,t)}else{this.url="".concat(e.THREAD_PREFIX,"/runs");var o=this.createNewThreadMessages(this.rawBody,n,r);this.isSSEStream?this.createStreamRun(o):$a.request(this,o,t)}}},{key:"callServiceAPI",value:(u=uo(lo().mark((function e(t,n,r){var i,o,s;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.waitingForStreamResponse=!1,this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null===(i=(o=this.rawBody).assistant_id)||void 0===i){e.next=6;break}e.next=12;break;case 6:if(e.t0=this.config.assistant_id,e.t0){e.next=11;break}return e.next=10,this.createNewAssistant();case 10:e.t0=e.sent;case 11:o.assistant_id=e.t0;case 12:if(this.searchedForThreadId||this.searchPreviousMessagesForThreadId(t.messages),!r){e.next=19;break}return e.next=16,tc.storeFiles(this,t,r);case 16:e.t1=e.sent,e.next=20;break;case 19:e.t1=void 0;case 20:s=e.t1,this.connectSettings.method="POST",this.callService(t,n,s);case 22:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"createNewAssistant",value:(c=uo(lo().mark((function t(){var n;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.url=e.NEW_ASSISTANT_URL,t.next=4,jl.directFetch(this,JSON.parse(JSON.stringify(this.newAssistantDetails)),"POST");case 4:return n=t.sent,t.abrupt("return",(this.config.assistant_id=n.id,this.config.assistant_id));case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0),console.error("Failed to create a new assistant");case 11:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return c.apply(this,arguments)})},{key:"searchPreviousMessagesForThreadId",value:function(e){var t=e.find((function(e){return e._sessionId}));t&&(this.sessionId=t._sessionId),this.searchedForThreadId=!0}},{key:"extractResultData",value:(l=uo(lo().mark((function t(n){var r,i,o;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.waitingForStreamResponse||this.isSSEStream&&this.sessionId)){t.next=4;break}return t.next=3,this.handleStream(n);case 3:return t.abrupt("return",t.sent);case 4:if(!n.error){t.next=6;break}throw n.error.message.startsWith(tc.FILES_WITH_TEXT_ERROR)?Error("Please send text with your file(s)"):n.error.message;case 6:return t.next=8,this.assignThreadAndRun(n);case 8:return i="".concat(e.THREAD_PREFIX,"/").concat(this.sessionId,"/runs/").concat(this.run_id),o={method:"GET",headers:null==(r=this.connectSettings)?void 0:r.headers},t.abrupt("return",($a.executePollRequest(this,i,o,this.messages),{makingAnotherRequest:!0}));case 10:case"end":return t.stop()}}),t,this)}))),function(e){return l.apply(this,arguments)})},{key:"assignThreadAndRun",value:(a=uo(lo().mark((function t(n){var r;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.sessionId){t.next=8;break}return this.url="".concat(e.THREAD_PREFIX,"/").concat(this.sessionId,"/runs"),t.next=4,jl.directFetch(this,JSON.parse(JSON.stringify(this.rawBody)),"POST");case 4:r=t.sent,this.run_id=r.id,t.next=9;break;case 8:this.sessionId=n.thread_id,this.run_id=n.id,this.messages&&(this.messages.messages[this.messages.messages.length-1]._sessionId=this.sessionId);case 9:case"end":return t.stop()}}),t,this)}))),function(e){return a.apply(this,arguments)})},{key:"getThreadMessages",value:(s=uo(lo().mark((function t(n){var r,i,o,s,a=arguments;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.length>1&&void 0!==a[1]&&a[1],this.url="".concat(e.THREAD_PREFIX,"/").concat(n,"/messages?order=desc"),t.next=4,jl.directFetch(this,{},"GET");case 4:if(s=t.sent,t.t0=!r&&this.deepChat.responseInterceptor,!t.t0){t.next=10;break}return t.next=9,null==(o=(i=this.deepChat).responseInterceptor)?void 0:o.call(i,s);case 9:s=t.sent;case 10:return t.abrupt("return",tc.processAPIMessages(this,s,r));case 11:case"end":return t.stop()}}),t,this)}))),function(e){return s.apply(this,arguments)})},{key:"extractPollResultData",value:(o=uo(lo().mark((function t(n){var r,i,o,s,a,l,c,u,d=this;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n.status,o=n.required_action,"queued"!==i&&"in_progress"!==i){t.next=3;break}return t.abrupt("return",{timeoutMS:e.POLLING_TIMEOUT_MS});case 3:if("completed"!==i||!this.messages){t.next=11;break}return t.next=6,this.getThreadMessages(n.thread_id);case 6:return s=t.sent,a=s.shift(),l=a.text,c=a.files,t.abrupt("return",(setTimeout((function(){s.forEach((function(e){return d.deepChat.addMessage(e)}))})),{text:l,_sessionId:this.sessionId,files:c}));case 11:if(u=null==(r=null==o?void 0:o.submit_tool_outputs)?void 0:r.tool_calls,"requires_action"!==i||!u){t.next=16;break}return t.next=15,this.handleTools(u);case 15:return t.abrupt("return",t.sent);case 16:throw Error("Thread run status: ".concat(i));case 17:case"end":return t.stop()}}),t,this)}))),function(e){return o.apply(this,arguments)})},{key:"handleTools",value:(i=uo(lo().mark((function t(n){var r,i,o,s;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._functionHandler){t.next=2;break}throw Error("Please define the `function_handler` property inside the [openAI](https://deepchat.dev/docs/directConnection/openAI#Assistant) object.");case 2:if(r=n.map((function(e){return{name:e.function.name,arguments:e.function.arguments}})),i=this._functionHandler(r),Array.isArray(i)&&n.length===i.length){t.next=5;break}throw Error(tc.FUNCTION_TOOL_RESP_ERROR);case 5:return t.next=7,Promise.all(i);case 7:if(!(o=t.sent).find((function(e){return"string"!=typeof e}))){t.next=10;break}throw Error(tc.FUNCTION_TOOL_RESP_ERROR);case 10:if(s=o.map((function(e,t){return{tool_call_id:n[t].id,output:e}})),this.url="".concat(e.THREAD_PREFIX,"/").concat(this.sessionId,"/runs/").concat(this.run_id,"/submit_tool_outputs"),!this.isSSEStream){t.next=17;break}return t.next=15,this.createStreamRun({tool_outputs:s});case 15:t.next=19;break;case 17:return t.next=19,jl.directFetch(this,{tool_outputs:s},"POST");case 19:return t.abrupt("return",{timeoutMS:e.POLLING_TIMEOUT_MS});case 20:case"end":return t.stop()}}),t,this)}))),function(e){return i.apply(this,arguments)})},{key:"handleStream",value:(r=uo(lo().mark((function t(n){var r,i,o,s;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=null==(i=null==(r=n.required_action)?void 0:r.submit_tool_outputs)?void 0:i.tool_calls,"requires_action"!==n.status||!o){t.next=6;break}return this.run_id=n.id,t.next=5,this.handleTools(o);case 5:return t.abrupt("return",t.sent);case 6:if(!this.waitingForStreamResponse){t.next=8;break}return t.abrupt("return",this.parseStreamResult(n));case 8:return this.isSSEStream&&this.sessionId&&(this.url="".concat(e.THREAD_PREFIX,"/").concat(this.sessionId,"/runs"),s=JSON.parse(JSON.stringify(this.rawBody)),this.createStreamRun(s)),t.abrupt("return",{makingAnotherRequest:!0});case 10:case"end":return t.stop()}}),t,this)}))),function(e){return r.apply(this,arguments)})},{key:"parseStreamResult",value:(n=uo(lo().mark((function e(t){var n,r,i,o,s,a,l,c,u,d;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.content&&t.content.length>0&&this.messages)){e.next=5;break}if(a=t.content.find((function(e){return e.text})),!(null!=(n=null==a?void 0:a.text)&&n.annotations&&a.text.annotations.length>0)){e.next=5;break}return l=t.content.find((function(e){return!!e.text}))||t.content[0],c=tc.getFilesAndText.bind(this,this,{role:"assistant",content:t.content},l),e.abrupt("return",(null==(r=this.messageStream)||r.endStreamAfterFileDownloaded(this.messages,c),{text:""}));case 5:if(null==(i=t.delta)||!i.content){e.next=14;break}if(!(t.delta.content.length>1)){e.next=13;break}if(u=t.delta.content.find((function(e){return e.text})),null==(o=null==u?void 0:u.text)||!o.annotations||0!==u.text.annotations.length){e.next=13;break}return e.next=11,tc.processStreamMessages(this,t.delta.content);case 11:return d=e.sent,e.abrupt("return",{text:d[0].text,files:d[1].files});case 13:return e.abrupt("return",{text:null==(s=t.delta.content[0].text)?void 0:s.value});case 14:return e.abrupt("return",(!this.sessionId&&t.thread_id&&(this.sessionId=t.thread_id),{makingAnotherRequest:!0}));case 15:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"createStreamRun",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.stream=!0,this.waitingForStreamResponse=!0,e.next=4,Wa.request(this,t,this.messages,!0,!0);case 4:this.messageStream=e.sent;case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}],[{key:"processImageMessage",value:function(e,t){var n=null==t?void 0:t.filter((function(e){return Ia.isImageFileExtension(e.name)})).map((function(e){return{type:"image_file",image_file:{file_id:e.id}}}));if(n&&n.length>0)return e.text&&e.text.length>0&&n.push({type:"text",text:e.text}),{content:n,role:"user"}}},{key:"processAttachmentsMessage",value:function(e,t,n){return{attachments:t.map((function(e){return{tools:[{type:n}],file_id:e.id}})),content:[{type:"text",text:e.text}],role:"user"}}}]);var t,n,r,i,o,s,a,l,c,u,d}();nc.THREAD_PREFIX="https://api.openai.com/v1/threads",nc.NEW_ASSISTANT_URL="https://api.openai.com/v1/assistants",nc.POLLING_TIMEOUT_MS=800;var rc=nc,ic=function(){function e(t){var n,r;mo(this,e);var i=t.directConnection,o=null==i?void 0:i.openAI;(n=no(this,e,[t,jl.buildKeyVerificationDetails(),jl.buildHeaders,o,{images:{files:{acceptedFormats:".png",maxNumberOfFiles:2}}}])).insertKeyPlaceholderText="OpenAI API Key",n.keyHelpUrl="https://platform.openai.com/account/api-keys",n.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>OpenAI DALLE</b></div>\n    <p><b>Insert text</b> to generate an image.</p>\n    <p><b>Upload 1</b> PNG image to generate its variation and optionally insert text to specify the change.</p>\n    <p><b>Upload 2</b> PNG images where the second is a copy of the first with a transparent area where the edit should\n      take place and text to specify the edit.</p>\n    <p>Click <a href="https://platform.openai.com/docs/guides/images/introduction">here</a> for more info.</p>',n.url="",n.permittedErrorPrefixes=["Incorrect","Invalid input image"];var s=null==(r=null==i?void 0:i.openAI)?void 0:r.images;if(n.camera){var a="object"==vo(s)&&s.size?Number.parseInt(s.size):1024;n.camera.files={dimensions:{width:a,height:a}}}return"object"==vo(s)&&Object.assign(n.rawBody,s),n.canSendMessage=e.canFileSendMessage,n}return so(e,tl),yo(e,[{key:"preprocessBody",value:function(e,t){var n=JSON.parse(JSON.stringify(e));return t&&""!==t&&(n.prompt=t),n}},{key:"callApiWithImage",value:function(t,n,r){var i,o,s,a=null==(o=null==(i=n[n.length-1])?void 0:i.text)?void 0:o.trim();if(r[1]||a&&""!==a){this.url=e.IMAGE_EDIT_URL;var l=this.preprocessBody(this.rawBody,a);s=e.createFormDataBody(l,r[0],r[1])}else this.url=e.IMAGE_VARIATIONS_URL,s=e.createFormDataBody(this.rawBody,r[0]);Fa.tempRemoveContentHeader(this.connectSettings,$a.request.bind(this,this,s,t),!1)}},{key:"callServiceAPI",value:(n=uo(lo().mark((function t(n,r,i){var o,s;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(o=this.connectSettings)&&o.headers){t.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null==i||!i[0]){t.next=6;break}this.callApiWithImage(n,r,i),t.next=11;break;case 6:if(this.connectSettings){t.next=8;break}throw new Error("Request settings have not been set up");case 8:this.url=e.IMAGE_GENERATION_URL,s=this.preprocessBody(this.rawBody,r[r.length-1].text),$a.request(this,s,n);case 11:case"end":return t.stop()}}),t,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error.message;case 2:return e.abrupt("return",{files:t.data.map((function(e){return e.url?{src:e.url,type:"image"}:{src:"".concat(_l).concat(e.b64_json),type:"image"}}))});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}],[{key:"canFileSendMessage",value:function(e,t){return!(null==t||!t[0])||!(!e||""===e.trim())}},{key:"createFormDataBody",value:function(e,t,n){var r=new FormData;return r.append("image",t),n&&r.append("mask",n),Object.keys(e).forEach((function(t){r.append(t,String(e[t]))})),r}}]);var t,n}();ic.IMAGE_GENERATION_URL="https://api.openai.com/v1/images/generations",ic.IMAGE_VARIATIONS_URL="https://api.openai.com/v1/images/variations",ic.IMAGE_EDIT_URL="https://api.openai.com/v1/images/edits";var oc=ic,sc=function(){function e(t){var n,r,i,o,s,a,l;mo(this,e);var c=JSON.parse(JSON.stringify(t.directConnection)),u=c.openAI;(i=no(this,e,[t,jl.buildKeyVerificationDetails(),jl.buildHeaders,u])).insertKeyPlaceholderText="OpenAI API Key",i.keyHelpUrl="https://platform.openai.com/account/api-keys",i.url="https://api.openai.com/v1/chat/completions",i.permittedErrorPrefixes=["Incorrect"],i.asyncCallInProgress=!1,i._systemMessage=e.generateSystemMessage("You are a helpful assistant.");var d=null==(o=c.openAI)?void 0:o.chat;if("object"==vo(d)){d.system_prompt&&(i._systemMessage=e.generateSystemMessage(d.system_prompt));var p=(null==(a=null==(s=t.directConnection)?void 0:s.openAI)?void 0:a.chat).function_handler;p&&(i._functionHandler=p),i.cleanConfig(d),Object.assign(i.rawBody,d)}return null!==(n=i.maxMessages)&&void 0!==n||(i.maxMessages=-1),null!==(r=(l=i.rawBody).model)&&void 0!==r||(l.model="gpt-4o"),i}return so(e,tl),yo(e,[{key:"cleanConfig",value:function(e){delete e.system_prompt,delete e.function_handler}},{key:"preprocessBody",value:function(t,n){var r,i=JSON.parse(JSON.stringify(t)),o=Za.getCharacterLimitMessages(n,this.totalMessagesMaxCharLength?this.totalMessagesMaxCharLength-this._systemMessage.content.length:-1).map((function(t){return{content:e.getContent(t),role:t.role===$o.USER_ROLE?"user":"assistant"}}));return n.find((function(e){return e.files&&e.files.length>0}))&&(null!==(r=i.max_tokens)&&void 0!==r||(i.max_tokens=300)),i.messages=[this._systemMessage].concat($i(o)),i}},{key:"callServiceAPI",value:(i=uo(lo().mark((function e(t,n){var r,i;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:r=this.preprocessBody(this.rawBody,n),(i=this.stream)&&("object"!=vo(i)||!i.simulation)||r.stream?(r.stream=!0,Wa.request(this,r,t)):$a.request(this,r,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"extractResultData",value:(r=uo(lo().mark((function e(t,n,r){var i,o,s,a;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error.message;case 2:return e.abrupt("return",null!=(o=null==(i=t.choices)?void 0:i[0])&&o.delta?this.extractStreamResult(t.choices[0],n,r):null!=(a=null==(s=t.choices)?void 0:s[0])&&a.message?t.choices[0].message.tool_calls?this.handleTools(t.choices[0].message,n,r):{text:t.choices[0].message.content}:{text:""});case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"extractStreamResult",value:(n=uo(lo().mark((function e(t,n,r){var i,o,s=this;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.delta,"tool_calls"!==t.finish_reason){e.next=7;break}return this.asyncCallInProgress=!0,o={tool_calls:this._streamToolCalls},e.abrupt("return",(this._streamToolCalls=void 0,this.handleTools(o,n,r)));case 7:null!=i&&i.tool_calls&&(this._streamToolCalls?i.tool_calls.forEach((function(e,t){s._streamToolCalls&&(s._streamToolCalls[t].function.arguments+=e.function.arguments)})):this._streamToolCalls=i.tool_calls);case 8:return e.abrupt("return",{text:(null==i?void 0:i.content)||""});case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"handleTools",value:(t=uo(lo().mark((function e(t,n,r){var i,o,s,a,l,c,u,d,p,h;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.tool_calls&&n&&r&&this._functionHandler){e.next=2;break}throw Error("Please define the `function_handler` property inside the [openAI](https://deepchat.dev/docs/directConnection/openAI#Chat) object.");case 2:return c=JSON.parse(JSON.stringify(r)),u=t.tool_calls.map((function(e){return{name:e.function.name,arguments:e.function.arguments}})),e.next=6,null==(i=this._functionHandler)?void 0:i.call(this,u);case 6:if(!(d=e.sent).text){e.next=15;break}return p={text:d.text},e.next=11,null==(s=(o=this.deepChat).responseInterceptor)?void 0:s.call(o,p);case 11:if(e.t0=e.sent,e.t0){e.next=14;break}e.t0=p;case 14:return e.abrupt("return",e.t0);case 15:if(c.messages.push({tool_calls:t.tool_calls,role:"assistant",content:null}),(!Array.isArray(d)||d.find((function(e){return"string"!=typeof e})))&&u.length!==d.length){e.next=35;break}return d.forEach((function(e,n){var r,i=null==(r=t.tool_calls)?void 0:r[n];null==c||c.messages.push({role:"tool",tool_call_id:null==i?void 0:i.id,name:null==i?void 0:i.function.name,content:e.response})})),delete c.tools,delete c.tool_choice,delete c.stream,e.prev=17,e.next=20,null==n?void 0:n(c).then((function(e){return Fa.processResponseByType(e)}));case 20:return h=e.sent,e.next=23,null==(l=(a=this.deepChat).responseInterceptor)?void 0:l.call(a,h);case 23:if(e.t1=e.sent,e.t1){e.next=26;break}e.t1=h;case 26:if(!(h=e.t1).error){e.next=29;break}throw h.error.message;case 29:return e.abrupt("return",{text:h.choices[0].message.content||""});case 32:throw e.prev=32,e.t2=e.catch(17),this.asyncCallInProgress=!1,e.t2;case 35:throw Error("Response object must either be {response: string}[] for each individual function or {text: string} for a direct response, see https://deepchat.dev/docs/directConnection/OpenAI#FunctionHandler.");case 36:case"end":return e.stop()}}),e,this,[[17,32]])}))),function(e,n,r){return t.apply(this,arguments)})}],[{key:"generateSystemMessage",value:function(e){return{role:"system",content:e}}},{key:"getContent",value:function(e){if(e.files&&e.files.length>0){var t=e.files.map((function(e){return{type:"image_url",image_url:{url:e.src}}}));return e.text&&e.text.trim().length>0&&t.unshift({type:"text",text:e.text}),t}return e.text}}]);var t,n,r,i}(),ac=function(){function e(t){var n,r,i;mo(this,e);var o=JSON.parse(JSON.stringify(t.directConnection)),s=null==(i=o.cohere)?void 0:i.chat;return r=no(this,e,[t,"https://api.cohere.ai/v1/chat","Ask me anything!",s,o.cohere]),"object"==vo(s)&&Object.assign(r.rawBody,s),null!==(n=r.maxMessages)&&void 0!==n||(r.maxMessages=-1),r}return so(e,Nl),yo(e,[{key:"preprocessBody",value:function(e,t){var n=JSON.parse(JSON.stringify(e)),r=t.filter((function(e){return e.text}));return n.query=r[r.length-1].text,n.chat_history=r.slice(0,r.length-1).map((function(e){return{text:e.text,user_name:"ai"===e.role?"CHATBOT":"USER"}})),n}},{key:"callServiceAPI",value:(n=uo(lo().mark((function e(t,n){var r;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:r=this.preprocessBody(this.rawBody,n),$a.request(this,r,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.message){e.next=2;break}throw t.message;case 2:return e.abrupt("return",{text:t.text});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t,n}(),lc=function(){function e(){mo(this,e)}return yo(e,null,[{key:"buildHeaders",value:function(e){return{Authorization:"Bearer ".concat(e),"Content-Type":"application/json",accept:"application/json"}}},{key:"handleVerificationResult",value:function(e,t,n,r){var i;null!=(i=e.message)&&i.includes("invalid request: prompt must be at least 1 token long")?n(t):r(Bo.INVALID_KEY)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.mistral.ai/v1/models",method:"GET",handleVerificationResult:e.handleVerificationResult}}}])}(),cc=function(){function e(t){var n,r,i,o;mo(this,e);var s=JSON.parse(JSON.stringify(t.directConnection)).mistral;return(i=no(this,e,[t,lc.buildKeyVerificationDetails(),lc.buildHeaders,s])).insertKeyPlaceholderText="Mistral API Key",i.keyHelpUrl="https://console.mistral.ai/api-keys/",i.url="https://api.mistral.ai/v1/chat/completions",i.permittedErrorPrefixes=["invalid"],s&&(i.cleanConfig(s),Object.assign(i.rawBody,s)),null!==(n=i.maxMessages)&&void 0!==n||(i.maxMessages=-1),null!==(r=(o=i.rawBody).model)&&void 0!==r||(o.model="open-mistral-7b"),i}return so(e,tl),yo(e,[{key:"cleanConfig",value:function(e){delete e.key}},{key:"preprocessBody",value:function(e,t){var n=JSON.parse(JSON.stringify(e)),r=t.filter((function(e){return e.text}));return n.messages=r.slice(0,r.length-1).map((function(e){return{text:e.text,user_name:"ai"===e.role?"system":"user"}})),n}},{key:"callServiceAPI",value:(n=uo(lo().mark((function e(t,n){var r;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:r=this.preprocessBody(this.rawBody,n),$a.request(this,r,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.message){e.next=2;break}throw t.message;case 2:return e.abrupt("return",{text:t.text});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t,n}(),uc=function(){return yo((function e(){mo(this,e)}),null,[{key:"create",value:function(e){var t=e.directConnection,n=e.connect,r=e.demo;if(e.webModel)return new hl(e);if(t){if(t.openAI)return t.openAI.images?new oc(e):t.openAI.speechToText?new ql(e):t.openAI.textToSpeech?new Ul(e):t.openAI.assistant?new rc(e):new sc(e);if(t.assemblyAI)return new Kl(e);if(t.cohere)return t.cohere.textGeneration?new Dl(e):t.cohere.summarization?new Fl(e):new ac(e);if(t.huggingFace)return t.huggingFace.textGeneration?new Cl(e):t.huggingFace.summarization?new Al(e):t.huggingFace.translation?new Ll(e):t.huggingFace.fillMask?new Rl(e):t.huggingFace.questionAnswer?new Tl(e):t.huggingFace.audioSpeechRecognition?new El(e):t.huggingFace.audioClassification?new yl(e):t.huggingFace.imageClassification?new bl(e):new Ml(e);if(t.azure){if(t.azure.speechToText)return new Zl(e);if(t.azure.textToSpeech)return new Yl(e);if(t.azure.summarization)return new Gl(e);if(t.azure.translation)return new Ql(e)}if(t.stabilityAI)return t.stabilityAI.imageToImage?new Il(e):t.stabilityAI.imageToImageUpscale?new wl(e):t.stabilityAI.imageToImageMasking?new Sl(e):new Ol(e);if(t.mistral)return new cc(e)}return!n||r&&n.stream?new el(e,void 0,r||!0):new el(e)}}])}(),dc=yo((function e(){mo(this,e)}));dc.attibutes={string:function(e){return e},number:function(e){return parseFloat(e)},boolean:function(e){return"true"===e},object:function(e){return JSON.parse(e)},array:function(e){return JSON.parse(e)},function:function(e){return new Function("return ".concat(e))()}};var pc=dc;function hc(e){return function(t,n){Object.defineProperty(t,n,{});var r=t.constructor,i=n.toLocaleLowerCase();r._attributes_[i]=pc.attibutes[e],r._attributeToProperty_[i]=n}}var fc=function(){function e(){mo(this,e)}return yo(e,null,[{key:"colorToHex",value:function(e){var t=document.createElement("div");return t.style.color=e,document.body.appendChild(t),"#".concat(window.getComputedStyle(t).color.match(/\d+/g).map((function(e){return parseInt(e).toString(16).padStart(2,"0")})).join(""))}},{key:"set",value:function(t,n){var r,i,o,s;if(null!=(i=null==(r=null==n?void 0:n.loading)?void 0:r.bubble)&&i.color){var a=e.colorToHex(null==(s=null==(o=null==n?void 0:n.loading)?void 0:o.bubble)?void 0:s.color);t.style.setProperty("--message-dots-color",a),t.style.setProperty("--message-dots-color-fade","".concat(a,"33"))}else t.style.setProperty("--message-dots-color","#848484"),t.style.setProperty("--message-dots-color-fade","#55555533")}}])}(),vc=function(){function e(t,n,r){mo(this,e),this._isDisplayed=!1,t?(this._elementRef=this.createIntroPanelWithChild(t,r),this._isDisplayed=!0):n&&(this._elementRef=this.createInternalIntroPanel(n,r),this._isDisplayed=!0)}return yo(e,[{key:"createIntroPanelWithChild",value:function(t,n){var r=e.createIntroPanel(n);return"none"===t.style.display&&(t.style.display="block"),r.appendChild(t),r}},{key:"createInternalIntroPanel",value:function(t,n){var r=e.createIntroPanel(n);return r.id="internal-intro-panel",r.innerHTML=t,r}},{key:"hide",value:function(){this._isDisplayed&&this._elementRef&&(this._elementRef.style.display="none",this._isDisplayed=!1)}},{key:"display",value:function(){!this._isDisplayed&&this._elementRef&&(this._elementRef.style.display="",this._isDisplayed=!0)}}],[{key:"createIntroPanel",value:function(e){var t=document.createElement("div");return t.classList.add("intro-panel"),Object.assign(t.style,e),t}}])}(),mc=function(){return yo((function e(t,n,r){mo(this,e),this._isLoading=!1,this._isComplete=!1,this._messages=n,this.populateHistory(t),r.fetchHistory&&this.fetchHistory(r.fetchHistory),t.loadHistory&&this.setupLoadHistory(t,t.loadHistory)}),[{key:"loadInitialHistory",value:(n=uo(lo().mark((function e(t,n){var r,i;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(0);case 2:r=e.sent,this._isComplete=!r.find((function(e){return!e})),i=r.filter((function(e){return!!e})),this.populateHistory(t,i);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"processLoadedHistory",value:function(e){var t,n=this;this._isLoading=!0;var r=null==(t=this._messages.messageElementRefs[0])?void 0:t.outerContainer,i=this._messages.elementRef.scrollTop;null==e||e.reverse().map((function(e){if(e){var t=n._messages.addAnyMessage(ho(ho({},e),{},{sendUpdate:!0}),!0,!0);return t&&n._messages.messages.unshift(t),t}n._isComplete=!0})).filter((function(e){return!!e})).reverse().forEach((function(e){return n._messages.sendClientUpdate(e,!0)})),r&&(this._messages.elementRef.scrollTop=i+r.offsetTop),this._isLoading=!1}},{key:"setupLoadHistory",value:(t=uo(lo().mark((function e(t,n){var r=this;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._messages.elementRef.onscroll=uo(lo().mark((function e(){var t;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r._isLoading||r._isComplete||0!==r._messages.elementRef.scrollTop){e.next=5;break}return e.next=3,n(0);case 3:t=e.sent,r.processLoadedHistory(t);case 5:case"end":return e.stop()}}),e)}))),t.history||zo.processHistory(t)||this.loadInitialHistory(t,n);case 1:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"populateHistory",value:function(e,t){var n=this,r=e.history||zo.processHistory(e)||t;r&&(r.forEach((function(e){zo.processHistoryFile(e),n._messages.addNewMessage(e,!0)})),setTimeout((function(){return Ho.scrollToBottom(n._messages.elementRef)}),0))}},{key:"fetchHistory",value:(e=uo(lo().mark((function e(t){var n=this;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:e.sent.forEach((function(e){return n._messages.addAnyMessage(e,!0)})),setTimeout((function(){return Ho.scrollToBottom(n._messages.elementRef)}),0);case 4:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})}]);var e,t,n}(),gc=function(){return yo((function e(){mo(this,e)}),null,[{key:"getText",value:function(e,t){var n;if(!(e.directConnection||e.connect||e.webModel||e.demo))return"Connect to any API using the [connect](https://deepchat.dev/docs/connect#connect-1) property or a popular service via [directConnection](https://deepchat.dev/docs/directConnection/#directConnection).\n Host AI entirely on your browser via a [webModel](https://deepchat.dev/docs/webModel).\n To get started checkout the [Start](https://deepchat.dev/start) page and live code [examples](https://deepchat.dev/examples/frameworks).\n To remove this message set the [demo](https://deepchat.dev/docs/demo#demo) property to true.";if(e.directConnection){if(!t.isDirectConnection())return"Please define a valid service inside\n          the [directConnection](https://deepchat.dev/docs/directConnection/#directConnection) object.";var r=null==(n=e.directConnection.openAI)?void 0:n.chat;if("object"==vo(r)&&r.tools&&!r.function_handler)return"Please define the `function_handler` property inside the openAI [chat](https://deepchat.dev/docs/directConnection/openAI#Chat) object."}else if(e.connect&&!e.connect.url&&!e.connect.handler)return e.demo?e.connect.stream?null:"When [demo](https://deepchat.dev/docs/demo) mode is enabled - the [connect](https://deepchat.dev/docs/connect#connect-1) object can only accept the [stream](https://deepchat.dev/docs/connect#Stream) property.":"Please define a `url` or a `handler` property inside the [connect](https://deepchat.dev/docs/connect#connect-1) object.";return null}}])}(),yc=function(){function e(){mo(this,e)}return yo(e,null,[{key:"createImage",value:function(e,t,n){var r=new Image;return r.src=e.src,n||Ia.scrollDownOnImageLoad(r.src,t),Ia.processContent("image",r,r.src,e.name)}},{key:"addNewImageMessage",value:(t=uo(lo().mark((function t(n,r,i,o){var s,a;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=e.createImage(r,n.elementRef,o),(a=n.createNewMessageElement("",i)).bubbleElement.appendChild(s),a.bubbleElement.classList.add("image-message"),Ia.addMessage(n,a,"image",i,o);case 2:case"end":return t.stop()}}),t)}))),function(e,n,r,i){return t.apply(this,arguments)})},{key:"createAudioElement",value:function(e,t){var n=document.createElement("audio");return n.src=e.src,n.classList.add("audio-player"),n.controls=!0,Mo.IS_SAFARI&&(n.classList.add("audio-player-safari"),n.classList.add(t===$o.USER_ROLE?"audio-player-safari-right":"audio-player-safari-left")),n}},{key:"addNewAudioMessage",value:function(t,n,r,i){var o=e.createAudioElement(n,r),s=t.createMessageElementsOnOrientation("",r,i);s.bubbleElement.appendChild(o),s.bubbleElement.classList.add("audio-message"),Ia.addMessage(t,s,"audio",r,i)}},{key:"createAnyFile",value:function(e){var t=document.createElement("div");t.classList.add("any-file-message-contents");var n=document.createElement("div");n.classList.add("any-file-message-icon-container");var r=ol.createSVGElement('<?xml version="1.0" encoding="iso-8859-1"?>\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" \n\t viewBox="50 30 420 450" xml:space="preserve">\n<g filter="brightness(0) saturate(100%) invert(16%) sepia(0%) saturate(1942%) hue-rotate(215deg) brightness(99%) contrast(93%)">\n\t<g>\n\t\t<path d="M447.933,103.629c-0.034-3.076-1.224-6.09-3.485-8.352L352.683,3.511c-0.004-0.004-0.007-0.005-0.011-0.008\n\t\t\tC350.505,1.338,347.511,0,344.206,0H89.278C75.361,0,64.04,11.32,64.04,25.237v461.525c0,13.916,11.32,25.237,25.237,25.237\n\t\t\th333.444c13.916,0,25.237-11.32,25.237-25.237V103.753C447.96,103.709,447.937,103.672,447.933,103.629z M356.194,40.931\n\t\t\tl50.834,50.834h-49.572c-0.695,0-1.262-0.567-1.262-1.262V40.931z M423.983,486.763c0,0.695-0.566,1.261-1.261,1.261H89.278\n\t\t\tc-0.695,0-1.261-0.566-1.261-1.261V25.237c0-0.695,0.566-1.261,1.261-1.261h242.94v66.527c0,13.916,11.322,25.239,25.239,25.239\n\t\t\th66.527V486.763z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M362.088,164.014H149.912c-6.62,0-11.988,5.367-11.988,11.988c0,6.62,5.368,11.988,11.988,11.988h212.175\n\t\t\tc6.62,0,11.988-5.368,11.988-11.988C374.076,169.381,368.707,164.014,362.088,164.014z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M362.088,236.353H149.912c-6.62,0-11.988,5.368-11.988,11.988c0,6.62,5.368,11.988,11.988,11.988h212.175\n\t\t\tc6.62,0,11.988-5.368,11.988-11.988C374.076,241.721,368.707,236.353,362.088,236.353z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M362.088,308.691H149.912c-6.62,0-11.988,5.368-11.988,11.988c0,6.621,5.368,11.988,11.988,11.988h212.175\n\t\t\tc6.62,0,11.988-5.367,11.988-11.988C374.076,314.06,368.707,308.691,362.088,308.691z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M256,381.031H149.912c-6.62,0-11.988,5.368-11.988,11.988c0,6.621,5.368,11.988,11.988,11.988H256\n\t\t\tc6.62,0,11.988-5.367,11.988-11.988C267.988,386.398,262.62,381.031,256,381.031z"/>\n\t</g>\n</g>\n</svg>');r.classList.add("any-file-message-icon"),n.appendChild(r);var i=document.createElement("div");return i.classList.add("any-file-message-text"),i.textContent=e.name||Ia.DEFAULT_FILE_NAME,t.appendChild(n),t.appendChild(i),Ia.processContent("any",t,e.src,i.textContent)}},{key:"addNewAnyFileMessage",value:function(t,n,r,i){var o=t.createMessageElementsOnOrientation("",r,i),s=e.createAnyFile(n);o.bubbleElement.classList.add("any-file-message-bubble"),o.bubbleElement.appendChild(s),Ia.addMessage(t,o,"file",r,i)}},{key:"addMessages",value:function(t,n,r,i){n.forEach((function(n){n.ref&&(n=Ia.removeFileRef(n)),Ia.isAudioFile(n)?e.addNewAudioMessage(t,n,r,i):Ia.isImageFile(n)?e.addNewImageMessage(t,n,r,i):e.addNewAnyFileMessage(t,n,r,i)}))}}]);var t}(),bc=function(){function e(t,n,r){var i,o,s;mo(this,e),i=no(this,e,[t]);var a=n.permittedErrorPrefixes,l=n.introPanelMarkUp,c=n.demo;return i._errorMessageOverrides=null==(o=t.errorMessages)?void 0:o.overrides,i._onClearMessages=La.onClearMessages.bind(i,t),i._onError=La.onError.bind(i,t),i._displayLoadingMessage=e.getDisplayLoadingMessage(t,n),i._permittedErrorPrefixes=a,i.addSetupMessageIfNeeded(t,n)||i.populateIntroPanel(r,l,t.introPanelStyle),i.addIntroductoryMessage(t,n),new mc(t,i,n),i._displayServiceErrorMessages=null==(s=t.errorMessages)?void 0:s.displayServiceErrorMessages,t.getMessages=function(){return JSON.parse(JSON.stringify(i.messages))},t.clearMessages=i.clearMessages.bind(i,n),t.refreshMessages=i.refreshTextMessages.bind(i),t.scrollToBottom=Ho.scrollToBottom.bind(i,i.elementRef),t.addMessage=function(e,t){i.addAnyMessage(ho(ho({},e),{},{sendUpdate:!!t}),!t)},n.isWebModel()&&n.setUpMessages(i),c&&i.prepareDemo(c),t.textToSpeech&&Vo.processConfig(t.textToSpeech,(function(e){i.textToSpeech=e})),i}return so(e,Ra),yo(e,[{key:"prepareDemo",value:function(e){"object"==vo(e)&&(e.response&&(this.customDemoResponse=e.response),e.displayErrors&&(e.displayErrors.default&&this.addNewErrorMessage("",""),e.displayErrors.service&&this.addNewErrorMessage("service",""),e.displayErrors.speechToText&&this.addNewErrorMessage("speechToText","")),e.displayLoadingBubble&&this.addLoadingMessage())}},{key:"addSetupMessageIfNeeded",value:function(e,t){var n=gc.getText(e,t);if(n){var r=this.createAndAppendNewMessageElement(n,$o.AI_ROLE);this.applyCustomStyles(r,$o.AI_ROLE,!1)}return!!n}},{key:"addIntroductoryMessage",value:function(e,t){var n,r;null!=e&&e.shadowRoot&&(this._introMessage=e.introMessage);var i,o=this._introMessage;(null!=t&&t.isWebModel()&&(null!==(n=o)&&void 0!==n||(o=t.getIntroMessage(o))),o)&&(null!=o&&o.text?i=this.createAndAppendNewMessageElement(o.text,$o.AI_ROLE):null!=o&&o.html&&(i=rs.add(this,o.html,$o.AI_ROLE,this.messageElementRefs)),i&&(this.applyCustomStyles(i,$o.AI_ROLE,!1,null==(r=this.messageStyles)?void 0:r.intro),i.outerContainer.classList.add("deep-chat-intro")))}},{key:"removeIntroductoryMessage",value:function(){var e=this.messageElementRefs[0];e.outerContainer.classList.contains("deep-chat-intro")&&(e.outerContainer.remove(),this.messageElementRefs.shift())}},{key:"addAnyMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.error?this.addNewErrorMessage("service",e.error):this.addNewMessage(e,t,n)}},{key:"addNewMessage",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.createMessageContent(t),o={status:t.overwrite};if(!t.ignoreText&&void 0!==i.text&&null!==t.text&&(this.addNewTextMessage(i.text,i.role,o,r),!n&&this.textToSpeech&&i.role!==$o.USER_ROLE&&Vo.speak(i.text,this.textToSpeech)),i.files&&Array.isArray(i.files)&&yc.addMessages(this,i.files,i.role,r),void 0!==i.html&&null!==i.html){var s=rs.add(this,i.html,i.role,this.messageElementRefs,o,r);ts.isElementTemporary(s)&&delete i.html}return this.isValidMessageContent(i)&&!r&&this.updateStateOnMessage(i,t.overwrite,t.sendUpdate,n),i}},{key:"isValidMessageContent",value:function(e){return e.text||e.html||e.files&&e.files.length>0}},{key:"updateStateOnMessage",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t||this.messages.push(e),n&&this.sendClientUpdate(e,r)}},{key:"removeMessageOnError",value:function(){var t=this.messageElementRefs[this.messageElementRefs.length-1],n=null==t?void 0:t.bubbleElement;(null!=n&&n.classList.contains(Na.MESSAGE_CLASS)&&""===n.textContent||e.isTemporaryElement(t))&&this.removeLastMessage()}},{key:"addNewErrorMessage",value:function(t,n){var r,i,o,s,a;this.removeMessageOnError();var l=e.createBaseElements(),c=l.outerContainer,u=l.bubbleElement;u.classList.add("error-message-text");var d=this.getPermittedMessage(n)||(null==(r=this._errorMessageOverrides)?void 0:r[t])||(null==(i=this._errorMessageOverrides)?void 0:i.default)||"Error, please try again.";this.renderText(u,d);var p=Oa.extractParticularSharedStyles(["fontSize","fontFamily"],null==(o=this.messageStyles)?void 0:o.default);Oa.applyCustomStylesToElements(l,!1,p),Oa.applyCustomStylesToElements(l,!1,null==(s=this.messageStyles)?void 0:s.error),this.elementRef.appendChild(c),Ho.scrollToBottom(this.elementRef),this.textToSpeech&&Vo.speak(d,this.textToSpeech),null==(a=this._onError)||a.call(this,d)}},{key:"getPermittedMessage",value:function(t){if(t)for(var n=e.extractErrorMessages(t),r=0;r<n.length;r+=1){var i=n[r];if("string"==typeof i){if(this._displayServiceErrorMessages)return i;if(this._permittedErrorPrefixes){var o=e.checkPermittedErrorPrefixes(this._permittedErrorPrefixes,i);if(o)return o}}}}},{key:"removeError",value:function(){this.isLastMessageError()&&$o.getLastMessageElement(this.elementRef).remove()}},{key:"addLoadingMessage",value:function(){var e;if(this._displayLoadingMessage){var t=this.createMessageElements("",$o.AI_ROLE),n=t.outerContainer,r=t.bubbleElement;r.classList.add("loading-message-text");var i=document.createElement("div");i.classList.add("dots-flashing"),r.appendChild(i),this.applyCustomStyles(t,$o.AI_ROLE,!1,null==(e=this.messageStyles)?void 0:e.loading),fc.set(r,this.messageStyles),this.elementRef.appendChild(n),Ho.scrollToBottom(this.elementRef)}}},{key:"populateIntroPanel",value:function(e,t,n){(e||t)&&(this._introPanel=new vc(e,t,n),this._introPanel._elementRef&&(ns.apply(this,this._introPanel._elementRef),this.elementRef.appendChild(this._introPanel._elementRef)))}},{key:"addMultipleFiles",value:(t=uo(lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all((t||[]).map((function(e){return new Promise((function(t){if(e.type&&"any"!==e.type){var n=new FileReader;n.readAsDataURL(e.file),n.onload=function(){t({src:n.result,type:e.type,ref:e.file})}}else{var r=e.file.name||Ia.DEFAULT_FILE_NAME;t({name:r,type:"any",ref:e.file})}}))}))));case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"clearMessages",value:function(e,t){var n,r,i=[];this.messageElementRefs.forEach((function(e){var t=e.bubbleElement.classList;t.contains("loading-message-text")||t.contains(Na.MESSAGE_CLASS)?i.push(e):e.outerContainer.remove()})),Array.from(this.elementRef.children).forEach((function(e){var t,n=null==(t=e.children[0])?void 0:t.children[0];null!=n&&n.classList.contains("error-message-text")&&e.remove()})),this.messageElementRefs=i,!1!==t&&(null!=(n=this._introPanel)&&n._elementRef&&this._introPanel.display(),this.addIntroductoryMessage()),this.messages.splice(0,this.messages.length),this.textElementsToText.splice(0,this.textElementsToText.length),null==(r=this._onClearMessages)||r.call(this),delete e.sessionId}}],[{key:"getDisplayLoadingMessage",value:function(e,t){var n;return!t.websocket&&(null===(n=e.displayLoadingBubble)||void 0===n||n)}},{key:"checkPermittedErrorPrefixes",value:function(e,t){for(var n=0;n<e.length;n+=1)if(t.startsWith(e[n]))return t}},{key:"extractErrorMessages",value:function(e){return Array.isArray(e)?e:e instanceof Error?[e.message]:"string"==typeof e?[e]:"object"==vo(e)&&e.error?[e.error]:[]}}]);var t}(),_c=function(){function e(){mo(this,e)}return yo(e,null,[{key:"adjustInputPadding",value:function(e,t){t["inside-left"].length>0&&e.classList.add("text-input-inner-left-adjustment"),t["inside-right"].length>0&&e.classList.add("text-input-inner-right-adjustment")}},{key:"adjustForOutsideButton",value:function(t,n,r){0===r["outside-right"].length&&r["outside-left"].length>0?(t[0].classList.add(e.INPUT_OUTSIDE_LEFT_SMALL_ADJUSTMENT_CLASS),n.classList.add(e.INPUT_OUTSIDE_LEFT_SMALL_ADJUSTMENT_CLASS)):0===r["outside-left"].length&&r["outside-right"].length>0&&(t[3].classList.add(e.INPUT_OUTSIDE_RIGHT_SMALL_ADJUSTMENT_CLASS),n.classList.add(e.INPUT_OUTSIDE_RIGHT_SMALL_ADJUSTMENT_CLASS))}},{key:"adjustOutsideSubmit",value:function(t,n,r){if(!(r["inside-left"].length>0||r["inside-right"].length>0)){if(0===r["outside-right"].length&&r["outside-left"].length>0)return t[0].classList.add(e.INPUT_OUTSIDE_LEFT_ADJUSTMENT_CLASS),n.classList.add(e.INPUT_OUTSIDE_LEFT_ADJUSTMENT_CLASS),r["outside-left"].map((function(e){return e.button.elementRef.classList.add("submit-button-enlarged")}));if(0===r["outside-left"].length&&r["outside-right"].length>0)return t[3].classList.add(e.INPUT_OUTSIDE_RIGHT_ADJUSTMENT_CLASS),n.classList.add(e.INPUT_OUTSIDE_RIGHT_ADJUSTMENT_CLASS),r["outside-right"].map((function(e){return e.button.elementRef.classList.add("submit-button-enlarged")}))}}},{key:"set",value:function(t,n,r,i){!!e.adjustOutsideSubmit(n,r,i)||e.adjustForOutsideButton(n,r,i),e.adjustInputPadding(t,i)}}])}();_c.INPUT_OUTSIDE_LEFT_ADJUSTMENT_CLASS="text-input-container-left-adjustment",_c.INPUT_OUTSIDE_RIGHT_ADJUSTMENT_CLASS="text-input-container-right-adjustment",_c.INPUT_OUTSIDE_LEFT_SMALL_ADJUSTMENT_CLASS="text-input-container-left-small-adjustment",_c.INPUT_OUTSIDE_RIGHT_SMALL_ADJUSTMENT_CLASS="text-input-container-right-small-adjustment";var kc=_c,xc=function(){function e(){mo(this,e)}return yo(e,null,[{key:"create",value:function(){return Array.from({length:4}).map((function(e,t){var n=document.createElement("div");return n.classList.add("input-button-container"),(0===t||3===t)&&n.classList.add("outer-button-container"),(1===t||2===t)&&n.classList.add("inner-button-container"),n}))}},{key:"add",value:function(e,t){e.insertBefore(t[1],e.firstChild),e.insertBefore(t[0],e.firstChild),e.appendChild(t[2]),e.appendChild(t[3])}},{key:"getContainerIndex",value:function(e){return"outside-left"===e?0:"inside-left"===e?1:"inside-right"===e?2:3}},{key:"addButton",value:function(t,n,r){n.classList.add(r);var i=e.getContainerIndex(r);t[i].appendChild(n),3===i&&n.classList.add("outside-right")}}])}(),wc=["camera","gifs","images","audio","mixedFiles","submit","microphone"],Sc=function(){function e(){mo(this,e)}return yo(e,null,[{key:"createTextElement",value:function(e){var t=document.createElement("div");return t.classList.add("text-button"),t.innerText=e,t}},{key:"createElement",value:function(t,n){return n?e.createTextElement(t):ol.createSVGElement(t)}},{key:"createCustomElement",value:function(t,n){var r,i,o,s,a=null==n?void 0:n[t];return null!=(r=null==a?void 0:a.svg)&&r.content?e.createElement(null==(i=null==a?void 0:a.svg)?void 0:i.content,!1):null!=(o=null==a?void 0:a.text)&&o.content?e.createElement(null==(s=null==a?void 0:a.text)?void 0:s.content,!0):void 0}},{key:"processElement",value:function(e,t){null!=t&&t.classList.contains("text-button")||e.classList.add("input-button-svg")}},{key:"createSpecificStateElement",value:function(t,n,r){var i;return r&&(i=e.createCustomElement(n,r)),e.processElement(t,i),i}},{key:"createInnerElement",value:function(t,n,r,i){var o,s;return(!(arguments.length>4&&void 0!==arguments[4]&&arguments[4])||null!=(s=null==(o=null==i?void 0:i[r])?void 0:o.svg)&&s.content)&&e.createSpecificStateElement(t,r,i)||n}}])}(),Ec=function(){function e(){mo(this,e)}return yo(e,null,[{key:"unsetAllCSS",value:function(e,t){var n,r;t.container&&xo.unsetAllCSSMouseStates(e,t.container),null!=(n=t.svg)&&n.styles&&xo.unsetAllCSSMouseStates(e.children[0],t.svg.styles),null!=(r=t.text)&&r.styles&&xo.unsetAllCSSMouseStates(e.children[0],t.text.styles)}},{key:"unsetActionCSS",value:function(e,t){var n,r;t.container&&xo.unsetActivityCSSMouseStates(e,t.container),null!=(n=t.svg)&&n.styles&&xo.unsetActivityCSSMouseStates(e.children[0],t.svg.styles),null!=(r=t.text)&&r.styles&&xo.unsetActivityCSSMouseStates(e.children[0],t.text.styles)}},{key:"setElementsCSS",value:function(e,t,n){var r,i,o,s,a;Object.assign(e.style,null==(r=t.container)?void 0:r[n]),Object.assign(e.children[0].style,null==(o=null==(i=t.svg)?void 0:i.styles)?void 0:o[n]),Object.assign(e.children[0].style,null==(a=null==(s=t.text)?void 0:s.styles)?void 0:a[n])}},{key:"setElementCssUpToState",value:function(t,n,r){e.setElementsCSS(t,n,"default"),"default"!==r&&(e.setElementsCSS(t,n,"hover"),"hover"!==r&&e.setElementsCSS(t,n,"click"))}}])}(),Cc=function(){return yo((function e(t,n,r,i){mo(this,e),this._mouseState={state:"default"},this.elementRef=t,this._customStyles=r,this.position=n,this.dropupText=i}),[{key:"buttonMouseLeave",value:function(e){this._mouseState.state="default",e&&(Ec.unsetAllCSS(this.elementRef,e),Ec.setElementsCSS(this.elementRef,e,"default"))}},{key:"buttonMouseEnter",value:function(e){this._mouseState.state="hover",e&&Ec.setElementsCSS(this.elementRef,e,"hover")}},{key:"buttonMouseUp",value:function(e){e&&Ec.unsetActionCSS(this.elementRef,e),this.buttonMouseEnter(e)}},{key:"buttonMouseDown",value:function(e){this._mouseState.state="click",e&&Ec.setElementsCSS(this.elementRef,e,"click")}},{key:"setEvents",value:function(e){this.elementRef.onmousedown=this.buttonMouseDown.bind(this,e),this.elementRef.onmouseup=this.buttonMouseUp.bind(this,e),this.elementRef.onmouseenter=this.buttonMouseEnter.bind(this,e),this.elementRef.onmouseleave=this.buttonMouseLeave.bind(this,e)}},{key:"unsetCustomStateStyles",value:function(e){if(this._customStyles)for(var t=0;t<e.length;t+=1){var n=e[t],r=n&&this._customStyles[n];r&&Ec.unsetActionCSS(this.elementRef,r)}}},{key:"reapplyStateStyle",value:function(e,t){if(this._customStyles){t&&this.unsetCustomStateStyles(t);var n=this._customStyles[e];n&&Ec.setElementCssUpToState(this.elementRef,n,this._mouseState.state),this.setEvents(n)}}}])}(),Tc=function(){function e(){mo(this,e)}return yo(e,null,[{key:"focusItemWhenOnEdge",value:function(t,n){var r=n?t.children[0]:t.children[t.children.length-1];e.focusSiblingItem(r,t,n,!0)}},{key:"focusSiblingItem",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3]?t:t[r?"nextSibling":"previousSibling"];i?(t.dispatchEvent(new MouseEvent("mouseleave")),i.dispatchEvent(new MouseEvent("mouseenter"))):(t.dispatchEvent(new MouseEvent("mouseleave")),e.focusItemWhenOnEdge(n,r))}}])}(),Ac=function(){function e(){mo(this,e)}return yo(e,null,[{key:"addItemEvents",value:function(e,t,n,r){Zo.add(t,r),t.addEventListener("click",(function(){n.click()})),t.addEventListener("mouseenter",(function(t){e.highlightedItem=t.target})),t.addEventListener("mouseleave",(function(){e.highlightedItem=void 0}))}},{key:"createItemText",value:function(e,t){var n=document.createElement("div");return Object.assign(n.style,t),n.classList.add("dropup-menu-item-text"),n.textContent=e||"File",n}},{key:"createItemIcon",value:function(e,t){var n=document.createElement("div");return Object.assign(n.style,t),n.classList.add("dropup-menu-item-icon"),n.appendChild(e.children[0]),n}},{key:"populateItem",value:function(t,n,r,i){var o=t.children[0];o.classList.contains("text-button")?n.appendChild(e.createItemText(o.textContent,null==i?void 0:i.text)):(n.appendChild(e.createItemIcon(t,null==i?void 0:i.iconContainer)),n.appendChild(e.createItemText(r,null==i?void 0:i.text)))}},{key:"createItem",value:function(t,n,r){var i,o=n.elementRef,s=n.dropupText,a=document.createElement("div");Object.assign(a.style,null==(i=null==r?void 0:r.item)?void 0:i.default),e.populateItem(o,a,s,r),a.classList.add("dropup-menu-item");var l=xo.processStateful((null==r?void 0:r.item)||{},{backgroundColor:"#f3f3f3"},{backgroundColor:"#ebebeb"});return e.addItemEvents(t,a,o,l),a}}])}(),Mc=function(){return yo((function e(t,n){var r,i=this;mo(this,e),this._isOpen=!0,this._styles=n,this.elementRef=e.createElement(null==(r=this._styles)?void 0:r.container),this.close(),setTimeout((function(){return i.addWindowEvents(t)}))}),[{key:"open",value:function(){this.elementRef.style.display="block",this._isOpen=!0}},{key:"close",value:function(){this._isOpen&&(this.elementRef.style.display="none",this._isOpen=!1)}},{key:"toggle",value:function(){this._isOpen?this.close():this.open()}},{key:"addItem",value:function(e){var t=Ac.createItem(this,e,this._styles);this.elementRef.appendChild(t)}},{key:"addWindowEvents",value:function(e){this.clickEvent=this.windowClick.bind(this,e),window.addEventListener("click",this.clickEvent),this.keyDownEvent=this.windowKeyDown.bind(this,e),window.addEventListener("keydown",this.keyDownEvent)}},{key:"windowClick",value:function(e,t){var n;!e.isConnected&&this.clickEvent?window.removeEventListener("click",this.clickEvent):e.parentElement!==(null==(n=t.target.shadowRoot)?void 0:n.children[0])&&this.close()}},{key:"windowKeyDown",value:function(e,t){var n,r,i;!e.isConnected&&this.keyDownEvent?window.removeEventListener("keydown",this.keyDownEvent):this._isOpen&&(t.key===Ao.ESCAPE?(this.close(),null==(n=this.highlightedItem)||n.dispatchEvent(new MouseEvent("mouseleave"))):t.key===Ao.ENTER?(null==(r=this.highlightedItem)||r.click(),null==(i=this.highlightedItem)||i.dispatchEvent(new MouseEvent("mouseleave"))):t.key===Ao.ARROW_DOWN?Tc.focusSiblingItem(this.highlightedItem||this.elementRef.children[this.elementRef.children.length-1],this.elementRef,!0):t.key===Ao.ARROW_UP&&Tc.focusSiblingItem(this.highlightedItem||this.elementRef.children[0],this.elementRef,!1))}}],[{key:"createElement",value:function(e){var t=document.createElement("div");return t.id="dropup-menu",Object.assign(t.style,e),t}}])}(),Ic=function(){function e(t,n){var r,i;mo(this,e);var o=(r=no(this,e,[e.createButtonElement(),void 0,{styles:null==(i=null==n?void 0:n.button)?void 0:i.styles}])).createInnerElements(r._customStyles);return r._menu=new Mc(t,null==n?void 0:n.menu),r.addClickEvent(),r.buttonContainer=e.createButtonContainer(),r.elementRef.appendChild(o.styles),r.buttonContainer.appendChild(r.elementRef),r.elementRef.classList.add("dropup-icon","upload-file-button"),r.elementRef.children[0].id="dropup-icon",r.buttonContainer.appendChild(r._menu.elementRef),r.reapplyStateStyle("styles"),r.addContainerEvents(t),r}return so(e,Cc),yo(e,[{key:"createInnerElements",value:function(t){return{styles:this.createInnerElement(e.createSVGIconElement(),"styles",t)}}},{key:"createInnerElement",value:function(e,t,n){return Sc.createSpecificStateElement(this.elementRef,t,n)||e}},{key:"addClickEvent",value:function(){this.elementRef.onclick=this._menu.toggle.bind(this._menu)}},{key:"addItem",value:function(e){this._menu.addItem(e)}},{key:"addContainerEvents",value:function(e){var t=this;e.addEventListener("click",(function(e){e.target.classList.contains("dropup-icon")||t._menu.close()}))}}],[{key:"createButtonElement",value:function(){var e=document.createElement("div");return e.classList.add("input-button"),e}},{key:"createSVGIconElement",value:function(){return ol.createSVGElement('<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">\n    <path d="M16 0c-8.836 0-16 7.163-16 16s7.163 16 16 16c8.837 0 16-7.163 16-16s-7.163-16-16-16zM16 30.032c-7.72 0-14-6.312-14-14.032s6.28-14 14-14 14 6.28 14 14-6.28 14.032-14 14.032zM23 15h-6v-6c0-0.552-0.448-1-1-1s-1 0.448-1 1v6h-6c-0.552 0-1 0.448-1 1s0.448 1 1 1h6v6c0 0.552 0.448 1 1 1s1-0.448 1-1v-6h6c0.552 0 1-0.448 1-1s-0.448-1-1-1z"></path>\n</svg>')}},{key:"createButtonContainer",value:function(){var e=document.createElement("div");return e.id="dropup-container",e}},{key:"getPosition",value:function(e,t){var n,r;return null!=(n=null==t?void 0:t.button)&&n.position?null==(r=null==t?void 0:t.button)?void 0:r.position:e["outside-left"].length>0&&0===e["outside-right"].length?"outside-right":"outside-left"}}])}(),Lc=function(){function e(){mo(this,e)}return yo(e,null,[{key:"addToDropup",value:function(e,t,n,r){var i=new Ic(n,r);wc.forEach((function(e){var n=t["dropup-menu"].findIndex((function(t){return t.buttonType===e})),r=t["dropup-menu"][n];r&&(i.addItem(r.button),t["dropup-menu"].splice(n,1))}));var o=Ic.getPosition(t,r);xc.addButton(e,i.buttonContainer,o),t[o].push({})}},{key:"addToSideContainer",value:function(e,t){["inside-left","inside-right","outside-left","outside-right"].forEach((function(n){var r=n;t[r].forEach((function(t){xc.addButton(e,t.button.elementRef,r)}))}))}},{key:"setPosition",value:function(e,t,n){var r=ho(ho({},e[t]),{},{buttonType:t});n.push(r),delete e[t]}},{key:"createPositionsObj",value:function(){return{"dropup-menu":[],"outside-left":[],"inside-left":[],"inside-right":[],"outside-right":[]}}},{key:"generatePositions",value:function(t){var n=e.createPositionsObj();Object.keys(t).forEach((function(r){var i,o=null==(i=t[r])?void 0:i.button.position;o&&e.setPosition(t,r,n[o])})),0===n["inside-right"].length&&t.submit&&e.setPosition(t,"submit",n["inside-right"]),0===n["outside-right"].length&&(t.submit?e.setPosition(t,"submit",n["outside-right"]):t.microphone?e.setPosition(t,"microphone",n["outside-right"]):t.camera&&e.setPosition(t,"camera",n["outside-right"])),t.submit&&e.setPosition(t,"submit",0===n["outside-left"].length?n["outside-left"]:n["inside-right"]),t.microphone&&e.setPosition(t,"microphone",0===n["outside-left"].length?n["outside-left"]:n["inside-right"]);var r=Object.keys(t);return r.length>1||n["dropup-menu"].length>0?wc.forEach((function(e){t[e]&&n["dropup-menu"].push(ho(ho({},t[e]),{},{buttonType:e}))})):1===r.length&&e.setPosition(t,r[0],0===n["outside-right"].length?n["outside-right"]:n["outside-left"]),n}},{key:"addButtons",value:function(t,n,r,i){var o=e.generatePositions(n);return e.addToSideContainer(t,o),o["dropup-menu"].length>0&&e.addToDropup(t,o,r,i),o}}])}(),Oc={images:{id:"upload-images-icon",svgString:'<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n  <path d="M20,15.2928932 L20,5.5 C20,4.67157288 19.3284271,4 18.5,4 L5.5,4 C4.67157288,4 4,4.67157288 4,5.5 L4,12.2928932 L7.14644661,9.14644661 C7.34170876,8.95118446 7.65829124,8.95118446 7.85355339,9.14644661 L13.5,14.7928932 L16.1464466,12.1464466 C16.3417088,11.9511845 16.6582912,11.9511845 16.8535534,12.1464466 L20,15.2928932 Z M20,16.7071068 L16.5,13.2071068 L13.8535534,15.8535534 C13.6582912,16.0488155 13.3417088,16.0488155 13.1464466,15.8535534 L7.5,10.2071068 L4,13.7071068 L4,18.5 C4,19.3284271 4.67157288,20 5.5,20 L18.5,20 C19.3284271,20 20,19.3284271 20,18.5 L20,16.7071068 Z M3,5.5 C3,4.11928813 4.11928813,3 5.5,3 L18.5,3 C19.8807119,3 21,4.11928813 21,5.5 L21,18.5 C21,19.8807119 19.8807119,21 18.5,21 L5.5,21 C4.11928813,21 3,19.8807119 3,18.5 L3,5.5 Z M15,6 L17,6 C17.5522847,6 18,6.44771525 18,7 L18,9 C18,9.55228475 17.5522847,10 17,10 L15,10 C14.4477153,10 14,9.55228475 14,9 L14,7 C14,6.44771525 14.4477153,6 15,6 Z M15,7 L15,9 L17,9 L17,7 L15,7 Z"/>\n</svg>\n',dropupText:"Image"},gifs:{id:"upload-gifs-icon",svgString:'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 5.9266752 5.6408391" height="21.31971" width="22.4">\n  <g>\n    <path d="m 5.2564627,1.548212 c -3.1136005,-0.4796804 -1.5568006,-0.2398402 0,0 z M 2.0001198,2.0922063 c 0.1556781,0 0.2657489,0.020893 0.3917849,0.080366 0.081154,0.038347 0.1153492,0.134065 0.076377,0.2138602 -0.038973,0.07979 -0.1363527,0.1134129 -0.2175069,0.075091 -0.078199,-0.036919 -0.1407455,-0.048792 -0.250655,-0.048792 -0.2260486,0 -0.3921482,0.2042182 -0.3921482,0.4801409 0,0.2761822 0.1663188,0.4810688 0.3921482,0.4810688 0.1117901,0 0.2064255,-0.046133 0.255659,-0.1284198 l 0.00162,-0.00389 V 3.0534032 l -0.098011,1.75e-4 c -0.081844,0 -0.1495979,-0.059305 -0.1612403,-0.1365887 l -0.00175,-0.023683 c 0,-0.08047 0.060311,-0.1470874 0.1389194,-0.1585331 l 0.024085,-0.00195 h 0.2612303 c 0.081842,0 0.149598,0.059305 0.1612404,0.1365891 l 0.00175,0.023683 -3.398e-4,0.3968809 v 0 l -0.00168,0.014211 v 0 l -0.00553,0.023034 v 0 l -0.00532,0.014145 c -0.098178,0.22826 -0.3236506,0.3528713 -0.5706303,0.3528713 -0.4240855,0 -0.7181621,-0.3622714 -0.7181621,-0.8016063 0,-0.4391857 0.2940275,-0.8006848 0.7181621,-0.8006848 z m 1.2034759,0.031275 c 0.081843,0 0.1495977,0.059305 0.1612403,0.1365891 l 0.00175,0.023683 v 1.2211775 c 0,0.088516 -0.07298,0.1602721 -0.1630073,0.1602721 -0.081841,0 -0.1495972,-0.059305 -0.1612397,-0.1365892 L 3.040589,3.5049308 V 2.2837527 c 0,-0.088516 0.07298,-0.1602721 0.1630067,-0.1602714 z m 0.7813442,0 0.5209469,0.00195 c 0.090025,3.048e-4 0.1627543,0.072306 0.1624458,0.1608234 -2.809e-4,0.08047 -0.06083,0.1468798 -0.1394772,0.158066 l -0.024092,0.00195 -0.3575326,-0.0013 v 0.4497782 l 0.2928918,2.27e-4 c 0.081842,0 0.1495979,0.059305 0.1612403,0.136589 l 0.00175,0.023683 c 0,0.080469 -0.06031,0.1470871 -0.1389193,0.1585393 l -0.024092,0.00195 -0.2928919,-2.336e-4 1.563e-4,0.2860316 c 0,0.080471 -0.06031,0.1470873 -0.1389193,0.1585395 l -0.024085,0.00195 c -0.081843,0 -0.1495979,-0.059305 -0.1612403,-0.1365826 l -0.00175,-0.023691 V 2.2841354 c 2.798e-4,-0.08047 0.060829,-0.1468797 0.1394758,-0.1580594 z"/>\n    <path d="m 5.0894191,1.0943261 c 0,-0.21918999 -0.177687,-0.39686999 -0.396876,-0.39686999 h -3.43959 c -0.2191879,0 -0.391262,0.1777519 -0.3968759,0.39686999 l -0.027082,3.4379266 c 0.040152,0.2939927 0.4235456,0.409415 0.4235456,0.409415 l 3.4785583,-0.00851 c 0,0 0.3008506,-0.1402998 0.3236271,-0.4201576 0.042911,-0.5272495 0.034693,-1.6106146 0.034693,-3.4186761 z m -4.49792494,0 c 0,-0.36530999 0.29614504,-0.66145999 0.66145894,-0.66145999 h 3.43959 c 0.365314,0 0.66146,0.29615 0.66146,0.66145999 v 3.43959 c 0,0.36532 -0.296146,0.66146 -0.66146,0.66146 h -3.43959 c -0.3653139,0 -0.66145894,-0.29614 -0.66145894,-0.66146 z"/>\n  </g>\n</svg>\n',dropupText:"GIF"},audio:{id:"upload-audio-icon",svgString:'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-49.49 -49.49 593.87 593.87" stroke-width="3.95908" transform="rotate(0)">\n  <g stroke-width="0"></g>\n  <g stroke-linecap="round" stroke-linejoin="round" stroke-width="0.98977"></g>\n  <g>\n    <g>\n      <g>\n        <path d="M163.205,76.413v293.301c-3.434-3.058-7.241-5.867-11.486-8.339c-21.38-12.452-49.663-15.298-77.567-7.846 c-49.038,13.096-80.904,54.519-71.038,92.337c4.019,15.404,14.188,28.221,29.404,37.087c13.553,7.894,29.87,11.933,47.115,11.933 c9.962,0,20.231-1.356,30.447-4.087c42.74-11.406,72.411-44.344,72.807-77.654h0.011v-0.162c0.002-0.166,0-0.331,0-0.496V187.072 l290.971-67.3v178.082c-3.433-3.055-7.238-5.863-11.481-8.334c-21.385-12.452-49.654-15.308-77.567-7.846 c-49.038,13.087-80.904,54.519-71.038,92.356c4.019,15.385,14.183,28.212,29.404,37.067c13.548,7.894,29.875,11.933,47.115,11.933 c9.962,0,20.231-1.356,30.452-4.087c42.74-11.413,72.411-44.346,72.804-77.654h0.004v-0.065c0.003-0.236,0.001-0.469,0-0.704V0 L163.205,76.413z M104.999,471.779c-22.543,6.038-45.942,3.846-62.572-5.846c-10.587-6.163-17.591-14.817-20.255-25.038 c-7.144-27.375,18.452-58.029,57.062-68.346c8.409-2.25,16.938-3.346,25.188-3.346c13.87,0,26.962,3.115,37.389,9.192 c10.587,6.163,17.591,14.817,20.255,25.029c0.809,3.102,1.142,6.248,1.139,9.4v0.321h0.014 C162.99,437.714,139.082,462.678,104.999,471.779z M182.898,166.853V92.067l290.971-67.298v74.784L182.898,166.853z M415.677,399.923c-22.558,6.038-45.942,3.837-62.587-5.846c-10.587-6.163-17.587-14.817-20.25-25.019 c-7.144-27.385,18.452-58.058,57.058-68.365c8.414-2.25,16.942-3.346,25.192-3.346c13.875,0,26.962,3.115,37.385,9.192 c10.596,6.163,17.596,14.817,20.26,25.029v0.01c0.796,3.05,1.124,6.144,1.135,9.244v0.468h0.02 C473.668,365.851,449.763,390.814,415.677,399.923z">\n        </path>\n      </g>\n    </g>\n  </g>\n</svg>',dropupText:"Audio"},mixedFiles:{id:"upload-mixed-files-icon",svgString:'<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<title>file</title>\n<path d="M20 10.9696L11.9628 18.5497C10.9782 19.4783 9.64274 20 8.25028 20C6.85782 20 5.52239 19.4783 4.53777 18.5497C3.55315 17.6211 3 16.3616 3 15.0483C3 13.7351 3.55315 12.4756 4.53777 11.547L12.575 3.96687C13.2314 3.34779 14.1217 3 15.05 3C15.9783 3 16.8686 3.34779 17.525 3.96687C18.1814 4.58595 18.5502 5.4256 18.5502 6.30111C18.5502 7.17662 18.1814 8.01628 17.525 8.63535L9.47904 16.2154C9.15083 16.525 8.70569 16.6989 8.24154 16.6989C7.77738 16.6989 7.33224 16.525 7.00403 16.2154C6.67583 15.9059 6.49144 15.4861 6.49144 15.0483C6.49144 14.6106 6.67583 14.1907 7.00403 13.8812L14.429 6.88674" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>',dropupText:"File"}},Rc=function(){function e(t){var n;return mo(this,e),"dropup-menu"===(null==t?void 0:t.position)&&(t.position="outside-right"),(n=no(this,e,[e.createMicrophoneElement(),null==t?void 0:t.position,t])).isActive=!1,n._innerElements=n.createInnerElements(n._customStyles),n.changeToDefault(),n}return so(e,Cc),yo(e,[{key:"createInnerElements",value:function(t){var n=e.createSVGIconElement();return{default:this.createInnerElement(n,"default",t),active:this.createInnerElement(n,"active",t),unsupported:this.createInnerElement(n,"unsupported",t),commandMode:this.createInnerElement(n,"commandMode",t)}}},{key:"createInnerElement",value:function(e,t,n){return Sc.createSpecificStateElement(this.elementRef,t,n)||e}},{key:"changeToActive",value:function(){this.elementRef.replaceChildren(this._innerElements.active),this.toggleIconFilter("active"),this.reapplyStateStyle("active",["default","commandMode"]),this.isActive=!0}},{key:"changeToDefault",value:function(){this.elementRef.replaceChildren(this._innerElements.default),this.toggleIconFilter("default"),this.reapplyStateStyle("default",["active","commandMode"]),this.isActive=!1}},{key:"changeToCommandMode",value:function(){this.elementRef.replaceChildren(this._innerElements.unsupported),this.toggleIconFilter("command"),this.reapplyStateStyle("commandMode",["active"])}},{key:"changeToUnsupported",value:function(){this.elementRef.replaceChildren(this._innerElements.unsupported),this.elementRef.classList.add("unsupported-microphone"),this.reapplyStateStyle("unsupported",["active"])}},{key:"toggleIconFilter",value:function(e){var t=this.elementRef.children[0];if("svg"===t.tagName.toLocaleLowerCase())switch(e){case"default":t.classList.remove("active-microphone-icon","command-microphone-icon"),t.classList.add("default-microphone-icon");break;case"active":t.classList.remove("default-microphone-icon","command-microphone-icon"),t.classList.add("active-microphone-icon");break;case"command":t.classList.remove("active-microphone-icon","default-microphone-icon"),t.classList.add("command-microphone-icon")}}}],[{key:"createMicrophoneElement",value:function(){var e=document.createElement("div");return e.id="microphone-button",e.classList.add("input-button"),e}},{key:"createSVGIconElement",value:function(){var e=ol.createSVGElement('<?xml version="1.0" encoding="iso-8859-1"?>\n<svg height="1.4em" width="1.4em" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n\t viewBox="0 0 490.9 490.9" xml:space="preserve">\n\t<g>\n\t\t<g>\n\t\t\t<path d="M245.5,322.9c53,0,96.2-43.2,96.2-96.2V96.2c0-53-43.2-96.2-96.2-96.2s-96.2,43.2-96.2,96.2v130.5\n\t\t\t\tC149.3,279.8,192.5,322.9,245.5,322.9z M173.8,96.2c0-39.5,32.2-71.7,71.7-71.7s71.7,32.2,71.7,71.7v130.5\n\t\t\t\tc0,39.5-32.2,71.7-71.7,71.7s-71.7-32.2-71.7-71.7V96.2z"/>\n\t\t\t<path d="M94.4,214.5c-6.8,0-12.3,5.5-12.3,12.3c0,85.9,66.7,156.6,151.1,162.8v76.7h-63.9c-6.8,0-12.3,5.5-12.3,12.3\n\t\t\t\ts5.5,12.3,12.3,12.3h152.3c6.8,0,12.3-5.5,12.3-12.3s-5.5-12.3-12.3-12.3h-63.9v-76.7c84.4-6.3,151.1-76.9,151.1-162.8\n\t\t\t\tc0-6.8-5.5-12.3-12.3-12.3s-12.3,5.5-12.3,12.3c0,76.6-62.3,138.9-138.9,138.9s-138.9-62.3-138.9-138.9\n\t\t\t\tC106.6,220,101.2,214.5,94.4,214.5z"/>\n\t\t</g>\n\t</g>\n</svg>\n');return e.id="microphone-icon",e}}])}(),Pc={},Nc={},Dc={},Fc={},jc={};Object.defineProperty(jc,"__esModule",{value:!0}),jc.Text=void 0;var Bc=function(){function e(){mo(this,e)}return yo(e,null,[{key:"capitalize",value:function(t){return t.replace(e.FIRST_CHAR_REGEX,(function(e){return e.toUpperCase()}))}},{key:"lineBreak",value:function(t){return t.replace(e.DOUBLE_LINE,"<p></p>").replace(e.ONE_LINE,"<br>")}},{key:"isCharDefined",value:function(e){return void 0!==e&&""!==e&&" "!==e&&"\n"!==e&&""!==e}},{key:"breakupIntoWordsArr",value:function(e){return e.split(/(\W+)/)}}])}();jc.Text=Bc,Bc.FIRST_CHAR_REGEX=/\S/,Bc.DOUBLE_LINE=/\n\n/g,Bc.ONE_LINE=/\n/g,Object.defineProperty(Fc,"__esModule",{value:!0}),Fc.Translate=void 0;var Uc=jc,Hc=function(){return yo((function e(){mo(this,e)}),null,[{key:"translate",value:function(e,t){for(var n=Uc.Text.breakupIntoWordsArr(e),r=0;r<n.length;r+=1)t[n[r]]&&(n[r]=t[n[r]]);return n.join("")}}])}();Fc.Translate=Hc,Object.defineProperty(Dc,"__esModule",{value:!0}),Dc.WebSpeechTranscript=void 0;var qc=Fc,Vc=function(){return yo((function e(){mo(this,e)}),null,[{key:"extract",value:function(e,t,n){for(var r="",i=e.resultIndex;i<e.results.length;++i){var o=e.results[i][0].transcript;n&&(o=qc.Translate.translate(o,n)),e.results[i].isFinal?t+=o:r+=o}return{interimTranscript:r,finalTranscript:t,newText:r||t}}},{key:"extractSafari",value:function(e,t,n){for(var r="",i=e.resultIndex;i<e.results.length;++i){var o=e.results[i][0].transcript;n&&(o=qc.Translate.translate(o,n)),r+=o}return{interimTranscript:"",finalTranscript:r,newText:r}}}])}();Dc.WebSpeechTranscript=Vc;var zc={};Object.defineProperty(zc,"__esModule",{value:!0}),zc.Browser=void 0;var Gc=yo((function e(){mo(this,e)}));zc.Browser=Gc,Gc.IS_SAFARI=function(){return void 0===Gc._IS_SAFARI&&(Gc._IS_SAFARI=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),Gc._IS_SAFARI};var Wc={},Kc={};Object.defineProperty(Kc,"__esModule",{value:!0}),Kc.EventListeners=void 0;var Jc=function(){function e(){mo(this,e)}return yo(e,null,[{key:"getElementIfFocusedOnAvailable",value:function(e,t){return Array.isArray(e)?e.find((function(e){return t===e})):t===e?e:void 0}},{key:"keyDownWindow",value:function(t){var n=this;t.element&&e.getElementIfFocusedOnAvailable(t.element,document.activeElement)&&(null!==e.KEY_DOWN_TIMEOUT&&clearTimeout(e.KEY_DOWN_TIMEOUT),e.KEY_DOWN_TIMEOUT=setTimeout((function(){e.KEY_DOWN_TIMEOUT=null,n.resetRecording(t)}),500))}},{key:"mouseDownWindow",value:function(t,n){this.mouseDownElement=e.getElementIfFocusedOnAvailable(t,n.target)}},{key:"mouseUpWindow",value:function(e){this.mouseDownElement&&this.resetRecording(e),this.mouseDownElement=void 0}},{key:"add",value:function(t,n){var r=void 0===(null==n?void 0:n.insertInCursorLocation)||(null==n?void 0:n.insertInCursorLocation);null!=n&&n.element&&r&&(t.mouseDownEvent=e.mouseDownWindow.bind(t,n.element),document.addEventListener("mousedown",t.mouseDownEvent),t.mouseUpEvent=e.mouseUpWindow.bind(t,n),document.addEventListener("mouseup",t.mouseUpEvent),t.keyDownEvent=e.keyDownWindow.bind(t,n),document.addEventListener("keydown",t.keyDownEvent))}},{key:"remove",value:function(e){document.removeEventListener("mousedown",e.mouseDownEvent),document.removeEventListener("mouseup",e.mouseUpEvent),document.removeEventListener("keydown",e.keyDownEvent)}}])}();Kc.EventListeners=Jc,Jc.KEY_DOWN_TIMEOUT=null;var Xc={};Object.defineProperty(Xc,"__esModule",{value:!0}),Xc.PreResultUtils=void 0;var Yc=function(){return yo((function e(){mo(this,e)}),null,[{key:"process",value:function(e,t,n,r,i){var o=null==r?void 0:r(t,n);return!!o&&(setTimeout((function(){o.restart?e.resetRecording(i):o.stop&&e.stop()})),(o.stop||o.restart)&&o.removeNewText)}}])}();Xc.PreResultUtils=Yc;var $c={},Zc={};Object.defineProperty(Zc,"__esModule",{value:!0}),Zc.AutoScroll=void 0;var Qc=function(){function e(){mo(this,e)}return yo(e,null,[{key:"changeStateIfNeeded",value:function(e,t){t&&!e.isCursorAtEnd&&(e.endPadding="",e.scrollingSpan.innerHTML="&nbsp;")}},{key:"scrollGeneric",value:function(e,t){e.isCursorAtEnd?t.scrollTop=t.scrollHeight:e.scrollingSpan.scrollIntoView({block:"nearest"})}},{key:"scrollSafariPrimitiveToEnd",value:function(e){e.scrollLeft=e.scrollWidth,e.scrollTop=e.scrollHeight}},{key:"isElementOverflown",value:function(e){return e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth}},{key:"isRequired",value:function(t,n){return t&&e.isElementOverflown(n)}}])}();Zc.AutoScroll=Qc;var eu={};Object.defineProperty(eu,"__esModule",{value:!0}),eu.Elements=void 0;var tu=function(){return yo((function e(){mo(this,e)}),null,[{key:"isPrimitiveElement",value:function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName}},{key:"createInterimSpan",value:function(){var e=document.createElement("span");return e.style.color="grey",e.style.pointerEvents="none",e}},{key:"createGenericSpan",value:function(){var e=document.createElement("span");return e.style.pointerEvents="none",e}},{key:"appendSpans",value:function(e,t){if(e.spansPopulated=!0,e.insertInCursorLocation&&document.activeElement===t){var n=window.getSelection();if(null!=n&&n.focusNode){var r=n.getRangeAt(0);return r.insertNode(e.scrollingSpan),r.insertNode(e.interimSpan),r.insertNode(e.finalSpan),r.collapse(!1),n.removeAllRanges(),void n.addRange(r)}}t.appendChild(e.finalSpan),t.appendChild(e.interimSpan),t.appendChild(e.scrollingSpan)}},{key:"applyCustomColors",value:function(e,t){t.interim&&(e.interimSpan.style.color=t.interim),t.final&&(e.finalSpan.style.color=t.final)}},{key:"isInsideShadowDOM",value:function(e){return e.getRootNode()instanceof ShadowRoot}}])}();eu.Elements=tu;var nu={};Object.defineProperty(nu,"__esModule",{value:!0}),nu.Cursor=void 0;var ru=function(){function e(){mo(this,e)}return yo(e,null,[{key:"setOffsetForGeneric",value:function(t,n){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=0,o=0;o<t.childNodes.length;o+=1){var s=t.childNodes[o];if(s.childNodes.length>0){var a=e.setOffsetForGeneric(s,n,r);if(-1===a)return-1;r+=a}else if(null!==s.textContent){if(r+s.textContent.length>n){var l=document.createRange();l.setStart(s,n-r),l.collapse(!0);var c=window.getSelection();return null==c||c.removeAllRanges(),null==c||c.addRange(l),t.focus(),-1}r+=s.textContent.length,i+=s.textContent.length}}return i}},{key:"focusEndOfGeneric",value:function(e){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var n=window.getSelection();n&&(n.removeAllRanges(),n.addRange(t))}},{key:"setOffsetForSafariGeneric",value:function(t,n){var r=window.getSelection();if(r){var i=e.getGenericElementCursorOffset(t,r,!0);console.log(i),setTimeout((function(){}),100),e.setOffsetForGeneric(t,i+n)}}},{key:"setOffsetForPrimitive",value:function(e,t,n){n&&e.blur(),e.setSelectionRange(t,t),e.focus()}},{key:"getGenericElementCursorOffset",value:function(e,t,n){var r=0;if(t.rangeCount>0){var i=t.getRangeAt(0),o=i.cloneRange();o.selectNodeContents(e),n?o.setEnd(i.startContainer,i.startOffset):o.setEnd(i.endContainer,i.endOffset),r=o.toString().length}return r}}])}();nu.Cursor=ru,Object.defineProperty($c,"__esModule",{value:!0}),$c.CommandUtils=void 0;var iu=Zc,ou=eu,su=zc,au=nu,lu=jc,cu=function(){function e(){mo(this,e)}return yo(e,null,[{key:"processCommand",value:function(e,t){return(!t||!t.caseSensitive)&&(e=e.toLowerCase()),!1===(null==t?void 0:t.substrings)?lu.Text.breakupIntoWordsArr(e):e}},{key:"process",value:function(t){var n;return!0===(null===(n=t.settings)||void 0===n?void 0:n.caseSensitive)?t:Object.keys(t).reduce((function(n,r){var i=t[r];return n[r]="string"==typeof i?e.processCommand(i,t.settings):i,n}),{})}},{key:"toggleCommandModeOn",value:function(e){var t;e.isWaitingForCommand=!0,null===(t=e.onCommandModeTrigger)||void 0===t||t.call(e,!0)}},{key:"toggleCommandModeOff",value:function(e){var t;e.isWaitingForCommand&&(null===(t=e.onCommandModeTrigger)||void 0===t||t.call(e,!1),e.isWaitingForCommand=!1)}},{key:"setText",value:function(t,n,r,i){e.toggleCommandModeOff(t),ou.Elements.isPrimitiveElement(i)?(i.value=r,t.isTargetInShadow||au.Cursor.setOffsetForPrimitive(i,r.length,!0),su.Browser.IS_SAFARI()&&t.autoScroll&&iu.AutoScroll.scrollSafariPrimitiveToEnd(i)):(i.textContent=r,t.isTargetInShadow||au.Cursor.focusEndOfGeneric(i),setTimeout((function(){return iu.AutoScroll.scrollGeneric(t,i)}))),t.resetRecording(n)}},{key:"checkIfMatchesSubstring",value:function(e,t){return t.includes(e)}},{key:"checkIfMatchesWord",value:function(e,t,n){for(var r=e,i=n.length-1;i>=0;i-=1){for(var o=i,s=r.length-1;n[o]===r[s]&&s>=0;)o-=1,s-=1;if(s<0)return!0}return!1}},{key:"execCommand",value:function(t,n,r,i,o){var s,a,l,c=t.commands;if(c&&i&&r){var u=!0===(null===(s=c.settings)||void 0===s?void 0:s.caseSensitive)?n:n.toLowerCase(),d=lu.Text.breakupIntoWordsArr(u),p=!1===(null===(a=c.settings)||void 0===a?void 0:a.substrings)?e.checkIfMatchesWord:e.checkIfMatchesSubstring;if(c.commandMode&&p(c.commandMode,u,d))return t.setInterimColorToFinal(),setTimeout((function(){return e.toggleCommandModeOn(t)})),{doNotProcessTranscription:!1};if(!c.commandMode||t.isWaitingForCommand){if(c.stop&&p(c.stop,u,d))return e.toggleCommandModeOff(t),setTimeout((function(){return t.stop()})),{doNotProcessTranscription:!1};if(c.pause&&p(c.pause,u,d))return e.toggleCommandModeOff(t),t.setInterimColorToFinal(),setTimeout((function(){var e;t.isPaused=!0,null===(e=t.onPauseTrigger)||void 0===e||e.call(t,!0)})),{doNotProcessTranscription:!1};if(c.resume&&p(c.resume,u,d))return t.isPaused=!1,null===(l=t.onPauseTrigger)||void 0===l||l.call(t,!1),e.toggleCommandModeOff(t),t.resetRecording(r),{doNotProcessTranscription:!0};if(c.reset&&p(c.reset,u,d))return void 0!==o&&e.setText(t,r,o,i),{doNotProcessTranscription:!0};if(c.removeAllText&&p(c.removeAllText,u,d))return e.setText(t,r,"",i),{doNotProcessTranscription:!0}}}}}])}();$c.CommandUtils=cu;var uu={};Object.defineProperty(uu,"__esModule",{value:!0}),uu.Highlight=void 0;var du=eu,pu=nu,hu=function(){function e(){mo(this,e)}return yo(e,null,[{key:"setStateForPrimitive",value:function(e,t){var n,r;null!==t.selectionStart&&(n=t.selectionStart),null!==t.selectionEnd&&(r=t.selectionEnd),e.isHighlighted=n!==r}},{key:"setStateForGeneric",value:function(e,t){var n=window.getSelection();if(null!=n&&n.focusNode){var r=pu.Cursor.getGenericElementCursorOffset(t,n,!0),i=pu.Cursor.getGenericElementCursorOffset(t,n,!1);e.isHighlighted=r!==i}}},{key:"setState",value:function(t,n){document.activeElement===n&&(du.Elements.isPrimitiveElement(n)?e.setStateForPrimitive(t,n):e.setStateForGeneric(t,n))}},{key:"removeForGeneric",value:function(e,t){var n=window.getSelection();if(n){var r=pu.Cursor.getGenericElementCursorOffset(t,n,!0);n.deleteFromDocument(),pu.Cursor.setOffsetForGeneric(t,r),e.isHighlighted=!1}}},{key:"removeForPrimitive",value:function(e,t){var n=t.selectionStart,r=t.selectionEnd,i=t.value;if(n&&r){var o=i.substring(0,n)+i.substring(r);t.value=o,pu.Cursor.setOffsetForPrimitive(t,n,e.autoScroll)}e.isHighlighted=!1}}])}();uu.Highlight=hu;var fu={};Object.defineProperty(fu,"__esModule",{value:!0}),fu.Padding=void 0;var vu=eu,mu=nu,gu=jc,yu=function(){function e(){mo(this,e)}return yo(e,null,[{key:"setStateForPrimitiveElement",value:function(e,t){if(document.activeElement===t&&null!==t.selectionStart){var n=t.selectionStart,r=t.value[n-1],i=null===t.selectionEnd?n:t.selectionEnd,o=t.value[i];return gu.Text.isCharDefined(r)&&(e.startPadding=" ",e.numberOfSpacesBeforeNewText=1),gu.Text.isCharDefined(o)&&(e.endPadding=" ",e.numberOfSpacesAfterNewText=1),void(e.isCursorAtEnd=t.value.length===i)}var s=t.value[t.value.length-1];gu.Text.isCharDefined(s)&&(e.startPadding=" ",e.numberOfSpacesBeforeNewText=1),e.isCursorAtEnd=!0}},{key:"setStateForGenericElement",value:function(e,t){var n,r,i;if(document.activeElement===t){var o=window.getSelection();if(null!=o&&o.focusNode){var s=mu.Cursor.getGenericElementCursorOffset(t,o,!0),a=null===(n=t.textContent)||void 0===n?void 0:n[s-1],l=mu.Cursor.getGenericElementCursorOffset(t,o,!1),c=null===(r=t.textContent)||void 0===r?void 0:r[l];return gu.Text.isCharDefined(a)&&(e.startPadding=" "),gu.Text.isCharDefined(c)&&(e.endPadding=" "),void(e.isCursorAtEnd=(null===(i=t.textContent)||void 0===i?void 0:i.length)===l)}}var u=t.innerText.charAt(t.innerText.length-1);gu.Text.isCharDefined(u)&&(e.startPadding=" "),e.isCursorAtEnd=!0}},{key:"setState",value:function(t,n){vu.Elements.isPrimitiveElement(n)?e.setStateForPrimitiveElement(t,n):e.setStateForGenericElement(t,n)}},{key:"adjustStateAfterRecodingPrimitiveElement",value:function(e,t){e.primitiveTextRecorded=!0,e.insertInCursorLocation&&document.activeElement===t&&(null!==t.selectionEnd&&(e.endPadding=e.endPadding+t.value.slice(t.selectionEnd)),null!==t.selectionStart)?e.startPadding=t.value.slice(0,t.selectionStart)+e.startPadding:e.startPadding=t.value+e.startPadding}},{key:"adjustSateForNoTextPrimitiveElement",value:function(e){1===e.numberOfSpacesBeforeNewText&&(e.startPadding=e.startPadding.substring(0,e.startPadding.length-1),e.numberOfSpacesBeforeNewText=0),1===e.numberOfSpacesAfterNewText&&(e.endPadding=e.endPadding.substring(1),e.numberOfSpacesAfterNewText=0)}}])}();fu.Padding=yu,Object.defineProperty(Wc,"__esModule",{value:!0}),Wc.Speech=void 0;var bu=Kc,_u=Xc,ku=$c,xu=Zc,wu=uu,Su=eu,Eu=fu,Cu=zc,Tu=nu,Au=jc,Mu=function(){return yo((function e(){mo(this,e),this.finalTranscript="",this.interimSpan=Su.Elements.createInterimSpan(),this.finalSpan=Su.Elements.createGenericSpan(),this.scrollingSpan=Su.Elements.createGenericSpan(),this.isCursorAtEnd=!1,this.spansPopulated=!1,this.startPadding="",this.endPadding="",this.numberOfSpacesBeforeNewText=0,this.numberOfSpacesAfterNewText=0,this.isHighlighted=!1,this.primitiveTextRecorded=!1,this.recognizing=!1,this._displayInterimResults=!0,this.insertInCursorLocation=!0,this.autoScroll=!0,this.isRestarting=!1,this.isPaused=!1,this.isWaitingForCommand=!1,this.isTargetInShadow=!1,this.cannotBeStopped=!1,this.resetState()}),[{key:"prepareBeforeStart",value:function(e){var t,n;if(null!=e&&e.element)if(bu.EventListeners.add(this,e),Array.isArray(e.element)){var r=e.element.find((function(e){return e===document.activeElement}))||e.element[0];if(!r)return;this.prepare(r)}else this.prepare(e.element);void 0!==(null==e?void 0:e.displayInterimResults)&&(this._displayInterimResults=e.displayInterimResults),null!=e&&e.textColor&&(this._finalTextColor=null===(t=null==e?void 0:e.textColor)||void 0===t?void 0:t.final,Su.Elements.applyCustomColors(this,e.textColor)),void 0!==(null==e?void 0:e.insertInCursorLocation)&&(this.insertInCursorLocation=e.insertInCursorLocation),void 0!==(null==e?void 0:e.autoScroll)&&(this.autoScroll=e.autoScroll),this._onResult=null==e?void 0:e.onResult,this._onPreResult=null==e?void 0:e.onPreResult,this._onStart=null==e?void 0:e.onStart,this._onStop=null==e?void 0:e.onStop,this._onError=null==e?void 0:e.onError,this.onCommandModeTrigger=null==e?void 0:e.onCommandModeTrigger,this.onPauseTrigger=null==e?void 0:e.onPauseTrigger,this._options=e,null!==(n=this._options)&&void 0!==n&&n.commands&&(this.commands=ku.CommandUtils.process(this._options.commands))}},{key:"prepare",value:function(e){Eu.Padding.setState(this,e),wu.Highlight.setState(this,e),this.isTargetInShadow=Su.Elements.isInsideShadowDOM(e),Su.Elements.isPrimitiveElement(e)?(this._primitiveElement=e,this._originalText=this._primitiveElement.value):(this._genericElement=e,this._originalText=this._genericElement.textContent)}},{key:"resetRecording",value:function(e){this.isRestarting=!0,this.stop(!0),this.resetState(!0),this.start(e,!0)}},{key:"updateElements",value:function(e,t,n){var r,i=Au.Text.capitalize(t);if(this.finalTranscript!==i||""!==e){_u.PreResultUtils.process(this,n,""===e,this._onPreResult,this._options)&&(e="",n="");var o=this.commands&&ku.CommandUtils.execCommand(this,n,this._options,this._primitiveElement||this._genericElement,this._originalText);if(o){if(o.doNotProcessTranscription)return;e="",n=""}if(!this.isPaused&&!this.isWaitingForCommand){null===(r=this._onResult)||void 0===r||r.call(this,n,""===e),this.finalTranscript=i,this._displayInterimResults||(e="");var s=""===this.finalTranscript&&""===e;this._primitiveElement?this.updatePrimitiveElement(this._primitiveElement,e,s):this._genericElement&&this.updateGenericElement(this._genericElement,e,s)}}}},{key:"updatePrimitiveElement",value:function(e,t,n){this.isHighlighted&&wu.Highlight.removeForPrimitive(this,e),this.primitiveTextRecorded||Eu.Padding.adjustStateAfterRecodingPrimitiveElement(this,e),n&&Eu.Padding.adjustSateForNoTextPrimitiveElement(this);var r=this.startPadding+this.finalTranscript+t;if(e.value=r+this.endPadding,!this.isTargetInShadow){var i=r.length+this.numberOfSpacesAfterNewText;Tu.Cursor.setOffsetForPrimitive(e,i,this.autoScroll)}this.autoScroll&&Cu.Browser.IS_SAFARI()&&this.isCursorAtEnd&&xu.AutoScroll.scrollSafariPrimitiveToEnd(e)}},{key:"updateGenericElement",value:function(e,t,n){this.isHighlighted&&wu.Highlight.removeForGeneric(this,e),this.spansPopulated||Su.Elements.appendSpans(this,e);var r=(n?"":this.startPadding)+Au.Text.lineBreak(this.finalTranscript);this.finalSpan.innerHTML=r;var i=xu.AutoScroll.isRequired(this.autoScroll,e);xu.AutoScroll.changeStateIfNeeded(this,i);var o=Au.Text.lineBreak(t)+(n?"":this.endPadding);this.interimSpan.innerHTML=o,Cu.Browser.IS_SAFARI()&&this.insertInCursorLocation&&Tu.Cursor.setOffsetForSafariGeneric(e,r.length+o.length),i&&xu.AutoScroll.scrollGeneric(this,e),n&&(this.scrollingSpan.innerHTML="")}},{key:"finalise",value:function(e){this._genericElement&&(e?(this.finalSpan=Su.Elements.createGenericSpan(),this.setInterimColorToFinal(),this.interimSpan=Su.Elements.createInterimSpan(),this.scrollingSpan=Su.Elements.createGenericSpan()):this._genericElement.textContent=this._genericElement.textContent,this.spansPopulated=!1),bu.EventListeners.remove(this)}},{key:"setInterimColorToFinal",value:function(){this.interimSpan.style.color=this._finalTextColor||"black"}},{key:"resetState",value:function(e){this._primitiveElement=void 0,this._genericElement=void 0,this.finalTranscript="",this.finalSpan.innerHTML="",this.interimSpan.innerHTML="",this.scrollingSpan.innerHTML="",this.startPadding="",this.endPadding="",this.isHighlighted=!1,this.primitiveTextRecorded=!1,this.numberOfSpacesBeforeNewText=0,this.numberOfSpacesAfterNewText=0,e||(this.stopTimeout=void 0)}},{key:"setStateOnStart",value:function(){var e;this.recognizing=!0,this.isRestarting?this.isRestarting=!1:null===(e=this._onStart)||void 0===e||e.call(this)}},{key:"setStateOnStop",value:function(){var e;this.recognizing=!1,this.isRestarting||null===(e=this._onStop)||void 0===e||e.call(this)}},{key:"setStateOnError",value:function(e){var t;null===(t=this._onError)||void 0===t||t.call(this,e),this.recognizing=!1}}])}();Wc.Speech=Mu,Object.defineProperty(Nc,"__esModule",{value:!0}),Nc.WebSpeech=void 0;var Iu=Dc,Lu=zc,Ou=Wc,Ru=function(){function e(){return mo(this,e),no(this,e)}return so(e,Ou.Speech),yo(e,[{key:"start",value:function(e){var t;void 0===this._extractText&&(this._extractText=Lu.Browser.IS_SAFARI()?Iu.WebSpeechTranscript.extractSafari:Iu.WebSpeechTranscript.extract),this.validate()&&(this.prepareBeforeStart(e),this.instantiateService(e),null===(t=this._service)||void 0===t||t.start(),this._translations=null==e?void 0:e.translations)}},{key:"validate",value:function(){return!!e.getAPI()||(this.error("Speech Recognition is unsupported"),!1)}},{key:"instantiateService",value:function(t){var n,r,i=e.getAPI();this._service=new i,this._service.continuous=!0,this._service.interimResults=null===(n=null==t?void 0:t.displayInterimResults)||void 0===n||n,this._service.lang=(null===(r=null==t?void 0:t.language)||void 0===r?void 0:r.trim())||"en-US",this.setEvents()}},{key:"setEvents",value:function(){var e=this;this._service&&(this._service.onstart=function(){e.setStateOnStart()},this._service.onerror=function(t){Lu.Browser.IS_SAFARI()&&"Another request is started"===t.message||"aborted"===t.error&&e.isRestarting||"no-speech"!==t.error&&e.error(t.message||t.error)},this._service.onaudioend=function(){e.setStateOnStop()},this._service.onend=function(){e._stopping=!1},this._service.onresult=function(t){if(vo(t.results)>"u"&&e._service)e._service.onend=null,e._service.stop();else if(e._extractText&&!e._stopping){var n=e._extractText(t,e.finalTranscript,e._translations),r=n.interimTranscript,i=n.finalTranscript,o=n.newText;e.updateElements(r,i,o)}})}},{key:"stop",value:function(e){var t;this._stopping=!0,null===(t=this._service)||void 0===t||t.stop(),this.finalise(e)}},{key:"error",value:function(e){console.error(e),this.setStateOnError(e),this.stop()}}],[{key:"getAPI",value:function(){return window.webkitSpeechRecognition||window.SpeechRecognition}}])}();Nc.WebSpeech=Ru;var Pu={};Object.defineProperty(Pu,"__esModule",{value:!0}),Pu.GlobalState=void 0;var Nu=function(){function e(){mo(this,e)}return yo(e,null,[{key:"doubleClickDetector",value:function(){return!!e.doubleClickPending||(e.doubleClickPending=!0,setTimeout((function(){e.doubleClickPending=!1}),300),!1)}}])}();Pu.GlobalState=Nu,Nu.doubleClickPending=!1;var Du={},Fu={};Object.defineProperty(Fu,"__esModule",{value:!0}),Fu.PreventConnectionStop=void 0;var ju=function(){return yo((function e(){mo(this,e)}),null,[{key:"applyPrevention",value:function(e){clearTimeout(e._manualConnectionStopPrevention),e.cannotBeStopped=!0,e._manualConnectionStopPrevention=setTimeout((function(){e.cannotBeStopped=!1}),800)}},{key:"clearPrevention",value:function(e){clearTimeout(e._manualConnectionStopPrevention),e.cannotBeStopped=!1}}])}();Fu.PreventConnectionStop=ju;var Bu={},Uu={};Object.defineProperty(Uu,"__esModule",{value:!0}),Uu.README_URL=void 0,Uu.README_URL="https://github.com/OvidijusParsiunas/speech-to-element",Object.defineProperty(Bu,"__esModule",{value:!0}),Bu.AzureSpeechConfig=void 0;var Hu=Uu,qu=function(){function e(){mo(this,e)}return yo(e,null,[{key:"validateOptions",value:function(e,t){return t?t.subscriptionKey||t.token||t.retrieveToken?!!t.region||(e("Please define a 'region' property - more info: ".concat(Hu.README_URL)),!1):(e("Please define a 'subscriptionKey', 'token' or 'retrieveToken' property - more info: ".concat(Hu.README_URL)),!1):(e("Please provide subscription details - more info: ".concat(Hu.README_URL)),!1)}},{key:"getNewSpeechConfig",value:(n=uo(lo().mark((function e(t,n){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.region){e.next=2;break}return e.abrupt("return",n.subscriptionKey?t.fromSubscription(n.subscriptionKey.trim(),n.region.trim()):n.token?t.fromAuthorizationToken(n.token.trim(),n.region.trim()):n.retrieveToken?n.retrieveToken().then((function(e){return n.region?t.fromAuthorizationToken((null==e?void 0:e.trim())||"",n.region.trim()):null})).catch((function(e){return console.error(e),null})):null);case 2:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"process",value:function(e,t){t.language&&(e.speechRecognitionLanguage=t.language.trim())}},{key:"get",value:(t=uo(lo().mark((function t(n,r){var i;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getNewSpeechConfig(n,r);case 2:return i=t.sent,t.abrupt("return",(i&&e.process(i,r),i));case 4:case"end":return t.stop()}}),t)}))),function(e,n){return t.apply(this,arguments)})}]);var t,n}();Bu.AzureSpeechConfig=qu;var Vu={};Object.defineProperty(Vu,"__esModule",{value:!0}),Vu.StopTimeout=void 0;var zu=function(){function e(){mo(this,e)}return yo(e,null,[{key:"set",value:function(e){e.stopTimeout=setTimeout((function(){return e.stop()}),e.stopTimeoutMS)}},{key:"reset",value:function(t,n){t.stopTimeoutMS=n||e.DEFAULT_MS,t.stopTimeout&&clearTimeout(t.stopTimeout),e.set(t)}}])}();Vu.StopTimeout=zu,zu.DEFAULT_MS=2e4;var Gu={};Object.defineProperty(Gu,"__esModule",{value:!0}),Gu.AzureTranscript=void 0;var Wu=Fc,Ku=function(){return yo((function e(){mo(this,e)}),null,[{key:"extract",value:function(e,t,n,r){return r&&(e=Wu.Translate.translate(e,r)),n?{interimTranscript:"",finalTranscript:t+e,newText:e}:{interimTranscript:e,finalTranscript:t,newText:e}}}])}();Gu.AzureTranscript=Ku,Object.defineProperty(Du,"__esModule",{value:!0}),Du.Azure=void 0;var Ju=Fu,Xu=Bu,Yu=Vu,$u=Gu,Zu=Wc,Qu=function(){function e(){var t;return mo(this,e),(t=no(this,e,arguments))._newTextPadding="",t}return so(e,Zu.Speech),yo(e,[{key:"start",value:function(e,t){this._newTextPadding="",void 0===this.stopTimeout&&Yu.StopTimeout.reset(this,null==e?void 0:e.stopAfterSilenceMs),this.prepareBeforeStart(e),this.startAsync(e),t||Ju.PreventConnectionStop.applyPrevention(this)}},{key:"startAsync",value:(n=uo(lo().mark((function e(t){var n;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.validate(t),!e.t0){e.next=6;break}return e.next=4,this.instantiateService(t);case 4:this._translations=null==t?void 0:t.translations,null===(n=this._service)||void 0===n||n.startContinuousRecognitionAsync((function(){}),this.error);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"validate",value:function(t){return e.getAPI()?Xu.AzureSpeechConfig.validateOptions(this.error.bind(this),t):(this.moduleNotFound(),!1)}},{key:"instantiateService",value:(t=uo(lo().mark((function t(n){var r,i,o,s;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.getAPI(),i=r.AudioConfig.fromDefaultMicrophoneInput(),t.next=4,Xu.AzureSpeechConfig.get(r.SpeechConfig,n);case 4:(o=t.sent)?(s=new r.SpeechRecognizer(o,i),this.setEvents(s),this._service=s,n.retrieveToken&&this.retrieveTokenInterval(n.retrieveToken)):this.error("Unable to contact Azure server");case 6:case"end":return t.stop()}}),t,this)}))),function(e){return t.apply(this,arguments)})},{key:"setEvents",value:function(e){e.recognizing=this.onRecognizing.bind(this),e.recognized=this.onRecognized.bind(this),e.sessionStarted=this.onSessionStarted.bind(this),e.canceled=this.onCanceled.bind(this),e.sessionStopped=this.onSessionStopped.bind(this)}},{key:"onRecognizing",value:function(e,t){if(!this._stopping){var n=$u.AzureTranscript.extract(this._newTextPadding+t.result.text,this.finalTranscript,!1,this._translations),r=n.interimTranscript,i=n.finalTranscript,o=n.newText;Yu.StopTimeout.reset(this,this.stopTimeoutMS),this.updateElements(r,i,o)}}},{key:"onRecognized",value:function(e,t){var n=t.result;switch(n.reason){case window.SpeechSDK.ResultReason.Canceled:break;case window.SpeechSDK.ResultReason.RecognizedSpeech:if(n.text&&!this._stopping){var r=$u.AzureTranscript.extract(this._newTextPadding+n.text,this.finalTranscript,!0,this._translations),i=r.interimTranscript,o=r.finalTranscript,s=r.newText;Yu.StopTimeout.reset(this,this.stopTimeoutMS),this.updateElements(i,o,s),""!==o&&(this._newTextPadding=" ")}}}},{key:"onCanceled",value:function(e,t){t.reason===window.SpeechSDK.CancellationReason.Error&&this.error(t.errorDetails)}},{key:"onSessionStarted",value:function(){Ju.PreventConnectionStop.clearPrevention(this),this.setStateOnStart()}},{key:"onSessionStopped",value:function(){this._retrieveTokenInterval||clearInterval(this._retrieveTokenInterval),this._stopping=!1,this.setStateOnStop()}},{key:"retrieveTokenInterval",value:function(e){var t=this;this._retrieveTokenInterval=setInterval((function(){null==e||e().then((function(e){t._service&&(t._service.authorizationToken=(null==e?void 0:e.trim())||"")})).catch((function(e){t.error(e)}))}),1e4)}},{key:"stop",value:function(e){var t;!e&&this._retrieveTokenInterval&&clearInterval(this._retrieveTokenInterval),this._stopping=!0,null===(t=this._service)||void 0===t||t.stopContinuousRecognitionAsync(),this.finalise(e)}},{key:"moduleNotFound",value:function(){console.error("speech recognition module not found:"),console.error("please install the 'microsoft-cognitiveservices-speech-sdk' npm package or add a script tag: <script src=\"https://aka.ms/csspeech/jsbrowserpackageraw\"><\/script>"),this.setStateOnError("speech recognition module not found")}},{key:"error",value:function(e){this._retrieveTokenInterval&&clearInterval(this._retrieveTokenInterval),console.error(e),this.setStateOnError(e),this.stop()}}],[{key:"getAPI",value:function(){return window.SpeechSDK}}]);var t,n}();Du.Azure=Qu,Object.defineProperty(Pc,"__esModule",{value:!0});var ed=Nc,td=$c,nd=Pu,rd=Du,id=function(){function e(){mo(this,e)}return yo(e,null,[{key:"toggle",value:function(t,n){var r,i,o=t.toLocaleLowerCase().trim();null!==(r=nd.GlobalState.service)&&void 0!==r&&r.recognizing?this.stop():"webspeech"===o?e.startWebSpeech(n):"azure"===o?e.startAzure(n):(console.error("service not found - must be either 'webspeech' or 'azure'"),null===(i=null==n?void 0:n.onError)||void 0===i||i.call(n,"service not found - must be either 'webspeech' or 'azure'"))}},{key:"startWebSpeech",value:function(t){e.stop()||(nd.GlobalState.service=new ed.WebSpeech,nd.GlobalState.service.start(t))}},{key:"isWebSpeechSupported",value:function(){return!!ed.WebSpeech.getAPI()}},{key:"startAzure",value:function(t){var n;e.stop()||null!==(n=nd.GlobalState.service)&&void 0!==n&&n.cannotBeStopped||(nd.GlobalState.service=new rd.Azure,nd.GlobalState.service.start(t))}},{key:"stop",value:function(){var e;return!!nd.GlobalState.doubleClickDetector()||(!(null===(e=nd.GlobalState.service)||void 0===e)&&e.recognizing&&nd.GlobalState.service.stop(),!1)}},{key:"endCommandMode",value:function(){nd.GlobalState.service&&td.CommandUtils.toggleCommandModeOff(nd.GlobalState.service)}}])}(),od=Pc.default=id,sd=function(){return yo((function e(t,n){mo(this,e),this.silenceMS=2e3,this.stop=!0,"boolean"==typeof n&&!1===n&&(this.stop=!1),"number"==typeof t&&(this.silenceMS=t)}),[{key:"setSilenceTimeout",value:function(e,t){var n=this;this._silenceTimeout=setTimeout((function(){var r;null==(r=e.submit)||r.call(e),od.stop(),n.stop||setTimeout(t,ld.MICROPHONE_RESET_TIMEOUT_MS)}),this.silenceMS)}},{key:"clearSilenceTimeout",value:function(){this._silenceTimeout&&clearTimeout(this._silenceTimeout)}},{key:"resetSilenceTimeout",value:function(e,t){this.clearSilenceTimeout(),this.setSilenceTimeout(e,t)}},{key:"onPause",value:function(e,t,n){e?this.resetSilenceTimeout(t,n):this.clearSilenceTimeout()}}])}(),ad=function(){function e(t,n,r){var i;mo(this,e);var o="object"==vo(t.speechToText)?t.speechToText:{},s=(i=no(this,e,[null==o?void 0:o.button])).processConfiguration(n,t.speechToText),a=s.serviceName,l=s.processedConfig;if(i._addErrorMessage=r,"webspeech"!==a||od.isWebSpeechSupported()){var c=!t.textInput||!t.textInput.disabled;i.elementRef.onclick=i.buttonClick.bind(i,n,c,a,l)}else i.changeToUnsupported();return setTimeout((function(){i._validationHandler=t._validationHandler})),i}return so(e,Rc),yo(e,[{key:"processConfiguration",value:function(t,n){var r,i,o,s,a,l,c="object"==vo(n)?n:{},u="object"==vo(c.webSpeech)?c.webSpeech:{},d=c.azure||{},p=ho(ho({displayInterimResults:null!==(r=c.displayInterimResults)&&void 0!==r?r:void 0,textColor:null!==(i=c.textColor)&&void 0!==i?i:void 0,translations:null!==(o=c.translations)&&void 0!==o?o:void 0,commands:null!==(s=c.commands)&&void 0!==s?s:void 0,events:null!==(a=c.events)&&void 0!==a?a:void 0},u),d),h=null==(l=c.commands)?void 0:l.submit;return h&&(p.onPreResult=function(e){return e.toLowerCase().includes(h)?(setTimeout((function(){var e;return null==(e=t.submit)?void 0:e.call(t)})),od.endCommandMode(),{restart:!0,removeNewText:!0}):null}),c.submitAfterSilence&&(this._silenceSubmit=new sd(c.submitAfterSilence,c.stopAfterSubmit)),{serviceName:e.getServiceName(c),processedConfig:p}}},{key:"buttonClick",value:function(e,t,n,r){var i=this,o=null==r?void 0:r.events;e.removeTextIfPlaceholder(),od.toggle(n,ho({insertInCursorLocation:!1,element:t?e.inputElementRef:void 0,onError:function(){var e;i.onError(),null==(e=i._silenceSubmit)||e.clearSilenceTimeout()},onStart:function(){var e;i.changeToActive(),null==(e=null==o?void 0:o.onStart)||e.call(o)},onStop:function(){var e,t,n;null==(e=i._validationHandler)||e.call(i),null==(t=i._silenceSubmit)||t.clearSilenceTimeout(),i.changeToDefault(),null==(n=null==o?void 0:o.onStop)||n.call(o)},onPauseTrigger:function(t){var n,r;null==(n=i._silenceSubmit)||n.onPause(t,e,i.elementRef.onclick),null==(r=null==o?void 0:o.onPauseTrigger)||r.call(o,t)},onPreResult:function(e,t){var n;null==(n=null==o?void 0:o.onPreResult)||n.call(o,e,t)},onResult:function(t,n){var r,s,a;n&&(null==(r=i._validationHandler)||r.call(i)),null==(s=i._silenceSubmit)||s.resetSilenceTimeout(e,i.elementRef.onclick),null==(a=null==o?void 0:o.onResult)||a.call(o,t,n)},onCommandModeTrigger:function(e){var t;i.onCommandModeTrigger(e),null==(t=null==o?void 0:o.onCommandModeTrigger)||t.call(o,e)}},r))}},{key:"onCommandModeTrigger",value:function(e){e?this.changeToCommandMode():this.changeToActive()}},{key:"onError",value:function(){this._addErrorMessage("speechToText","speech input error")}}],[{key:"getServiceName",value:function(e){return e.azure?"azure":"webspeech"}},{key:"toggleSpeechAfterSubmit",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.click(),n||setTimeout((function(){return t.click()}),e.MICROPHONE_RESET_TIMEOUT_MS)}}])}();ad.MICROPHONE_RESET_TIMEOUT_MS=300;var ld=ad,cd=function(){function e(t,n,r,i){var o=this;mo(this,e),this._attachments=[],this._fileCountLimit=99,this._acceptedFormat="",n.maxNumberOfFiles&&(this._fileCountLimit=n.maxNumberOfFiles),this._toggleContainerDisplay=r,this._fileAttachmentsContainerRef=i,n.acceptedFormats&&(this._acceptedFormat=n.acceptedFormats),setTimeout((function(){o._validationHandler=t._validationHandler}))}return yo(e,[{key:"attemptAddFile",value:function(t,n){return!!e.isFileTypeValid(t,this._acceptedFormat)&&(this.addAttachmentBasedOnType(t,n,!0),!0)}},{key:"addAttachmentBasedOnType",value:function(t,n,r){var i=e.getTypeFromBlob(t);if("image"===i){var o=e.createImageAttachment(n);this.addFileAttachment(t,"image",o,r)}else if("audio"===i){var s=pd.createAudioAttachment(n);this.addFileAttachment(t,"audio",s,r)}else{var a=e.createAnyFileAttachment(t.name);this.addFileAttachment(t,"any",a,r)}}},{key:"addFileAttachment",value:function(t,n,r,i){var o,s=e.createContainer(r);if(this._attachments.length>=this._fileCountLimit){var a=this._attachments[this._attachments.length-1].removeButton;null==a||a.click();var l=this._fileAttachmentsContainerRef.children;this._fileAttachmentsContainerRef.insertBefore(s,l[0])}else this._fileAttachmentsContainerRef.appendChild(s);var c={file:t,attachmentContainerElement:s,fileType:n};return i&&(c.removeButton=this.createRemoveAttachmentButton(c),s.appendChild(c.removeButton)),this._toggleContainerDisplay(!0),this._attachments.push(c),this._fileAttachmentsContainerRef.scrollTop=this._fileAttachmentsContainerRef.scrollHeight,null==(o=this._validationHandler)||o.call(this),c}},{key:"createRemoveAttachmentButton",value:function(e){var t=document.createElement("div");t.classList.add("remove-file-attachment-button"),t.onclick=this.removeAttachment.bind(this,e);var n=document.createElement("div");return n.classList.add("x-icon"),n.innerText="",t.appendChild(n),t}},{key:"removeAttachment",value:function(e){var t,n=this._attachments.findIndex((function(t){return t===e})),r=this._attachments[n].attachmentContainerElement;this._attachments.splice(n,1),pd.stopAttachmentPlayback(r),r.remove(),this._toggleContainerDisplay(!1),null==(t=this._validationHandler)||t.call(this)}},{key:"getFiles",value:function(){return Array.from(this._attachments).map((function(e){return{file:e.file,type:e.fileType}}))}},{key:"removeAllAttachments",value:function(){this._attachments.forEach((function(e){setTimeout((function(){var t;return null==(t=e.removeButton)?void 0:t.click()}))}))}}],[{key:"isFileTypeValid",value:function(e,t){if(""===t)return!0;for(var n=t.split(","),r=0;r<n.length;r++){var i=n[r].trim();if(e.type===i)return!0;if(i.startsWith(".")){var o=i.slice(1);if(e.name.endsWith(o))return!0}else{if(e.name.endsWith(i))return!0;if(i.endsWith("/*")&&e.type.startsWith(i.slice(0,-2)))return!0}}return!1}},{key:"getTypeFromBlob",value:function(e){var t=e.type;return t.startsWith("image")?"image":t.startsWith("audio")?"audio":"any"}},{key:"createImageAttachment",value:function(e){var t=new Image;return t.src=e,t.classList.add("image-attachment"),t}},{key:"createAnyFileAttachment",value:function(e){var t=document.createElement("div");t.classList.add("border-bound-attachment"),Mo.IS_SAFARI&&t.classList.add("border-bound-attachment-safari");var n=document.createElement("div");n.classList.add("any-file-attachment-text");var r=document.createElement("div");return r.classList.add("file-attachment-text-container"),r.appendChild(n),n.textContent=e,t.appendChild(r),t}},{key:"createContainer",value:function(e){var t=document.createElement("div");return t.classList.add("file-attachment"),t.appendChild(e),t}}])}(),ud='<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">\n<title>stop</title>\n<path d="M5.92 24.096q0 0.832 0.576 1.408t1.44 0.608h16.128q0.832 0 1.44-0.608t0.576-1.408v-16.16q0-0.832-0.576-1.44t-1.44-0.576h-16.128q-0.832 0-1.44 0.576t-0.576 1.44v16.16z"></path>\n</svg>',dd=function(){function e(t,n,r,i){return mo(this,e),no(this,e,[t,n,r,i])}return so(e,cd),yo(e,[{key:"createTimer",value:function(t,n){var r=this,i=0,o=void 0!==n&&n<e.TIMER_LIMIT_S?n:e.TIMER_LIMIT_S;return setInterval((function(){var e;(i+=1)===o&&(null==(e=r.stopPlaceholderCallback)||e.call(r),r.clearTimer()),600===i&&t.classList.add("audio-placeholder-text-4-digits");var n=Math.floor(i/60),s=(i%60).toString().padStart(2,"0");t.textContent="".concat(n,":").concat(s)}),1e3)}},{key:"createPlaceholderAudioAttachment",value:function(t){var n=e.createAudioContainer(),r=document.createElement("div");r.classList.add("audio-placeholder-text-3-digits");var i=document.createElement("div");i.classList.add("file-attachment-text-container","audio-placeholder-text-3-digits-container"),i.appendChild(r);var o=ol.createSVGElement(ud);return o.classList.add("attachment-icon","stop-icon","not-removable-attachment-icon"),r.textContent="0:00",this._activePlaceholderTimer=this.createTimer(r,t),n.appendChild(i),this.addPlaceholderAudioAttachmentEvents(n,o,i),n}},{key:"addPlaceholderAudioAttachmentEvents",value:function(e,t,n){var r=this;e.addEventListener("mouseenter",(function(){return e.replaceChildren(t)}));e.addEventListener("mouseleave",(function(){return e.replaceChildren(n)}));e.addEventListener("click",(function(){var e;return null==(e=r.stopPlaceholderCallback)?void 0:e.call(r)}))}},{key:"addPlaceholderAttachment",value:function(e,t){var n=this.createPlaceholderAudioAttachment(t);this._activePlaceholderAttachment=this.addFileAttachment(new File([],""),"audio",n,!1),this.stopPlaceholderCallback=e}},{key:"completePlaceholderAttachment",value:function(t,n){var r=this._activePlaceholderAttachment;r&&(r.file=t,e.addAudioElements(r.attachmentContainerElement.children[0],n),r.removeButton=this.createRemoveAttachmentButton(r),r.attachmentContainerElement.appendChild(r.removeButton),this._activePlaceholderAttachment=void 0,this.clearTimer())}},{key:"removePlaceholderAttachment",value:function(){this._activePlaceholderAttachment&&(this.removeAttachment(this._activePlaceholderAttachment),this._activePlaceholderAttachment=void 0,this.clearTimer())}},{key:"clearTimer",value:function(){void 0!==this._activePlaceholderTimer&&(clearInterval(this._activePlaceholderTimer),this._activePlaceholderTimer=void 0,this.stopPlaceholderCallback=void 0)}}],[{key:"createAudioContainer",value:function(){var e=document.createElement("div");return e.classList.add("border-bound-attachment","audio-attachment-icon-container"),Mo.IS_SAFARI&&e.classList.add("border-bound-attachment-safari"),e}},{key:"addAudioElements",value:function(e,t){var n=e.parentElement?Ho.cloneElement(e):e,r=document.createElement("audio");r.src=t;var i=ol.createSVGElement('<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  <title>play</title>\n  <path d="M5.92 24.096q0 1.088 0.928 1.728 0.512 0.288 1.088 0.288 0.448 0 0.896-0.224l16.16-8.064q0.48-0.256 0.8-0.736t0.288-1.088-0.288-1.056-0.8-0.736l-16.16-8.064q-0.448-0.224-0.896-0.224-0.544 0-1.088 0.288-0.928 0.608-0.928 1.728v16.16z"></path>\n</svg>');i.classList.add("attachment-icon","play-icon");var o=ol.createSVGElement(ud);o.classList.add("attachment-icon","stop-icon"),n.replaceChildren(i),r.onplay=function(){n.replaceChildren(o)},r.onpause=function(){n.replaceChildren(i),r.currentTime=0},r.onended=function(){n.replaceChildren(i)},n.onclick=function(){r.paused?r.play():r.pause()}}},{key:"createAudioAttachment",value:function(t){var n=e.createAudioContainer();return e.addAudioElements(n,t),n}},{key:"stopAttachmentPlayback",value:function(e){var t,n,r;null!=(r=null==(n=null==(t=e.children[0])?void 0:t.children)?void 0:n[0])&&r.classList.contains("stop-icon")&&e.children[0].click()}}])}();dd.TIMER_LIMIT_S=5999;var pd=dd,hd=function(){return yo((function e(){mo(this,e)}),null,[{key:"create",value:function(e,t,n,r,i){return"audio"===i?new pd(e,t,n,r):new cd(e,t,n,r)}}])}(),fd=function(){function e(t,n,r){mo(this,e),this._fileAttachmentsTypes=[],this.elementRef=this.createAttachmentContainer();var i="object"==vo(r)&&!!r.displayFileAttachmentContainer;this.toggleContainerDisplay(i),t.appendChild(this.elementRef),n&&Object.assign(this.elementRef.style,n)}return yo(e,[{key:"addType",value:function(e,t,n){var r=hd.create(e,t,this.toggleContainerDisplay.bind(this),this.elementRef,n);return this._fileAttachmentsTypes.push(r),r}},{key:"createAttachmentContainer",value:function(){var e=document.createElement("div");return e.id="file-attachment-container",e}},{key:"toggleContainerDisplay",value:function(e){e?this.elementRef.style.display="block":0===this.elementRef.children.length&&(this.elementRef.style.display="none")}},{key:"getAllFileData",value:function(){var e=this._fileAttachmentsTypes.map((function(e){return e.getFiles()})).flat();return e.length>0?e:void 0}},{key:"completePlaceholders",value:(t=uo(lo().mark((function e(){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this._fileAttachmentsTypes.map(function(){var e=uo(lo().mark((function e(t){var n;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null==(n=t.stopPlaceholderCallback)?void 0:n.call(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"addFilesToAnyType",value:function(t){e.addFilesToType(t,this._fileAttachmentsTypes)}},{key:"removeAllFiles",value:function(){this._fileAttachmentsTypes.forEach((function(e){return e.removeAllAttachments()})),this.elementRef.replaceChildren(),this.toggleContainerDisplay(!1)}},{key:"getNumberOfTypes",value:function(){return this._fileAttachmentsTypes.length}}],[{key:"addFilesToType",value:function(e,t){e.forEach((function(e){var n=new FileReader;n.readAsDataURL(e),n.onload=function(n){for(var r=0;r<t.length&&!t[r].attemptAddFile(e,n.target.result);r+=1);}}))}}]);var t}(),vd=function(){function e(t,n,r){mo(this,e),this._isOpen=!1,this._contentRef=e.createModalContent(n,null==r?void 0:r.backgroundColor),this._buttonPanel=e.createButtonPanel(null==r?void 0:r.backgroundColor),this._elementRef=e.createContainer(this._contentRef,r),this._elementRef.appendChild(this._buttonPanel),t.appendChild(this._elementRef),this._backgroundPanelRef=e.createDarkBackgroundPanel(),t.appendChild(this._backgroundPanelRef),this.addWindowEvents(t)}return yo(e,[{key:"isOpen",value:function(){return this._isOpen}},{key:"addButtons",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){return e._buttonPanel.appendChild(t)}))}},{key:"close",value:function(){var t=this;this._elementRef.classList.remove("show-modal"),this._elementRef.classList.add("hide-modal"),this._backgroundPanelRef.classList.remove("show-modal-background"),this._backgroundPanelRef.classList.add("hide-modal-background"),this._isOpen=!1,setTimeout((function(){t._elementRef.style.display="none",t._backgroundPanelRef.style.display="none"}),e.MODAL_CLOSE_TIMEOUT_MS)}},{key:"displayModalElements",value:function(){this._elementRef.style.display="flex",this._elementRef.classList.remove("hide-modal"),this._elementRef.classList.add("show-modal"),this._backgroundPanelRef.style.display="block",this._backgroundPanelRef.classList.remove("hide-modal-background"),this._backgroundPanelRef.classList.add("show-modal-background"),this._isOpen=!0}},{key:"openTextModal",value:function(e){this._contentRef.innerHTML=e,this.displayModalElements()}},{key:"addCloseButton",value:function(t,n,r){var i=this,o=n?e.createSVGButton(t):e.createTextButton(t);return this.addButtons(o),o.onclick=function(){i.close(),setTimeout((function(){null==r||r()}),140)},o}},{key:"addWindowEvents",value:function(e){this.keyDownEvent=this.windowKeyDown.bind(this,e),window.addEventListener("keydown",this.keyDownEvent)}},{key:"windowKeyDown",value:function(e,t){var n,r;!e.isConnected&&this.keyDownEvent?window.removeEventListener("keydown",this.keyDownEvent):this._isOpen&&(t.key===Ao.ESCAPE?(this.close(),null==(n=this.extensionCloseCallback)||n.call(this)):t.key===Ao.ENTER&&(this.close(),null==(r=this.extensionCloseCallback)||r.call(this)))}}],[{key:"createContainer",value:function(e,t){var n=document.createElement("div");return n.classList.add("modal"),n.appendChild(e),t&&delete t.backgroundColor,Object.assign(n.style,t),n}},{key:"createModalContent",value:function(e,t){var n,r=document.createElement("div");return(n=r.classList).add.apply(n,$i(e)),t&&(r.style.backgroundColor=t),document.createElement("div").appendChild(r),r}},{key:"createButtonPanel",value:function(e){var t=document.createElement("div");return t.classList.add("modal-button-panel"),e&&(t.style.backgroundColor=e),t}},{key:"createDarkBackgroundPanel",value:function(){var e=document.createElement("div");return e.id="modal-background-panel",e}},{key:"createTextButton",value:function(e){var t=document.createElement("div");return t.classList.add("modal-button"),t.textContent=e,t}},{key:"createSVGButton",value:function(e){var t=document.createElement("div");t.classList.add("modal-button","modal-svg-button");var n=ol.createSVGElement(e);return n.classList.add("modal-svg-button-icon"),t.appendChild(n),t}},{key:"createTextModalFunc",value:function(t,n,r){var i;if("object"==vo(n)&&null!=(i=n.files)&&i.infoModal){var o=new e(t,["modal-content"],n.files.infoModal.containerStyle);return o.addCloseButton("OK",!1,r),o.openTextModal.bind(o,n.infoModalTextMarkUp||"")}}}])}();vd.MODAL_CLOSE_TIMEOUT_MS=190;var md=vd,gd=function(){function e(t,n,r,i,o,s){var a,l,c,u,d,p,h,f,v,m;mo(this,e);var g=null==(l=null==r?void 0:r.button)?void 0:l.position,y=(null==(d=null==(u=null==(c=null==r?void 0:r.button)?void 0:c.styles)?void 0:u.text)?void 0:d.content)||s,b="dropup-menu"===g,_=(a=no(this,e,[e.createButtonElement(),g,r.button,y])).createInnerElements(i,o,a._customStyles,b);return a._inputElement=e.createInputElement(null==(p=null==r?void 0:r.files)?void 0:p.acceptedFormats),a.addClickEvent(t,r),a.elementRef.replaceChildren(_.styles),a.reapplyStateStyle("styles"),a._fileAttachmentsType=n,a._openModalOnce=!1===(null==(f=null==(h=r.files)?void 0:h.infoModal)?void 0:f.openModalOnce)||null==(m=null==(v=r.files)?void 0:v.infoModal)?void 0:m.openModalOnce,a}return so(e,Cc),yo(e,[{key:"createInnerElements",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e.createSVGIconElement(t,n);return{styles:Sc.createInnerElement(this.elementRef,o,"styles",r,i)}}},{key:"triggerImportPrompt",value:function(e){e.onchange=this.import.bind(this,e),e.click()}},{key:"import",value:function(e){fd.addFilesToType(Array.from(e.files||[]),[this._fileAttachmentsType]),e.value=""}},{key:"addClickEvent",value:function(e,t){var n=this.triggerImportPrompt.bind(this,this._inputElement),r=md.createTextModalFunc(e,t,n);this.elementRef.onclick=this.click.bind(this,r)}},{key:"click",value:function(e){!e||void 0!==this._openModalOnce&&!0!==this._openModalOnce?this.triggerImportPrompt(this._inputElement):(e(),!0===this._openModalOnce&&(this._openModalOnce=!1))}}],[{key:"createInputElement",value:function(e){var t=document.createElement("input");return t.type="file",t.accept=e||"",t.hidden=!0,t.multiple=!0,t}},{key:"createButtonElement",value:function(){var e=document.createElement("div");return e.classList.add("input-button","upload-file-button"),e}},{key:"createSVGIconElement",value:function(e,t){var n=ol.createSVGElement(t);return n.id=e,n}}])}(),yd=function(){function e(){mo(this,e)}return yo(e,null,[{key:"create",value:function(t,n,r){var i=e.createElement(r);e.addEvents(i,t,n),t.appendChild(i)}},{key:"createElement",value:function(e){var t=document.createElement("div");return t.id="drag-and-drop","object"==vo(e)&&Object.assign(t.style,e),t}},{key:"addEvents",value:function(t,n,r){n.ondragenter=function(n){n.preventDefault(),e.display(t)},t.ondragleave=function(n){n.preventDefault(),e.hide(t)},t.ondragover=function(e){e.preventDefault()},t.ondrop=function(n){n.preventDefault(),e.uploadFile(r,n),e.hide(t)}}},{key:"uploadFile",value:function(e,t){var n,r=null==(n=t.dataTransfer)?void 0:n.files;r&&e.addFilesToAnyType(Array.from(r))}},{key:"display",value:function(e){e.style.display="block"}},{key:"hide",value:function(e){e.style.display="none"}},{key:"isEnabled",value:function(e,t){return(void 0===t||!1!==t)&&(!!t||e.getNumberOfTypes()>0)}}])}(),bd=function(){function e(){mo(this,e)}return yo(e,null,[{key:"validate",value:function(e,t,n,r,i){var o=e(n,r,i);return o?t.changeToSubmitIcon():t.changeToDisabledIcon(),o}},{key:"useValidationFunc",value:(n=uo(lo().mark((function t(n,r,i,o){var s,a,l,c;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=r.inputElementRef,a=s.classList.contains(Po.PLACEHOLDER_TEXT_CLASS)?"":s.textContent,t.next=3,i.completePlaceholders();case 3:return l=i.getAllFileData(),c=null==l?void 0:l.map((function(e){return e.file})),t.abrupt("return",e.validate(n,o,a,c));case 5:case"end":return t.stop()}}),t)}))),function(e,t,r,i){return n.apply(this,arguments)})},{key:"useValidationFuncProgrammatic",value:(t=uo(lo().mark((function t(n,r,i){var o,s;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=null==(o=r.files)?void 0:o.map((function(e){return e.file})),t.abrupt("return",e.validate(n,i,r.text,s,!0));case 2:case"end":return t.stop()}}),t)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"validateWebsocket",value:function(e,t){return!(e.websocket&&!Xa.canSendMessage(e.websocket))||(t.changeToDisabledIcon(),!1)}},{key:"attach",value:function(t,n,r,i,o){var s=t.validateInput||zo.processValidateInput(t);t._validationHandler=function(){var t=uo(lo().mark((function t(a){var l;return lo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!o.status.loadingActive&&!o.status.requestInProgress&&!0!==n.isSubmitProgrammaticallyDisabled&&e.validateWebsocket(n,o)){t.next=2;break}return t.abrupt("return",!1);case 2:return l=s||n.canSendMessage,t.abrupt("return",l?a?e.useValidationFuncProgrammatic(l,a,o):e.useValidationFunc(l,r,i,o):null);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}]);var t,n}(),_d=function(){return yo((function e(){mo(this,e)}),null,[{key:"getFileName",value:function(e,t){var n=new Date,r=String(n.getHours()).padStart(2,"0"),i=String(n.getMinutes()).padStart(2,"0"),o=String(n.getSeconds()).padStart(2,"0");return"".concat(e,"-").concat(r,"-").concat(i,"-").concat(o,".").concat(t)}}])}(),kd=function(){function e(t,n){var r,i,o;return mo(this,e),(r=no(this,e,[n.button]))._waitingForBrowserApproval=!1,r._audioType=t,r._extension=(null==(i=n.files)?void 0:i.format)||"mp3",r._maxDurationSeconds=null==(o=n.files)?void 0:o.maxDurationSeconds,r.elementRef.onclick=r.buttonClick.bind(ro(r)),r}return so(e,Rc),yo(e,[{key:"buttonClick",value:function(){this._waitingForBrowserApproval||(this.isActive?this.stop():(this._waitingForBrowserApproval=!0,this.record()))}},{key:"stop",value:function(){var e=this;return new Promise((function(t){var n,r;e.changeToDefault(),null==(n=e._mediaRecorder)||n.stop(),null==(r=e._mediaStream)||r.getTracks().forEach((function(e){return e.stop()})),setTimeout((function(){t()}),10)}))}},{key:"record",value:function(){var e=this;navigator.mediaDevices.getUserMedia({audio:!0}).then((function(t){e.changeToActive(),e._mediaRecorder=new MediaRecorder(t),e._audioType.addPlaceholderAttachment(e.stop.bind(e),e._maxDurationSeconds),e._mediaStream=t,e._mediaRecorder.addEventListener("dataavailable",(function(t){e.createFile(t)})),e._mediaRecorder.start()})).catch((function(t){console.error(t),e.stop()})).finally((function(){e._waitingForBrowserApproval=!1}))}},{key:"createFile",value:function(e){var t=this,n=new Blob([e.data],{type:"audio/".concat(this._extension)}),r=_d.getFileName(this._newFilePrefix||"audio",this._extension),i=new File([n],r,{type:n.type}),o=new FileReader;o.readAsDataURL(i),o.onload=function(e){t._audioType.completePlaceholderAttachment(i,e.target.result)}}}])}(),xd=function(){function e(){mo(this,e)}return yo(e,null,[{key:"setPropertyValueIfDoesNotExist",value:function(t,n,r){var i,o,s=n[0];1===n.length?null!==(i=t[s])&&void 0!==i||(t[s]=r):(null!==(o=t[s])&&void 0!==o||(t[s]={}),n.shift(),e.setPropertyValueIfDoesNotExist(t[s],n,r))}},{key:"setPropertyValue",value:function(t,n,r){var i,o=n[0];1===n.length?t[o]=r:(null!==(i=t[o])&&void 0!==i||(t[o]={}),n.shift(),e.setPropertyValue(t[o],n,r))}},{key:"getObjectValue",value:function(t,n){var r=t[n[0]];return void 0===r||1===n.length?r:e.getObjectValue(r,n.slice(1))}},{key:"overwritePropertyObjectFromAnother",value:function(t,n,r){var i=e.getObjectValue(n,r);if(i){var o=ho(ho({},i),e.getObjectValue(t,r)||{});e.setPropertyValue(t,r,o)}}}])}(),wd=function(){function e(){mo(this,e)}return yo(e,null,[{key:"resetSubmit",value:function(e,t){t?e.unsetCustomStateStyles(["loading","submit"]):e.unsetCustomStateStyles(["stop","loading","submit"]),e.reapplyStateStyle("submit")}},{key:"overwriteDefaultStyleWithSubmit",value:function(e,t){if(e.submit){var n=JSON.parse(JSON.stringify(e[t]||{}));xd.overwritePropertyObjectFromAnother(n,e.submit,["container","default"]),xd.overwritePropertyObjectFromAnother(n,e.submit,["text","styles","default"]),xd.overwritePropertyObjectFromAnother(n,e.submit,["svg","styles","default"]),e[t]=n}}},{key:"setUpDisabledButton",value:function(t){xd.setPropertyValueIfDoesNotExist(t,["submit","container","default","backgroundColor"],""),xd.setPropertyValueIfDoesNotExist(t,["disabled","container","default","backgroundColor"],"unset"),xd.setPropertyValueIfDoesNotExist(t.submit,["svg","styles","default","filter"],""),xd.setPropertyValueIfDoesNotExist(t.disabled,["svg","styles","default","filter"],"brightness(0) saturate(100%) invert(70%) sepia(0%) saturate(5564%) hue-rotate(207deg) brightness(100%) contrast(97%)"),e.overwriteDefaultStyleWithSubmit(t,"disabled")}},{key:"process",value:function(t){var n=JSON.parse(JSON.stringify(t||{}));return e.overwriteDefaultStyleWithSubmit(n,"loading"),e.overwriteDefaultStyleWithSubmit(n,"stop"),null!=t&&t.alwaysEnabled||e.setUpDisabledButton(n),n}}])}(),Sd=function(){function e(t,n,r,i,o,s){var a;mo(this,e);var l=wd.process(t.submitButtonStyles);return(a=no(this,e,[e.createButtonContainerElement(),null==l?void 0:l.position,l]))._isSVGLoadingIconOverriden=!1,a.status={requestInProgress:!1,loadingActive:!1},a._messages=r,a._inputElementRef=n,a._fileAttachments=o,a._innerElements=a.createInnerElements(),a._abortStream=new AbortController,a._stopClicked={listener:function(){}},a._serviceIO=i,a._alwaysEnabled=!(null==l||!l.alwaysEnabled),t.disableSubmitButton=a.disableSubmitButton.bind(ro(a),i),a.attemptOverwriteLoadingStyle(t),s.microphone&&a.setUpSpeechToText(s.microphone.button,t.speechToText),setTimeout((function(){var e;a._validationHandler=t._validationHandler,a.assignHandlers(a._validationHandler),null==(e=a._validationHandler)||e.call(ro(a))})),a}return so(e,Cc),yo(e,[{key:"createInnerElements",value:function(){var t=this.createCustomElements(),n=t.submit,r=t.loading,i=t.stop,o=n||e.createSubmitIconElement();return{submit:o,loading:r||e.createLoadingIconElement(),stop:i||e.createStopIconElement(),disabled:this.createDisabledIconElement(o)}}},{key:"createCustomElements",value:function(){var e=this,t=Sc.createSpecificStateElement(this.elementRef,"submit",this._customStyles),n={loading:void 0,stop:void 0};return Object.keys(n).forEach((function(t){var r=t,i=Sc.createCustomElement(r,e._customStyles);i&&(n[r]=i)})),n.submit=t,n}},{key:"createDisabledIconElement",value:function(e){return Sc.createCustomElement("disabled",this._customStyles)||e.cloneNode(!0)}},{key:"attemptOverwriteLoadingStyle",value:function(e){var t,n,r,i,o,s,a,l,c;if(!(null!=(n=null==(t=this._customStyles)?void 0:t.submit)&&n.svg||null!=(o=null==(i=null==(r=this._customStyles)?void 0:r.loading)?void 0:i.svg)&&o.content||null!=(l=null==(a=null==(s=this._customStyles)?void 0:s.loading)?void 0:a.text)&&l.content||void 0!==e.displayLoadingBubble&&!0!==e.displayLoadingBubble)){var u=document.createElement("style");u.textContent="\n        .loading-button > * {\n          filter: brightness(0) saturate(100%) invert(72%) sepia(0%) saturate(3044%) hue-rotate(322deg) brightness(100%)\n            contrast(96%) !important;\n        }",null==(c=e.shadowRoot)||c.appendChild(u),this._isSVGLoadingIconOverriden=!0}}},{key:"assignHandlers",value:function(e){this._serviceIO.completionsHandlers={onFinish:this.resetSubmit.bind(this,e)},this._serviceIO.streamHandlers={onOpen:this.changeToStopIcon.bind(this),onClose:this.resetSubmit.bind(this,e),abortStream:this._abortStream,stopClicked:this._stopClicked};var t=this._serviceIO.stream;"object"==vo(t)&&"number"==typeof t.simulation&&(this._serviceIO.streamHandlers.simulationInterim=t.simulation)}},{key:"setUpSpeechToText",value:function(e,t){this._microphoneButton=e,this._stopSTTAfterSubmit="object"==vo(t)&&t.stopAfterSubmit}},{key:"resetSubmit",value:function(e){this.status.requestInProgress=!1,this.status.loadingActive=!1,e()}},{key:"submitFromInput",value:(i=uo(lo().mark((function e(){var t,n;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fileAttachments.completePlaceholders();case 2:t=this._fileAttachments.getAllFileData(),this._inputElementRef.classList.contains(Po.PLACEHOLDER_TEXT_CLASS)?this.attemptSubmit({text:"",files:t}):(n=this._inputElementRef.innerText.trim(),this.attemptSubmit({text:n,files:t}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"programmaticSubmit",value:(r=uo(lo().mark((function e(t){var n,r=this;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"string"==typeof t&&(t=zo.processSubmitUserMessage(t)),n={text:t.text},t.files&&(n.files=Array.from(t.files).map((function(e){return{file:e,type:cd.getTypeFromBlob(e)}}))),setTimeout((function(){return r.attemptSubmit(n,!0)}));case 3:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"attemptSubmit",value:(n=uo(lo().mark((function e(t){var n,r,i,o,s,a,l=arguments;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]&&l[1],e.next=3,null==(r=this._validationHandler)?void 0:r.call(this,n?t:void 0);case 3:if(e.t0=e.sent,e.t1=!1,e.t0!==e.t1){e.next=7;break}return e.abrupt("return");case 7:return this.changeToLoadingIcon(),e.next=10,this.addNewMessage(t);case 10:return this._serviceIO.isWebModel()||this._messages.addLoadingMessage(),Po.clear(this._inputElementRef),s=null==(i=t.files)?void 0:i.map((function(e){return e.file})),a={text:""===t.text?void 0:t.text,files:s},e.next=15,this._serviceIO.callAPI(a,this._messages);case 15:null==(o=this._fileAttachments)||o.removeAllFiles();case 16:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"addNewMessage",value:(t=uo(lo().mark((function e(t){var n,r,i;return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.text,r=t.files,i={role:$o.USER_ROLE},n&&(i.text=n),e.t0=r,!e.t0){e.next=8;break}return e.next=7,this._messages.addMultipleFiles(r);case 7:i.files=e.sent;case 8:this._serviceIO.sessionId&&(i._sessionId=this._serviceIO.sessionId),Object.keys(i).length>0&&this._messages.addNewMessage(i);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"stopStream",value:function(){var e;this._abortStream.abort(),null==(e=this._stopClicked)||e.listener(),this._validationHandler&&this.resetSubmit(this._validationHandler)}},{key:"changeToStopIcon",value:function(){this._serviceIO.websocket||(this.elementRef.classList.remove(e.LOADING_CLASS,e.DISABLED_CLASS,e.SUBMIT_CLASS),this.elementRef.replaceChildren(this._innerElements.stop),this.reapplyStateStyle("stop",["loading","submit"]),this.elementRef.onclick=this.stopStream.bind(this),this.status.loadingActive=!1)}},{key:"changeToLoadingIcon",value:function(){this._serviceIO.websocket||(this._isSVGLoadingIconOverriden||this.elementRef.replaceChildren(this._innerElements.loading),this.elementRef.classList.remove(e.SUBMIT_CLASS,e.DISABLED_CLASS),this.elementRef.classList.add(e.LOADING_CLASS),this.reapplyStateStyle("loading",["submit"]),this.elementRef.onclick=function(){},this.status.requestInProgress=!0,this.status.loadingActive=!0)}},{key:"changeToSubmitIcon",value:function(){var t=this;this.elementRef.classList.contains(e.SUBMIT_CLASS)||(this.elementRef.classList.remove(e.LOADING_CLASS,e.DISABLED_CLASS),this.elementRef.classList.add(e.SUBMIT_CLASS),this.elementRef.replaceChildren(this._innerElements.submit),wd.resetSubmit(this,this.status.loadingActive),this.elementRef.onclick=function(){var e;t.submitFromInput(),null!=(e=t._microphoneButton)&&e.isActive&&ld.toggleSpeechAfterSubmit(t._microphoneButton.elementRef,!!t._stopSTTAfterSubmit)})}},{key:"changeToDisabledIcon",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._alwaysEnabled&&!t?this.changeToSubmitIcon():this.elementRef.classList.contains(e.DISABLED_CLASS)||(this.elementRef.classList.remove(e.LOADING_CLASS,e.SUBMIT_CLASS),this.elementRef.classList.add(e.DISABLED_CLASS),this.elementRef.replaceChildren(this._innerElements.disabled),this.reapplyStateStyle("disabled",["submit"]),this.elementRef.onclick=function(){})}},{key:"disableSubmitButton",value:function(e,t){var n;e.isSubmitProgrammaticallyDisabled=!1!==t,!this.status.requestInProgress&&!this.status.loadingActive&&(!1===t?null==(n=this._validationHandler)||n.call(this):this.changeToDisabledIcon(!0))}}],[{key:"createButtonContainerElement",value:function(){var e=document.createElement("div");return e.classList.add("input-button"),e}},{key:"createSubmitIconElement",value:function(){var e=ol.createSVGElement('<?xml version="1.0" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" stroke="currentColor" fill="none" stroke-width="1" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">\n  <line x1="22" y1="2" x2="11" y2="14"></line>\n  <polygon points="22 2 15 22 11 14 2 10 22 2"></polygon>\n</svg>\n');return e.id="submit-icon",e}},{key:"createLoadingIconElement",value:function(){var e=document.createElement("div");return e.classList.add("dots-jumping"),e}},{key:"createStopIconElement",value:function(){var e=document.createElement("div");return e.id="stop-icon",e}}]);var t,n,r,i}();Sd.SUBMIT_CLASS="submit-button",Sd.LOADING_CLASS="loading-button",Sd.DISABLED_CLASS="disabled-button";var Ed=Sd,Cd=function(){function e(t,n,r,i){var o;mo(this,e),(o=no(this,e,[t,["modal-content","modal-camera-content"],r]))._stopped=!1,o._format="image/png",o._canvas=document.createElement("canvas"),o._canvas.classList.add("camera-modal-canvas");var s=o.addButtonsAndTheirEvents(n),a=s.captureButton,l=s.submitButton;return o._captureButton=a,o._submitButton=l,o._captureIcon=o._captureButton.children[0],o._refreshIcon=ol.createSVGElement('<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">\n  <path d="M27.1 14.313V5.396L24.158 8.34c-2.33-2.325-5.033-3.503-8.11-3.503C9.902 4.837 4.901 9.847 4.899 16c.001 6.152 5.003 11.158 11.15 11.16 4.276 0 9.369-2.227 10.836-8.478l.028-.122h-3.23l-.022.068c-1.078 3.242-4.138 5.421-7.613 5.421a8 8 0 0 1-5.691-2.359A7.993 7.993 0 0 1 8 16.001c0-4.438 3.611-8.049 8.05-8.049 2.069 0 3.638.58 5.924 2.573l-3.792 3.789H27.1z"/>\n</svg>\n'),o._refreshIcon.classList.add("modal-svg-button-icon","modal-svg-refresh-icon"),"jpeg"===(null==i?void 0:i.format)&&(o._format="image/jpeg"),null!=i&&i.dimensions&&(o._dimensions=i.dimensions),o._contentRef.appendChild(o._canvas),o.extensionCloseCallback=o.stop,o}return so(e,md),yo(e,[{key:"addButtonsAndTheirEvents",value:function(e){var t=md.createSVGButton('<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  <title>capture</title>\n  <path d="M0 16q0 3.264 1.28 6.208t3.392 5.12 5.12 3.424 6.208 1.248 6.208-1.248 5.12-3.424 3.392-5.12 1.28-6.208-1.28-6.208-3.392-5.12-5.088-3.392-6.24-1.28q-3.264 0-6.208 1.28t-5.12 3.392-3.392 5.12-1.28 6.208zM4 16q0-3.264 1.6-6.016t4.384-4.352 6.016-1.632 6.016 1.632 4.384 4.352 1.6 6.016-1.6 6.048-4.384 4.352-6.016 1.6-6.016-1.6-4.384-4.352-1.6-6.048z"></path>\n</svg>\n');t.classList.add("modal-svg-camera-button"),t.children[0].classList.add("modal-svg-camera-icon");var n=this.addCloseButton('<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">\n  <path d="M195.2 195.2a64 64 0 0 1 90.496 0L512 421.504 738.304 195.2a64 64 0 0 1 90.496 90.496L602.496 512 828.8 738.304a64 64 0 0 1-90.496 90.496L512 602.496 285.696 828.8a64 64 0 0 1-90.496-90.496L421.504 512 195.2 285.696a64 64 0 0 1 0-90.496z"/>\n</svg>',!0);n.classList.add("modal-svg-close-button"),n.children[0].classList.add("modal-svg-close-icon");var r=md.createSVGButton('<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.89163 13.2687L9.16582 17.5427L18.7085 8" stroke="#000000" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>');return r.classList.add("modal-svg-submit-button"),this.addButtons(t,r),this.addButtonEvents(t,n,r,e),{captureButton:t,submitButton:r}}},{key:"addButtonEvents",value:function(e,t,n,r){var i=this;e.onclick=function(){i.capture()},t.addEventListener("click",this.stop.bind(this)),n.onclick=function(){var e=i.getFile();e&&fd.addFilesToType([e],[r]),i.stop(),i.close()}}},{key:"stop",value:function(){var e=this;this._mediaStream&&this._mediaStream.getTracks().forEach((function(e){return e.stop()})),this._stopped=!0,setTimeout((function(){e._captureButton.replaceChildren(e._captureIcon),e._captureButton.classList.replace("modal-svg-refresh-button","modal-svg-camera-button");var t=e._canvas.getContext("2d");null==t||t.clearRect(0,0,e._canvas.width,e._canvas.height)}),md.MODAL_CLOSE_TIMEOUT_MS)}},{key:"start",value:function(){var e=this;this._dataURL=void 0,this._submitButton.classList.add("modal-svg-submit-disabled"),this._stopped=!1,navigator.mediaDevices.getUserMedia({video:this._dimensions||!0}).then((function(t){if(e._mediaStream=t,!e.isOpen())return e.stop();var n=document.createElement("video");n.srcObject=t,n.play(),requestAnimationFrame(e.updateCanvas.bind(e,n,e._canvas))})).catch((function(t){console.error(t),e.stop(),e.close()}))}},{key:"capture",value:function(){this._dataURL?(this._captureButton.replaceChildren(this._captureIcon),this._captureButton.classList.replace("modal-svg-refresh-button","modal-svg-camera-button"),this._submitButton.classList.add("modal-svg-submit-disabled"),this._dataURL=void 0):(this._captureButton.replaceChildren(this._refreshIcon),this._captureButton.classList.replace("modal-svg-camera-button","modal-svg-refresh-button"),this._submitButton.classList.remove("modal-svg-submit-disabled"),this._dataURL=this._canvas.toDataURL())}},{key:"getFile",value:function(){if(this._dataURL){for(var e=atob(this._dataURL.split(",")[1]),t=new Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);var r=new Uint8Array(t),i=new Blob([r],{type:this._format}),o="image/jpeg"===this._format?"jpeg":"png",s=_d.getFileName(this._newFilePrefix||"photo",o);return new File([i],s,{type:i.type})}}},{key:"updateCanvas",value:function(e,t){if(!this._stopped){if(!this._dataURL){t.width=e.videoWidth,t.height=e.videoHeight;var n=t.getContext("2d");null==n||n.drawImage(e,0,0,t.width,t.height)}requestAnimationFrame(this.updateCanvas.bind(this,e,t))}}},{key:"openCameraModal",value:function(e){this.displayModalElements(),e.start()}}],[{key:"createCameraModalFunc",value:function(t,n,r,i){var o=new e(t,n,r,i);return o.openCameraModal.bind(o,o)}}])}(),Td=function(){function e(t,n,r){var i,o,s,a,l;mo(this,e);var c=null==(o=null==r?void 0:r.button)?void 0:o.position,u=(null==(l=null==(a=null==(s=null==r?void 0:r.button)?void 0:s.styles)?void 0:a.text)?void 0:l.content)||"Photo",d=(i=no(this,e,[e.createButtonElement(),c,(null==r?void 0:r.button)||{},u])).createInnerElements(i._customStyles,"dropup-menu"===c);return r&&i.addClickEvent(t,n,r.modalContainerStyle,r.files),i.elementRef.classList.add("upload-file-button"),i.elementRef.appendChild(d.styles),i.reapplyStateStyle("styles"),i}return so(e,Cc),yo(e,[{key:"createInnerElements",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{styles:Sc.createInnerElement(this.elementRef,e.createSVGIconElement(),"styles",t,n)}}},{key:"addClickEvent",value:function(e,t,n,r){var i=Cd.createCameraModalFunc(e,t,n,r);this.elementRef.onclick=i}}],[{key:"createButtonElement",value:function(){var e=document.createElement("div");return e.classList.add("input-button"),e}},{key:"createSVGIconElement",value:function(){var e=ol.createSVGElement('<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  <path d="M29 7h-4.599l-2.401-4h-12l-2.4 4h-4.6c-1 0-3 1-3 2.969v16.031c0 1.657 1.5 3 2.792 3h26.271c1.313 0 2.938-1.406 2.938-2.968v-16.032c0-1-1-3-3-3zM30 26.032c0 0.395-0.639 0.947-0.937 0.969h-26.265c-0.232-0.019-0.797-0.47-0.797-1v-16.031c0-0.634 0.851-0.953 1-0.969h5.732l2.4-4h9.802l1.785 3.030 0.55 0.97h5.731c0.705 0 0.99 0.921 1 1v16.032zM16 10c-3.866 0-7 3.134-7 7s3.134 7 7 7 7-3.134 7-7-3.134-7-7-7zM16 22c-2.757 0-5-2.243-5-5s2.243-5 5-5 5 2.243 5 5-2.243 5-5 5z"></path>\n</svg>');return e.id="camera-icon",e}}])}(),Ad=function(){function e(t,n,r,i){mo(this,e),this.elementRef=e.createPanelElement(t.inputAreaStyle);var o={},s=this.createFileUploadComponents(t,r,i,o),a=new Po(t,r,s);t.speechToText&&!o.microphone&&(o.microphone={button:new ld(t,a,n.addNewErrorMessage.bind(n))});var l=new Ed(t,a.inputElementRef,n,r,s,o);a.submit=l.submitFromInput.bind(l),bd.attach(t,r,a,s,l),t.submitUserMessage=l.programmaticSubmit.bind(l),o.submit={button:l},e.addElements(this.elementRef,a,o,i,s,t.dropupStyles)}return yo(e,[{key:"createFileUploadComponents",value:function(t,n,r,i){var o,s,a,l,c=new fd(this.elementRef,t.attachmentContainerStyle,n.demo);if(e.createUploadButtons(t,n.fileTypes||{},c,r,i),null!=(o=n.camera)&&o.files){var u=(null==(s=i.images)?void 0:s.fileType)||c.addType(t,n.camera.files,"images");i.camera={button:new Td(r,u,n.camera)}}if(null!=(a=n.recordAudio)&&a.files){var d=(null==(l=i.audio)?void 0:l.fileType)||c.addType(t,n.recordAudio.files,"audio");i.microphone={button:new kd(d,n.recordAudio)}}return yd.isEnabled(c,t.dragAndDrop)&&yd.create(r,c,t.dragAndDrop),c}}],[{key:"createPanelElement",value:function(e){var t=document.createElement("div");return t.id="input",Object.assign(t.style,e),t}},{key:"createUploadButtons",value:function(e,t,n,r,i){Object.keys(t).forEach((function(o){var s=o,a=t[s];if(a.files){var l=n.addType(e,a.files,s),c=Oc[s],u=c.id,d=c.svgString,p=c.dropupText,h=new gd(r,l,a,u,d,p);i[s]={button:h,fileType:l}}}))}},{key:"addElements",value:function(e,t,n,r,i,o){Ho.addElements(e,t.elementRef);var s=xc.create(),a=Lc.addButtons(s,n,r,o);kc.set(t.inputElementRef,s,i.elementRef,a),xc.add(e,s)}}])}(),Md=function(){function e(){mo(this,e)}return yo(e,null,[{key:"createElements",value:function(e,t,n){var r=document.createElement("div");r.id="chat-view";var i=new bc(e,t,n);t.websocket&&Xa.createConnection(t,i);var o=new Ad(e,i,t,r);return Ho.addElements(r,i.elementRef,o.elementRef),r}},{key:"render",value:function(t,n,r,i){var o=e.createElements(t,r,i);n.replaceChildren(o)}}])}(),Id=Object.defineProperty,Ld=function(e,t,n,r){for(var i,o=void 0,s=e.length-1;s>=0;s--)(i=e[s])&&(o=i(t,n,o)||o);return o&&Id(t,n,o),o},Od=function(){function e(){var t;return mo(this,e),(t=no(this,e)).getMessages=function(){return[]},t.submitUserMessage=function(){return console.warn("submitUserMessage failed - please wait for chat view to render before calling this property.")},t.addMessage=function(){return console.warn("addMessage failed - please wait for chat view to render before calling this property.")},t.focusInput=function(){return No.focusFromParentElement(t._elementRef)},t.refreshMessages=function(){},t.clearMessages=function(){},t.scrollToBottom=function(){},t.disableSubmitButton=function(){},t.setPlaceholderText=function(){},t._hasBeenRendered=!1,t._auxiliaryStyleApplied=!1,t._elementRef=document.createElement("div"),t._elementRef.id="container",t.attachShadow({mode:"open"}).appendChild(t._elementRef),To.apply('#validate-property-key-view{height:100%;position:relative;display:flex;justify-content:center;align-items:center;padding:8px}#large-loading-ring{display:inline-block;width:50px;height:50px}#large-loading-ring:after{content:" ";display:block;width:38px;height:38px;margin:1px;border-radius:50%;border:5px solid #5fb2ff;border-color:#5fb2ff transparent #5fb2ff transparent;animation:large-loading-ring 1.4s linear infinite}@keyframes large-loading-ring{0%{transform:rotate(0)}to{transform:rotate(360deg)}}#insert-key-view{height:100%;position:relative}#insert-key-contents{text-align:center;position:absolute;top:44%;left:50%;transform:translate(-50%,-50%);width:82%;display:flex;max-width:700px}#insert-key-title{margin-bottom:15px}#insert-key-input-container{margin-right:2.7em;width:calc(100% - 80px)}#insert-key-input{padding:.3em 1.7em .3em .3em;border-width:1px;border-style:solid;border-radius:3px;width:100%;font-size:inherit}.insert-key-input-valid{border-color:gray}.insert-key-input-invalid{border-color:red}#visibility-icon-container{position:relative;float:right;cursor:pointer;-webkit-user-select:none;user-select:none}.visibility-icon{filter:brightness(0) saturate(100%) invert(63%) sepia(1%) saturate(9%) hue-rotate(43deg) brightness(98%) contrast(92%);position:absolute;right:-1.7em;top:-1.43em}#visible-icon{top:-1.4em}.visibility-icon:hover{filter:unset}.visibility-icon>*{pointer-events:none}#start-button{border:1px solid grey;color:#454545;border-radius:4px;width:3em;display:flex;justify-content:center;align-items:center;cursor:pointer;padding:.28em .3em;-webkit-user-select:none;user-select:none;background-color:#fff}#start-button:hover{background-color:#f2f2f2}#start-button:active{background-color:#d2d2d2}#insert-key-help-text-container{width:100%;position:absolute;margin-top:32px;margin-bottom:20px}#insert-key-help-text-contents{width:100%;position:absolute}#insert-key-input-invalid-text{display:block;margin-top:1em;margin-bottom:.5em;color:red}.insert-key-input-help-text{display:block;margin-top:16px}#loading-ring{display:inline-block;width:16px;height:16px}#loading-ring:after{content:" ";display:block;width:11px;height:11px;margin:1px;border-radius:50%;border:2px solid #0084ff;border-color:#0084ff transparent #0084ff transparent;animation:loading-ring 1.2s linear infinite}@keyframes loading-ring{0%{transform:rotate(0)}to{transform:rotate(360deg)}}#error-view{color:red;font-size:1.2em;line-height:1.3em;margin-top:-5px;text-align:center;height:100%;display:flex;justify-content:center;align-items:center;padding-left:8px;padding-right:8px}.intro-panel{position:absolute;display:flex;justify-content:center;right:0;bottom:0;left:0;margin:auto;height:fit-content;top:-2.5em}#internal-intro-panel{width:250px;height:min-content;display:block;border-radius:5px;overflow:auto;border:1px solid rgb(203,203,203);padding:10px;max-height:calc(100% - 6.8em)}#internal-intro-panel>p{margin-block-start:.8em;margin-block-end:.8em}pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}/*!\n  Theme: a11y-dark\n  Author: @ericwbailey\n  Maintainer: @ericwbailey\n\n  Based on the Tomorrow Night Eighties theme: https://github.com/isagalaev/highlight.js/blob/master/src/styles/tomorrow-night-eighties.css\n*/.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast: active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}#messages{overflow:auto}.outer-message-container:last-child{margin-bottom:5px}.inner-message-container{display:flex;margin-left:auto;margin-right:auto;width:calc(97.5% - 24px);max-width:100%}.message-bubble{margin-top:10px;word-wrap:break-word;width:fit-content;max-width:60%;border-radius:10px;padding:.42em .55em;height:fit-content;line-height:1.26em}.user-message-text{color:#fff;background-color:#0084ff;margin-right:0;margin-left:auto}.ai-message-text{color:#000;background-color:#e4e6eb;margin-left:0;margin-right:auto}.html-message{max-width:unset}.error-message-text{margin:14px auto 10px;background-color:#f4c0c0;color:#474747;text-align:center;max-width:95%}.loading-message-text{width:1em;padding:.6em .75em .6em 1.3em}.message-bubble>p:first-child{margin-top:0}.message-bubble>p:last-child{margin-bottom:0}pre{overflow:auto;display:block;word-break:break-all;word-wrap:break-word;border-radius:7px;background:#2b2b2b;color:#f8f8f2;margin-top:.8em;margin-bottom:.8em;padding:.6em;font-size:.9em;line-height:1.5em}.image-message{padding:0;display:flex;background-color:#ddd}.image-message>*,.image-message>*>*{width:100%;border-radius:8px;display:flex}.audio-message{width:60%;max-width:300px;height:2.2em;max-height:54px;padding:0;background-color:unset}.audio-player{width:100%;height:100%}.audio-player-safari{height:fit-content;width:40px}.audio-player-safari-left{float:left}.audio-player-safari-right{float:right}.any-file-message-bubble{padding:1px}.any-file-message-contents{display:flex}.any-file-message-icon-container{width:1.3em;min-width:1.3em;position:relative;border-radius:4px;margin-left:6px;margin-right:2px}.any-file-message-icon{background-color:#fff;border-radius:4px;position:absolute;width:1em;height:1.25em;padding:1px;margin-top:auto;margin-bottom:auto;top:0;bottom:0}.any-file-message-text{padding-top:5px;overflow-wrap:anywhere;padding-bottom:5px;padding-right:7px}.message-bubble>a{color:inherit}.left-item-position{margin-right:10px}.right-item-position{margin-left:10px}.avatar{padding-top:5px;width:1.5em;height:1.5em;border-radius:1px}.avatar-container{margin-top:9px}.name{margin-top:16px;font-size:15px}#drag-and-drop{position:absolute;display:none;z-index:10;height:calc(100% - 10px);width:calc(100% - 10px);background-color:#70c6ff4d;border:5px dashed #6dafff}#file-attachment-container{position:absolute;height:3.6em;width:calc(80% - 4px);top:-2.5em;border-radius:5px;overflow:auto;text-align:left;background-color:#d7d7d73b;padding-left:4px}.file-attachment{width:2.85em;height:2.85em;display:inline-flex;margin-right:.6em;margin-bottom:.44em;margin-top:4px;position:relative;background-color:#fff;border-radius:5px}.image-attachment{width:100%;height:100%;object-fit:cover;border-radius:5px}.border-bound-attachment{width:calc(100% - 2px);height:calc(100% - 2px);border:1px solid #c3c3c3;border-radius:5px;overflow:hidden}.border-bound-attachment-safari{width:calc(100% - 1px);height:calc(100% - 1px)}.audio-attachment-icon-container{cursor:pointer}.audio-attachment-icon-container:hover{background-color:#f8f8f8}.attachment-icon{left:0;right:0;bottom:0;top:2px;margin:auto;position:absolute;width:25px;-webkit-user-select:none;user-select:none}.not-removable-attachment-icon{top:0;right:0;bottom:0;left:0}.play-icon{filter:brightness(0) saturate(100%) invert(17%) sepia(0%) saturate(1392%) hue-rotate(67deg) brightness(98%) contrast(97%)}.stop-icon{filter:brightness(0) saturate(100%) invert(29%) sepia(90%) saturate(1228%) hue-rotate(198deg) brightness(93%) contrast(98%)}.audio-placeholder-text-3-digits{padding-left:.26rem}.audio-placeholder-text-4-digits{padding-left:.1rem}.any-file-attachment{padding:2px 0}.file-attachment-text-container{position:absolute;width:inherit;display:flex;align-items:center;height:100%;top:-1px}.audio-placeholder-text-3-digits-container{padding-top:1px;cursor:default}.any-file-attachment-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;padding-left:.13em;margin-left:auto;margin-right:auto}.remove-file-attachment-button{height:1.25em;width:1.25em;border:1px solid #cfcfcf;border-radius:25px;background-color:#fff;top:-4px;right:-5px;position:absolute;display:flex;justify-content:center;cursor:pointer;-webkit-user-select:none;user-select:none}.remove-file-attachment-button:hover{background-color:#e4e4e4}.remove-file-attachment-button:active{background-color:#d7d7d7}.x-icon{color:#4e4e4e;top:-.075em;position:relative;font-size:1.05em}.modal{display:none;flex-direction:column;align-items:center;justify-content:center;position:absolute;width:80%;max-width:420px;max-height:80%;margin:auto;top:0;right:0;bottom:0;left:0;z-index:2}.modal-content{border-top:1px solid rgb(217,217,217);border-left:1px solid rgb(217,217,217);border-right:1px solid rgb(217,217,217);border-top-left-radius:inherit;border-top-right-radius:inherit;background-color:#fff;overflow-y:auto;height:fit-content;max-height:calc(100% - 3.3em);width:100%}.modal-content>p{margin-left:1em;margin-right:1em}.modal-content>ul{margin-right:1em}.modal-button-panel{height:3.3em;border:1px solid;border-color:rgb(223,223,223) rgb(217,217,217) rgb(217,217,217);border-bottom-left-radius:inherit;border-bottom-right-radius:inherit;background-color:#fff;text-align:center;justify-content:center;display:flex;width:100%}.modal-button{min-width:2.5em;text-align:center;color:#fff;border-radius:5px;padding:.4em .4em .3em;height:1.25em;background-color:#3279b2;top:0;bottom:0;cursor:pointer;-webkit-user-select:none;user-select:none;margin:auto .31em}.modal-button:hover{background-color:#276da7}.modal-button:active{background-color:#1b5687}.modal-svg-button{padding:0 0 2px;width:2em;height:1.8em}.modal-svg-button-icon{width:100%;height:100%;filter:brightness(0) saturate(100%) invert(100%) sepia(15%) saturate(4%) hue-rotate(346deg) brightness(101%) contrast(102%)}#modal-background-panel{position:absolute;width:100%;height:100%;background-color:#00000042;z-index:1;display:none}.show-modal-background{animation:fadeInBackground .3s ease-in-out}@keyframes fadeInBackground{0%{opacity:0}to{opacity:1}}.show-modal{animation:fadeInModal .3s ease-in-out}@keyframes fadeInModal{0%{opacity:0;scale:.95}to{opacity:1;scale:1}}.hide-modal-background{animation:fadeOutBackground .2s ease-in-out}@keyframes fadeOutBackground{0%{opacity:1}to{opacity:0}}.hide-modal{animation:fadeOutModal .2s ease-in-out}@keyframes fadeOutModal{0%{opacity:1;scale:1}to{opacity:0;scale:.95}}.modal-camera-content{overflow:hidden;text-align:center;border:unset;height:100%;background-color:#2a2a2a;display:flex;justify-content:center}.camera-modal-canvas{max-width:100%;max-height:100%;margin-top:auto;margin-bottom:auto}.modal-svg-submit-button{background-color:green}.modal-svg-submit-button:hover{background-color:#007500}.modal-svg-submit-button:active{background-color:#006500}.modal-svg-submit-disabled{pointer-events:none;background-color:#747474}.modal-svg-close-button{height:1.56em;padding-top:.37em;padding-bottom:0;background-color:#c13e3e}.modal-svg-close-button:hover{background-color:#b43434}.modal-svg-close-button:active{background-color:#972929}.modal-svg-close-icon{width:80%;height:80%}.modal-svg-camera-button{height:1.6em;padding-top:.38em;padding-bottom:0}.modal-svg-camera-icon{height:76%}.modal-svg-refresh-icon{height:105%}.modal-svg-refresh-button{height:1.66em;padding-top:.11em;padding-bottom:.21em}.input-button-container{position:relative;z-index:1}.inside-right{position:absolute;right:calc(10% + .35em);bottom:.85em}.inside-left{position:absolute;left:calc(10% + .35em);bottom:.85em}.outside-left{position:absolute;right:calc(11px - .55em);bottom:.88em}.outside-right{position:absolute;left:calc(11px - .55em);bottom:.88em}#upload-images-icon{position:absolute;pointer-events:none;width:1.45em;height:1.45em;left:.11em;bottom:.08em;filter:brightness(0) saturate(100%) invert(43%) sepia(0%) saturate(740%) hue-rotate(77deg) brightness(99%) contrast(92%)}#upload-gifs-icon{position:absolute;pointer-events:none;width:1.5em;height:1.48em;left:.07em;bottom:.08em;filter:brightness(0) saturate(100%) invert(49%) sepia(0%) saturate(2586%) hue-rotate(12deg) brightness(93%) contrast(90%)}#upload-audio-icon{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.17em;bottom:.2em;filter:brightness(0) saturate(100%) invert(15%) sepia(0%) saturate(337%) hue-rotate(125deg) brightness(91%) contrast(94%);transform:scaleX(.95)}#camera-icon{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.23em;bottom:.2em;filter:brightness(0) saturate(100%) invert(52%) sepia(0%) saturate(161%) hue-rotate(164deg) brightness(91%) contrast(92%);transform:scaleX(.95)}#upload-mixed-files-icon{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.25em;bottom:.2em;filter:brightness(0) saturate(100%) invert(53%) sepia(0%) saturate(36%) hue-rotate(74deg) brightness(98%) contrast(93%);transform:scaleX(.95)}#interim-text{color:gray}#microphone-button{padding-top:.5px}.outer-button-container>#microphone-button{padding-bottom:1px}#microphone-icon{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.25em;bottom:.25em}.default-microphone-icon{filter:brightness(0) saturate(100%) invert(32%) sepia(0%) saturate(924%) hue-rotate(46deg) brightness(95%) contrast(99%)}.active-microphone-icon{filter:brightness(0) saturate(100%) invert(10%) sepia(97%) saturate(7495%) hue-rotate(0deg) brightness(101%) contrast(107%);border-radius:10px}.command-microphone-icon{filter:brightness(0) saturate(100%) invert(42%) sepia(96%) saturate(1067%) hue-rotate(77deg) brightness(99%) contrast(102%)}.unsupported-microphone{display:none}#submit-icon{height:100%;filter:brightness(0) saturate(100%) invert(32%) sepia(0%) saturate(924%) hue-rotate(46deg) brightness(95%) contrast(99%);width:1.21em}#stop-icon{background-color:#acacac;position:absolute;width:.95em;height:.95em;left:.35em;bottom:.35em;border-radius:2px}.submit-button-enlarged{scale:1.1;margin-right:.3em;margin-left:.3em}.dots-jumping{position:relative;left:calc(-9990px + .275em);width:.22em;height:.22em;border-radius:5px;background-color:#848484;color:#848484;box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484;animation:dots-jumping 1.5s infinite linear;bottom:-.75em}@keyframes dots-jumping{0%{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}16.667%{box-shadow:9990px -6px #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}33.333%{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}50%{box-shadow:9990px 0 #848484,calc(9990px + .44em) -6px 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}66.667%{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}83.333%{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) -6px 0 0 #848484}to{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}}.dots-flashing{position:relative;width:.45em;height:.45em;border-radius:5px;background-color:var(--message-dots-color);color:var(--message-dots-color);animation:dots-flashing 1s infinite linear alternate;animation-delay:.5s}.dots-flashing:before,.dots-flashing:after{content:"";display:inline-block;position:absolute;top:0}.dots-flashing:before{left:-.7em;width:.45em;height:.45em;border-radius:5px;background-color:var(--message-dots-color);color:var(--message-dots-color);animation:dots-flashing 1s infinite alternate;animation-delay:0s}.dots-flashing:after{left:.7em;width:.45em;height:.45em;border-radius:5px;background-color:var(--message-dots-color);color:var(--message-dots-color);animation:dots-flashing 1s infinite alternate;animation-delay:1s}@keyframes dots-flashing{0%{background-color:var(--message-dots-color)}50%,to{background-color:var(--message-dots-color-fade)}}.input-button{border-radius:4px;cursor:pointer;margin-bottom:.2em;-webkit-user-select:none;user-select:none}.input-button-svg{width:1.65em;height:1.65em}.input-button:hover{background-color:#9c9c9c2e}.input-button:active{background-color:#9c9c9c5e}.loading-button{cursor:auto}.loading-button:hover{background-color:unset}.text-button{filter:unset!important;display:flex;justify-content:center;align-items:center;margin-left:4px;margin-right:4px;height:1.6em}#text-input-container{background-color:#fff;width:80%;display:flex;border:1px solid #0000001a;border-radius:5px;margin-top:.8em;margin-bottom:.8em;box-shadow:#959da533 0 1px 12px;overflow-y:auto;max-height:200px;position:relative}.text-input-container-left-adjustment{margin-left:1.5em}.text-input-container-right-adjustment{margin-right:1.5em}.text-input-container-left-small-adjustment{margin-left:1.1em}.text-input-container-left-small-adjustment>.outside-left{right:calc(14px - .55em)}.text-input-container-right-small-adjustment{margin-right:1.1em}.text-input-container-right-small-adjustment>.outside-right{left:calc(14px - .55em)}#text-input{text-align:left;outline:none;word-wrap:break-word;line-break:auto}.text-input-styling{padding:.4em .5em;overflow:overlay;width:100%}.text-input-inner-left-adjustment{padding-left:2.2em}.text-input-inner-right-adjustment{padding-right:2em}.text-input-disabled{pointer-events:none;-webkit-user-select:none;user-select:none}.text-input-placeholder{color:gray}.outside-right>#dropup-menu,.inside-right>#dropup-menu{right:0}#dropup-icon{position:absolute;pointer-events:none;width:1.16em;height:1.2em;left:.265em;bottom:.43em;filter:brightness(0) saturate(100%) invert(54%) sepia(0%) saturate(724%) hue-rotate(6deg) brightness(92%) contrast(90%)}#dropup-menu{background-color:#fff;position:absolute;transform:translateY(-100%);border-radius:5px;z-index:1;top:-.49em;box-shadow:#0003 -1px 2px 10px,#0000001a 0 2px 4px;cursor:pointer;-webkit-user-select:none;user-select:none}.dropup-menu-item{height:1.4em;padding:.28em .84em .28em .35em;display:flex;position:relative}.dropup-menu-item:first-child{padding-top:.49em;border-top-left-radius:inherit;border-top-right-radius:inherit}.dropup-menu-item:last-child{padding-bottom:.45em;border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.dropup-menu-item-icon{width:1.39em;position:relative;margin-right:.56em}.dropup-menu-item-icon>svg{bottom:0!important;top:0!important;margin-bottom:auto;margin-top:auto}.dropup-menu-item-text{margin-top:.08em;width:max-content}#input{width:100%;display:inline-flex;text-align:center;margin-left:auto;margin-right:auto;margin-top:auto;position:relative;justify-content:center}#chat-view{height:100%;display:grid;grid-template-columns:100%}::-webkit-scrollbar{width:9px;height:9px}::-webkit-scrollbar-thumb{background-color:#d0d0d0;border-radius:5px}::-webkit-scrollbar-track{background-color:#f2f2f2}.deep-chat-web-model-button{margin-top:10px;margin-bottom:5px;margin-left:1px}:host{all:initial;display:table-cell}#container{height:inherit;width:inherit;overflow:hidden}',t.shadowRoot),setTimeout((function(){t._hasBeenRendered||t.onRender()}),20),t}return so(e,il),yo(e,[{key:"changeToChatView",value:function(){this._activeService&&(this._activeService.validateKeyProperty=!1),this.onRender()}},{key:"onRender",value:function(){var e;So.attemptAppendStyleSheetToHead(this.style),zo.processConnect(this),(!this._activeService||this._activeService.demo)&&(this._activeService=uc.create(this)),this.auxiliaryStyle&&!this._auxiliaryStyleApplied&&(To.apply(this.auxiliaryStyle,this.shadowRoot),this._auxiliaryStyleApplied=!0),To.applyDefaultStyleToComponent(this.style,this.chatStyle),zo.checkForContainerStyles(this,this._elementRef),this._activeService.key&&this._activeService.validateKeyProperty?ko.render(this._elementRef,this.changeToChatView.bind(this),this._activeService):this._activeService instanceof tl&&!this._activeService.key?this._activeService instanceof tl&&ll.render(this._elementRef,this.changeToChatView.bind(this),this._activeService):(null!==(e=this._childElement)&&void 0!==e||(this._childElement=this.children[0]),Md.render(this,this._elementRef,this._activeService,this._childElement)),this._hasBeenRendered=!0,La.onRender(this)}},{key:"disconnectedCallback",value:function(){hl.chat=void 0}}])}();Ld([hc("object")],Od.prototype,"connect"),Ld([hc("object")],Od.prototype,"directConnection"),Ld([hc("object")],Od.prototype,"webModel"),Ld([hc("object")],Od.prototype,"requestBodyLimits"),Ld([hc("function")],Od.prototype,"requestInterceptor"),Ld([hc("function")],Od.prototype,"responseInterceptor"),Ld([hc("function")],Od.prototype,"validateInput"),Ld([hc("function")],Od.prototype,"loadHistory"),Ld([hc("object")],Od.prototype,"chatStyle"),Ld([hc("object")],Od.prototype,"attachmentContainerStyle"),Ld([hc("object")],Od.prototype,"dropupStyles"),Ld([hc("object")],Od.prototype,"inputAreaStyle"),Ld([hc("object")],Od.prototype,"textInput"),Ld([hc("object")],Od.prototype,"submitButtonStyles"),Ld([hc("string")],Od.prototype,"auxiliaryStyle"),Ld([hc("array")],Od.prototype,"history"),Ld([hc("object")],Od.prototype,"introMessage"),Ld([hc("object")],Od.prototype,"avatars"),Ld([hc("object")],Od.prototype,"names"),Ld([hc("boolean")],Od.prototype,"displayLoadingBubble"),Ld([hc("object")],Od.prototype,"errorMessages"),Ld([hc("object")],Od.prototype,"messageStyles"),Ld([hc("object")],Od.prototype,"textToSpeech"),Ld([hc("object")],Od.prototype,"speechToText"),Ld([hc("object")],Od.prototype,"images"),Ld([hc("object")],Od.prototype,"gifs"),Ld([hc("object")],Od.prototype,"camera"),Ld([hc("object")],Od.prototype,"audio"),Ld([hc("object")],Od.prototype,"microphone"),Ld([hc("object")],Od.prototype,"mixedFiles"),Ld([hc("object")],Od.prototype,"dragAndDrop"),Ld([hc("object")],Od.prototype,"introPanelStyle"),Ld([hc("object")],Od.prototype,"htmlClassUtilities"),Ld([hc("function")],Od.prototype,"onMessage"),Ld([hc("function")],Od.prototype,"onClearMessages"),Ld([hc("function")],Od.prototype,"onComponentRender"),Ld([hc("function")],Od.prototype,"onError"),Ld([hc("object")],Od.prototype,"demo"),Ld([hc("object")],Od.prototype,"_insertKeyViewStyles"),customElements.define("deep-chat",Od);var Rd={class:"navbar"},Pd={class:"container"},Nd={class:"navbar-brand"},Dd=["src"],Fd={class:"c-app_title",id:"aira-title"},jd=["src"],Bd={id:"aira-title-text"},Ud={class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNavAltMarkup","aria-controls":"navbarNavAltMarkup","aria-expanded":"false","aria-label":"Toggle navigation"},Hd=["xlink:href"],qd={class:"collapse navbar-collapse",id:"navbarNavAltMarkup"},Vd={class:"container"},zd={class:"navbar-nav"},Gd={class:"c-nav"},Wd={class:"c-nav_content",id:"aira-menu-submenu-items"},Kd=["href"],Jd=["src"],Xd=["href"],Yd=["src"];const $d={props:{baseUrl:null,navBarModel:null,airaPathBase:null},data:function(){return{themeColor:"#8107c1",themeColorInRgb:"rgb(129, 7, 193)",submitButton:null,started:!1}},mounted:function(){this.main()},methods:{main:function(){}}};var Zd=n(535);const Qd=(0,Zd.A)($d,[["render",function(e,t,n,r,i,o){return ei(),oi("nav",Rd,[di("div",Pd,[di("div",Nd,[di("img",{alt:"Kentico",id:"aira-app-logo",src:"".concat(this.baseUrl).concat(this.navBarModel.logoImgRelativePath)},null,8,Dd)]),di("h1",Fd,[di("img",{alt:"Kentico",id:"aira-title-img",class:"c-icon text-primary",src:"".concat(this.baseUrl).concat(this.navBarModel.titleImagePath)},null,8,jd),di("span",Bd,Y("".concat(this.navBarModel.titleText)),1)]),di("button",Ud,[(ei(),oi("svg",{class:"c-icon",id:"burger-icon",style:U({color:"".concat(this.themeColor)})},[di("use",{"xlink:href":"".concat(this.baseUrl,"/_content/Kentico.Xperience.Aira/img/icons.svg#hamburger-menu")},null,8,Hd)],4))])]),di("div",qd,[di("div",Vd,[di("div",zd,[di("div",Gd,[di("div",Wd,[di("a",{class:"d-flex align-items-center gap-2 btn",href:"".concat(this.baseUrl).concat(this.airaPathBase,"/").concat(this.navBarModel.chatItem.url)},[di("img",{src:"".concat(this.baseUrl).concat(this.navBarModel.chatItem.imagePath),class:"c-icon text-primary"},null,8,Jd),vi(" "+Y("".concat(this.navBarModel.chatItem.title)),1)],8,Kd),di("a",{class:"d-flex align-tems-center gap-2 btn",href:"".concat(this.baseUrl).concat(this.airaPathBase,"/").concat(this.navBarModel.smartUploadItem.url)},[di("img",{src:"".concat(this.baseUrl).concat(this.navBarModel.smartUploadItem.imagePath),class:"c-icon text-primary"},null,8,Yd),vi(" "+Y("".concat(this.navBarModel.smartUploadItem.title)),1)],8,Xd)]),t[0]||(t[0]=mi('<hr class="c-nav_hr"><div class="c-nav_content"><p id="nav-content"></p></div><div class="c-nav_footer"><p id="appVersion"></p><p> 2024 Kentico. All rights reserved.</p></div>',3))])])])])])}]]);function ep(e){return ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ep(e)}function tp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function np(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tp(Object(n),!0).forEach((function(t){rp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rp(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=ep(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ep(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ep(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ip(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,s,a=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,t)||sp(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function op(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=sp(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function sp(e,t){if(e){if("string"==typeof e)return ap(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ap(e,t):void 0}}function ap(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function lp(){lp=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof g?t:g,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(e,n,a)}),s}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var p="suspendedStart",h="suspendedYield",f="executing",v="completed",m={};function g(){}function y(){}function b(){}var _={};c(_,s,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==n&&r.call(x,s)&&(_=x);var w=b.prototype=g.prototype=Object.create(_);function S(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function n(i,o,s,a){var l=d(e[i],e,o);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==ep(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(u).then((function(e){c.value=e,s(c)}),(function(e){return n("throw",e,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function C(t,n,r){var i=p;return function(o,s){if(i===f)throw Error("Generator is already running");if(i===v){if("throw"===o)throw s;return{value:e,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=T(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===p)throw i=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=f;var c=d(t,n,r);if("normal"===c.type){if(i=r.done?v:h,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=v,r.method="throw",r.arg=c.arg)}}}function T(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,T(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=d(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(ep(t)+" is not iterable")}return y.prototype=b,i(w,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},S(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var s=new E(u(e,n,r,i),o);return t.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},S(w),c(w,l,"Generator"),c(w,s,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return a.type="throw",a.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),M(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m}},t}function cp(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function up(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){cp(o,r,i,s,a,"next",e)}function a(e){cp(o,r,i,s,a,"throw",e)}s(void 0)}))}}const dp={components:{NavBarComponent:Qd},props:{pathsModel:null,baseUrl:null,navBarModel:null,history:[],initialAiraMessage:null},data:function(){return{themeColor:"#8107c1",themeColorInRgb:"rgb(129, 7, 193)",submitButton:null,started:!1}},mounted:function(){var e=this;document.onreadystatechange=function(){"complete"===document.readyState&&e.main()}},methods:{main:function(){var e=this;setTimeout((function(){var e=document.querySelector("#loading");e&&e.classList.add("is-hidden"),setTimeout((function(){e.parentNode.removeChild(e)}),500)}),1e3),this.$refs.chatElementRef.onComponentRender=up(lp().mark((function t(){var n;return lp().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setBorders(),e.started||(e.started=!0,document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&this.$refs.chatElementRef.scrollToBottom()})),e.setRequestInterceptor(),e.setResponseInterceptor(),e.setHistory()),n=e.$refs.chatElementRef.shadowRoot.querySelector(".input-button"),e.submitButton!==n&&(e.submitButton=n,e.addClassesToShadowRoot());case 4:case"end":return t.stop()}}),t)})))},setRequestInterceptor:function(){this.$refs.chatElementRef.requestInterceptor=function(){var e=up(lp().mark((function e(t){var n,r,i,o,s,a,l,c,u;return lp().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new FormData,Object.hasOwn(t.body,"messages"))n.append("message",t.body.messages[0].text);else if(null!==t.body.entries()){r=!1,i=op(t.body.entries());try{for(i.s();!(o=i.n()).done;)if(s=ip(o.value,2),a=s[0],l=s[1],"message1"===a){c=void 0;try{c=JSON.parse(l)}catch(e){c=l}c&&c.text&&(n.append("message",c.text),r=!0)}else"files"===a&&(n.append(a,l),console.log("".concat(a," ").concat(l)))}catch(e){i.e(e)}finally{i.f()}r||n.append("messages","")}return u=np(np({},t),{},{body:n,headers:np({},t.headers)}),e.abrupt("return",u);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},setResponseInterceptor:function(){var e=this;this.$refs.chatElementRef.responseInterceptor=function(t){return e.getMessageViewModel(t)}},setBorders:function(){this.$refs.chatElementRef.style.borderLeftStyle="none",this.$refs.chatElementRef.style.borderTopStyle="none",this.$refs.chatElementRef.style.borderRightStyle="none",this.$refs.chatElementRef.style.borderBottomStyle="none"},enableSubmitButtonForUpload:function(){},addClassesToShadowRoot:function(){var e=this.$refs.chatElementRef.shadowRoot,t=document.createElement("style");t.textContent=".btn-outline-primary {\n                    color: ".concat(this.themeColorInRgb,";\n                    background-color: transparent;\n                    border: 1px solid ").concat(this.themeColorInRgb,";\n                    font-size: 0.75rem;\n                    border-radius: 24px;\n                    padding: 6px 12px;\n                    margin: 4px;\n                    transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;\n                    display: inline-block;\n                }\n\n                .user-message-text {\n                    background-color: ").concat(this.themeColor," !important;\n                }\n\n                .btn-outline-primary:hover {\n                    color: #fff;\n                    background-color: ").concat(this.themeColorInRgb,";\n                    border-color: ").concat(this.themeColorInRgb,";\n                }\n\n                .btn-outline-primary:active {\n                    color: #fff;\n                    background-color: #C64300;\n                    border-color: #C64300;\n                }\n\n                .btn-outline-primary:disabled {\n                        color: ").concat(this.themeColorInRgb,";\n                    background-color: transparent;\n                        border-color: ").concat(this.themeColorInRgb,";\n                    opacity: 0.65;\n                    pointer-events: none;\n                }\n\n                .container {\n                    display: flex;\n                    flex-direction: row;\n                    align-items: flex-start;\n                    flex-wrap: wrap;\n                }\n\n                .message-bubble div {\n                    margin-bottom: 8px;\n                }\n\n                .message-bubble .btn-outline-primary {\n                    margin-right: 8px;\n                }\n\n                .lds-ring, .lds-ring div {\n                    box-sizing: border-box;\n                }\n\n                .lds-ring {\n                    display: inline-block;\n                    position: relative;\n                    width: 80px;\n                    height: 80px;\n                    margin-bottom: 0px;\n                }\n\n                .lds-ring div {\n                    box-sizing: border-box;\n                    display: block;\n                    position: absolute;\n                    width: 64px;\n                    height: 64px;\n                    margin: 8px;\n                    border: 5px solid currentColor;\n                    border-radius: 50%;\n                    animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;\n                    border-color: currentColor transparent transparent transparent;\n                }\n\n                .lds-ring div:nth-child(1) {\n                    animation-delay: -0.45s;\n                }\n\n                .lds-ring div:nth-child(2) {\n                    animation-delay: -0.3s;\n                }\n\n                .lds-ring div:nth-child(3) {\n                    animation-delay: -0.15s;\n                }\n\n                @@keyframes lds-ring {\n                    0% {\n                        transform: rotate(0deg);\n                    }\n\n                    100% {\n                        transform: rotate(360deg);\n                    }\n                }"),e.appendChild(t)},setHistory:function(){var e,t=op(this.history);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=this.getMessageViewModel(n);this.$refs.chatElementRef.history.push(r)}}catch(e){t.e(e)}finally{t.f()}this.$refs.chatElementRef.history.push({role:"ai",text:this.initialAiraMessage})},getMessageViewModel:function(e){return null!==e.url?{role:"user",files:[{src:e.url,type:"image"}]}:{role:e.role,text:e.message}},isJSONWithProperty:function(e,t){try{var n=JSON.parse(e);return n&&"object"===ep(n)&&t in n}catch(e){return!1}}}},pp=(0,Zd.A)(dp,[["render",function(e,t,n,r,i,o){var s=Nn("NavBarComponent"),a=Nn("deep-chat");return ei(),oi("div",Gi,[di("div",Wi,[di("img",{src:"".concat(this.baseUrl,"/_content/Kentico.Xperience.Aira/img/spinner.svg"),class:"c-loading_spinner",alt:"loading spinner"},null,8,Ki)]),di("div",Ji,[pi(s,{airaPathBase:n.pathsModel.pathBase,navBarModel:n.navBarModel,baseUrl:n.baseUrl},null,8,["airaPathBase","navBarModel","baseUrl"])]),di("div",Xi,[di("div",Yi,[pi(a,{dropupStyles:{button:{styles:{container:{default:{backgroundColor:"#eff8ff"},hover:{backgroundColor:"#e4f3ff"},click:{backgroundColor:"#d7edff"}}}},menu:{container:{boxShadow:"#e2e2e2 0px 1px 3px 2px"},item:{hover:{backgroundColor:"#e1f2ff"},click:{backgroundColor:"#cfeaff"}},iconContainer:{width:"1.8em"},text:{fontSize:"1.05em"}}},connect:{url:"".concat(this.baseUrl).concat(this.pathsModel.pathBase,"/").concat(n.pathsModel.chatMessagePath),method:"POST"},names:{ai:{text:"AIRA"},default:{text:""},user:{text:""}},chatStyle:{height:"100%",width:"100%"},history:[],textInput:{placeholder:{text:"Message AIRA"}},id:"chatElement",ref:"chatElementRef",requestBodyLimits:{maxMessages:1},style:{"border-radius":"8px"},introMessage:{text:""},messageStyles:{default:{shared:{bubble:{fontSize:"0.75rem",lineHeight:"1.375rem",padding:"0.5rem 0.75rem"}},ai:{bubble:{background:"#F7F1FF"}},user:{bubble:{color:"#fff"}}},image:{user:{bubble:{borderRadius:"1rem",overflow:"clip",textAlign:"left",display:"inline-block"}}}}},null,8,["connect"])])])])}]]);var hp={id:"loading",class:"c-loading"},fp=["src"],vp={class:"c-app_header"},mp={id:"loading",class:"c-loading"},gp=["src"],yp={class:"c-done-page-layout"},bp={href:"/aira/assets",class:"btn btn-primary text-uppercase"},_p={class:"c-icon fs-6 me-2"},kp=["xlink:href"],xp={class:"c-app_body"},wp={class:"container"},Sp={ref:"fileInput",hidden:"",type:"file",accept:".jpg,.jpeg,.png,.bmp",class:"d-none",multiple:""},Ep={key:0,class:"c-empty-page-layout"},Cp=["src"],Tp={class:"c-icon fs-6"},Ap=["xlink:href"],Mp={key:1,class:"c-message_wrapper u-secondary-accent",id:"messages"},Ip={class:"c-message"},Lp={class:"c-message_bubble white w-100"},Op={class:"row g-2.5"},Rp={class:"c-message_img ratio ratio-1x1 position-relative"},Pp=["src"],Np=["onClick"],Dp={class:"c-add-asset-div"},Fp={key:2,class:"mt-5"},jp=["disabled"];function Bp(e){return Bp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bp(e)}function Up(){Up=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof g?t:g,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(e,n,a)}),s}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var p="suspendedStart",h="suspendedYield",f="executing",v="completed",m={};function g(){}function y(){}function b(){}var _={};c(_,s,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(L([])));x&&x!==n&&r.call(x,s)&&(_=x);var w=b.prototype=g.prototype=Object.create(_);function S(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function n(i,o,s,a){var l=d(e[i],e,o);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==Bp(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(u).then((function(e){c.value=e,s(c)}),(function(e){return n("throw",e,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function C(t,n,r){var i=p;return function(o,s){if(i===f)throw Error("Generator is already running");if(i===v){if("throw"===o)throw s;return{value:e,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=T(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===p)throw i=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=f;var c=d(t,n,r);if("normal"===c.type){if(i=r.done?v:h,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=v,r.method="throw",r.arg=c.arg)}}}function T(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,T(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=d(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(Bp(t)+" is not iterable")}return y.prototype=b,i(w,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},S(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var s=new E(u(e,n,r,i),o);return t.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},S(w),c(w,l,"Generator"),c(w,s,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return a.type="throw",a.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),M(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m}},t}function Hp(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function qp(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){Hp(o,r,i,s,a,"next",e)}function a(e){Hp(o,r,i,s,a,"throw",e)}s(void 0)}))}}const Vp={components:{NavBarComponent:Qd},props:{pathsModel:null,baseUrl:null,navBarModel:null},data:function(){return{files:[],phase:"empty",formIsValid:!0,uploading:!1,filesPromiseResolve:null,filesPromise:null,isLoaded:!0}},mounted:function(){var e=this;document.onreadystatechange=function(){"complete"===document.readyState&&e.main()}},methods:{main:function(){this.validateState(),this.$refs.fileInput.onchange=this.fileInputChange,setTimeout((function(){var e=document.querySelector("#loading");e&&e.classList.add("is-hidden"),setTimeout((function(){e.parentNode.removeChild(e)}),500)}),1e3)},pickImage:function(e){var t=this;return qp(Up().mark((function e(){var n;return Up().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.phase="selection",t.filesPromise=new Promise((function(e){return t.filesPromiseResolve=e})),t.$refs.fileInput.click(),e.next=5,t.filesPromise;case 5:n=e.sent,t.filesPromise=null,t.filesPromiseResolve=null,Array.from(n).forEach((function(e){t.files.push(e)})),t.validateState();case 10:case"end":return e.stop()}}),e)})))()},createObjectURL:function(e){return URL.createObjectURL(e)},fileInputChange:function(e){this.filesPromiseResolve(e.target.files)},validateState:function(){this.formIsValid=this.files.length>0},removeFile2:function(e,t){this.files.splice(t,1),this.validateState()},fireUpload:function(){var e=this,t=new FormData;this.files.forEach((function(e){t.append("files",e)})),fetch("".concat(this.baseUrl).concat(this.pathsModel.pathBase,"/assets/upload"),{method:"POST",body:t,mode:"same-origin",credentials:"same-origin"}).then(function(){var t=qp(Up().mark((function t(n){return Up().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.phase="uploading",setTimeout((function(){var e=document.querySelector("#loading");e&&e.classList.remove("is-hidden"),setTimeout((function(){e.parentNode.removeChild(e),setTimeout((function(){document.querySelector(".c-checkmark")&&document.querySelector(".c-checkmark").classList.add("do-animation")}))}),500)}),1e3);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},zp=(0,Zd.A)(Vp,[["render",function(e,t,n,r,i,o){var s=Nn("NavBarComponent");return ei(),oi("div",{class:G(["c-app_inner",{"is-loaded":i.isLoaded}])},[di("div",hp,[di("img",{src:"".concat(this.baseUrl,"/_content/Kentico.Xperience.Aira/img/spinner.svg"),class:"c-loading_spinner",alt:"loading spinner"},null,8,fp)]),di("div",vp,[pi(s,{airaPathBase:n.pathsModel.pathBase,navBarModel:n.navBarModel,baseUrl:n.baseUrl},null,8,["airaPathBase","navBarModel","baseUrl"])]),"uploading"==i.phase?(ei(),oi(Jr,{key:0},[di("div",mp,[di("img",{src:"".concat(this.baseUrl,"/_content/Kentico.Xperience.Aira/img/spinner.svg"),class:"c-loading_spinner",alt:"loading spinner"},null,8,gp)]),di("div",yp,[t[4]||(t[4]=di("div",null,[di("h2",null,[vi("Thank you"),di("span",{class:"text-primary"},".")])],-1)),t[5]||(t[5]=di("div",null,[di("svg",{viewBox:"0 0 78.400003 58.227815",xmlns:"http://www.w3.org/2000/svg",class:"c-checkmark"},[di("polyline",{class:"path",fill:"none","stroke-width":"8","stroke-linecap":"round","stroke-miterlimit":"10","stroke-dasharray":"100","stroke-dashoffset":"-100",points:"74.4,4 25.7,52.6 4,31.5",id:"polyline1"})])],-1)),t[6]||(t[6]=di("div",null,[di("p",null," Your images have been successfully uploaded. ")],-1)),di("div",null,[di("a",bp,[(ei(),oi("svg",_p,[di("use",{"xlink:href":"".concat(this.baseUrl,"/_content/Kentico.Xperience.Aira/img/icons.svg#plus-circle")},null,8,kp)])),t[3]||(t[3]=vi(" upload more "))])])])],64)):gi("",!0),di("div",xp,[di("div",wp,[di("form",null,[di("input",Sp,null,512)]),"empty"==i.phase?(ei(),oi("div",Ep,[t[8]||(t[8]=di("div",null,[di("p",null,"It looks empty, please upload your images here.")],-1)),di("div",null,[di("img",{src:"".concat(this.baseUrl,"/_content/Kentico.Xperience.Aira/img/image-placeholder.svg"),alt:"image placeholder",class:"img-fluid"},null,8,Cp)]),di("div",null,[di("button",{class:"btn btn-secondary text-uppercase",onClick:t[0]||(t[0]=function(e){o.pickImage()})},[(ei(),oi("svg",Tp,[di("use",{"xlink:href":"".concat(this.baseUrl,"/_content/Kentico.Xperience.Aira/img/icons.svg#plus-circle")},null,8,Ap)])),t[7]||(t[7]=vi(" upload assets "))])])])):gi("",!0),"selection"==i.phase?(ei(),oi("div",Mp,[di("div",Ip,[di("div",Lp,[di("div",Op,[(ei(!0),oi(Jr,null,Bn(i.files,(function(e,n){return ei(),oi("div",{class:"col-6",key:n},[di("div",Rp,[di("img",{class:"object-fit-cover",src:o.createObjectURL(e),alt:"uploaded image"},null,8,Pp),di("button",{class:"btn btn-remove-img","aria-label":"Remove",onClick:function(t){o.removeFile2(e,n)}},t[9]||(t[9]=[di("svg",{class:"c-icon"},[di("use",{"xlink:href":"`${this.baseUrl}/_content/Kentico.Xperience.Aira/img/icons.svg#cross`"})],-1)]),8,Np)])])})),128)),di("div",Dp,[di("button",{class:"btn btn-secondary text-uppercase",onClick:t[1]||(t[1]=function(e){o.pickImage()})},t[10]||(t[10]=[di("svg",{class:"c-icon fs-6"},[di("use",{"xlink:href":"`${this.baseUrl}/_content/Kentico.Xperience.Aira/img/icons.svg#plus-circle`"})],-1),vi(" upload assets ")]))])])])])])):gi("",!0),"selection"==i.phase?(ei(),oi("div",Fp,[di("button",{type:"button",class:"btn btn-primary btn-lg w-100",disabled:!i.formIsValid,onClick:t[2]||(t[2]=function(e){return o.fireUpload()})}," UPLOAD FILES ",8,jp)])):gi("",!0)])])],2)}]]);let Gp;const Wp="undefined"!=typeof window&&window.trustedTypes;if(Wp)try{Gp=Wp.createPolicy("vue",{createHTML:e=>e})}catch(e){}const Kp=Gp?e=>Gp.createHTML(e):e=>e,Jp="undefined"!=typeof document?document:null,Xp=Jp&&Jp.createElement("template"),Yp={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,r)=>{const i="svg"===t?Jp.createElementNS("http://www.w3.org/2000/svg",e):"mathml"===t?Jp.createElementNS("http://www.w3.org/1998/Math/MathML",e):n?Jp.createElement(e,{is:n}):Jp.createElement(e);return"select"===e&&r&&null!=r.multiple&&i.setAttribute("multiple",r.multiple),i},createText:e=>Jp.createTextNode(e),createComment:e=>Jp.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Jp.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,r,i,o){const s=n?n.previousSibling:t.lastChild;if(i&&(i===o||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),n),i!==o&&(i=i.nextSibling););else{Xp.innerHTML=Kp("svg"===r?`<svg>${e}</svg>`:"mathml"===r?`<math>${e}</math>`:e);const i=Xp.content;if("svg"===r||"mathml"===r){const e=i.firstChild;for(;e.firstChild;)i.appendChild(e.firstChild);i.removeChild(e)}t.insertBefore(i,n)}return[s?s.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},$p=Symbol("_vtc");Boolean;const Zp=Symbol("_vod"),Qp=Symbol("_vsh");const eh=Symbol("");const th=/(^|;)\s*display\s*:/;const nh=/\s*!important$/;function rh(e,t,n){if(f(n))n.forEach((n=>rh(e,t,n)));else if(null==n&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const r=function(e,t){const n=oh[t];if(n)return n;let r=M(t);if("filter"!==r&&r in e)return oh[t]=r;r=O(r);for(let n=0;n<ih.length;n++){const i=ih[n]+r;if(i in e)return oh[t]=i}return t}(e,t);nh.test(n)?e.setProperty(L(r),n.replace(nh,""),"important"):e[r]=n}}const ih=["Webkit","Moz","ms"],oh={};const sh="http://www.w3.org/1999/xlink";function ah(e,t,n,r,i,o=K(t)){r&&t.startsWith("xlink:")?null==n?e.removeAttributeNS(sh,t.slice(6,t.length)):e.setAttributeNS(sh,t,n):null==n||o&&!J(n)?e.removeAttribute(t):e.setAttribute(t,o?"":b(n)?String(n):n)}function lh(e,t,n,r,i){if("innerHTML"===t||"textContent"===t)return void(null!=n&&(e[t]="innerHTML"===t?Kp(n):n));const o=e.tagName;if("value"===t&&"PROGRESS"!==o&&!o.includes("-")){const r="OPTION"===o?e.getAttribute("value")||"":e.value,i=null==n?"checkbox"===e.type?"on":"":String(n);return r===i&&"_value"in e||(e.value=i),null==n&&e.removeAttribute(t),void(e._value=n)}let s=!1;if(""===n||null==n){const r=typeof e[t];"boolean"===r?n=J(n):null==n&&"string"===r?(n="",s=!0):"number"===r&&(n=0,s=!0)}try{e[t]=n}catch(e){0}s&&e.removeAttribute(i||t)}function ch(e,t,n,r){e.addEventListener(t,n,r)}const uh=Symbol("_vei");function dh(e,t,n,r,i=null){const o=e[uh]||(e[uh]={}),s=o[t];if(r&&s)s.value=r;else{const[n,a]=function(e){let t;if(ph.test(e)){let n;for(t={};n=e.match(ph);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}const n=":"===e[2]?e.slice(3):L(e.slice(2));return[n,t]}(t);if(r){const s=o[t]=function(e,t){const n=e=>{if(e._vts){if(e._vts<=n.attached)return}else e._vts=Date.now();Mt(function(e,t){if(f(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}(e,n.value),t,5,[e])};return n.value=e,n.attached=vh(),n}(r,i);ch(e,n,s,a)}else s&&(!function(e,t,n,r){e.removeEventListener(t,n,r)}(e,n,s,a),o[t]=void 0)}}const ph=/(?:Once|Passive|Capture)$/;let hh=0;const fh=Promise.resolve(),vh=()=>hh||(fh.then((()=>hh=0)),hh=Date.now());const mh=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123;"undefined"!=typeof HTMLElement&&HTMLElement;Symbol("_moveCb"),Symbol("_enterCb");Symbol("_assign");const gh=u({patchProp:(e,t,n,r,i,o)=>{const s="svg"===i;"class"===t?function(e,t,n){const r=e[$p];r&&(t=(t?[t,...r]:[...r]).join(" ")),null==t?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}(e,r,s):"style"===t?function(e,t,n){const r=e.style,i=y(n);let o=!1;if(n&&!i){if(t)if(y(t))for(const e of t.split(";")){const t=e.slice(0,e.indexOf(":")).trim();null==n[t]&&rh(r,t,"")}else for(const e in t)null==n[e]&&rh(r,e,"");for(const e in n)"display"===e&&(o=!0),rh(r,e,n[e])}else if(i){if(t!==n){const e=r[eh];e&&(n+=";"+e),r.cssText=n,o=th.test(n)}}else t&&e.removeAttribute("style");Zp in e&&(e[Zp]=o?r.display:"",e[Qp]&&(r.display="none"))}(e,n,r):l(t)?c(t)||dh(e,t,0,r,o):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):function(e,t,n,r){if(r)return"innerHTML"===t||"textContent"===t||!!(t in e&&mh(t)&&g(n));if("spellcheck"===t||"draggable"===t||"translate"===t)return!1;if("form"===t)return!1;if("list"===t&&"INPUT"===e.tagName)return!1;if("type"===t&&"TEXTAREA"===e.tagName)return!1;if("width"===t||"height"===t){const t=e.tagName;if("IMG"===t||"VIDEO"===t||"CANVAS"===t||"SOURCE"===t)return!1}if(mh(t)&&y(n))return!1;return t in e}(e,t,r,s))?(lh(e,t,r),e.tagName.includes("-")||"value"!==t&&"checked"!==t&&"selected"!==t||ah(e,t,r,s,0,"value"!==t)):!e._isVueCE||!/[A-Z]/.test(t)&&y(r)?("true-value"===t?e._trueValue=r:"false-value"===t&&(e._falseValue=r),ah(e,t,r,s)):lh(e,M(t),r,0,t)}},Yp);let yh;function bh(){return yh||(yh=Sr(gh))}const _h=(...e)=>{const t=bh().createApp(...e);const{mount:n}=t;return t.mount=e=>{const r=xh(e);if(!r)return;const i=t._component;g(i)||i.render||i.template||(i.template=r.innerHTML),1===r.nodeType&&(r.textContent="");const o=n(r,!1,kh(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},t};function kh(e){return e instanceof SVGElement?"svg":"function"==typeof MathMLElement&&e instanceof MathMLElement?"mathml":void 0}function xh(e){if(y(e)){return document.querySelector(e)}return e}var wh=document.getElementById("chat-app"),Sh=document.getElementById("assets-app");if(wh){var Eh=JSON.parse(wh.dataset.pathsModel||"{}"),Ch=wh.dataset.baseUrl||"",Th=JSON.parse(wh.dataset.navBarModel||"{}"),Ah=JSON.parse(wh.dataset.history||{}),Mh=wh.dataset.initialAiraMessage;_h(pp,{pathsModel:Eh,baseUrl:Ch,navBarModel:Th,history:Ah,initialAiraMessage:Mh}).mount("#chat-app")}if(Sh){var Ih=JSON.parse(Sh.dataset.pathsModel||"{}"),Lh=Sh.dataset.baseUrl||"",Oh=JSON.parse(Sh.dataset.navBarModel||"{}");_h(zp,{pathsModel:Ih,baseUrl:Lh,navBarModel:Oh}).mount("#assets-app")}